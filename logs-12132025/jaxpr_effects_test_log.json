{"created": 1765570339.9228723, "duration": 10.143038272857666, "exitcode": 0, "root": "/dockerx/rocm/rocm-jax/jax", "environment": {}, "summary": {"passed": 53, "skipped": 7, "total": 60, "collected": 60}, "collectors": [{"nodeid": "", "outcome": "passed", "result": [{"nodeid": "tests/jaxpr_effects_test.py::JaxprEffectsTest::test_different_effects_in_jaxpr", "type": "TestCaseFunction", "lineno": 136}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprEffectsTest::test_effectful_primitive_in_jaxpr_creates_effects", "type": "TestCaseFunction", "lineno": 128}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprEffectsTest::test_jaxpr_typecheck_should_verify_eqn_effects_are_subset", "type": "TestCaseFunction", "lineno": 146}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprEffectsTest::test_trivial_jaxpr_has_no_effects", "type": "TestCaseFunction", "lineno": 122}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_core_call_primitive_inherits_effects", "type": "TestCaseFunction", "lineno": 162}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_custom_jvp_primitive_inherits_effects", "type": "TestCaseFunction", "lineno": 208}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_custom_vjp_primitive_inherits_effects", "type": "TestCaseFunction", "lineno": 219}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_jit_inherits_effects", "type": "TestCaseFunction", "lineno": 246}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_jit_primitive_inherits_effects", "type": "TestCaseFunction", "lineno": 176}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_new_remat_allows_certain_effects", "type": "TestCaseFunction", "lineno": 199}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_pjit_const_input_effect_indexing", "type": "TestCaseFunction", "lineno": 258}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_pmap_inherits_effects", "type": "TestCaseFunction", "lineno": 232}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_remat_call_primitive_inherits_effects", "type": "TestCaseFunction", "lineno": 188}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_can_lower_and_run_jaxpr_with_ordered_effects", "type": "TestCaseFunction", "lineno": 450}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_can_lower_and_run_jaxpr_with_unordered_effects", "type": "TestCaseFunction", "lineno": 457}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_can_lower_lowerable_effect", "type": "TestCaseFunction", "lineno": 303}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_can_lower_multiple_effects", "type": "TestCaseFunction", "lineno": 506}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_cannot_lower_unlowerable_effect", "type": "TestCaseFunction", "lineno": 310}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_cant_jit_and_pmap_function_with_ordered_effects", "type": "TestCaseFunction", "lineno": 475}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_cant_jit_and_pmap_function_with_unordered_effects", "type": "TestCaseFunction", "lineno": 464}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_lowered_jaxpr_with_multiple_ordered_effects_takes_in_tokens", "type": "TestCaseFunction", "lineno": 430}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_lowered_jaxpr_with_ordered_effects_takes_token_inputs", "type": "TestCaseFunction", "lineno": 413}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_lowered_jaxpr_without_ordered_effects_takes_no_dummy_inputs", "type": "TestCaseFunction", "lineno": 398}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_lowering_that_doesnt_set_tokens_should_cause_error", "type": "TestCaseFunction", "lineno": 331}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_lowering_that_sets_wrong_tokens_should_cause_error", "type": "TestCaseFunction", "lineno": 346}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_nontrivial_lowering_with_ordered_effect_should_consume_token", "type": "TestCaseFunction", "lineno": 361}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_nontrivial_lowering_with_unordered_effect_should_consume_token", "type": "TestCaseFunction", "lineno": 380}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_runtime_tokens_should_update_after_running_effectful_function", "type": "TestCaseFunction", "lineno": 494}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_should_not_pass_tokens_into_unordered_effect", "type": "TestCaseFunction", "lineno": 318}, {"nodeid": "tests/jaxpr_effects_test.py::EffectOrderingTest::test_can_execute_python_callback", "type": "TestCaseFunction", "lineno": 532}, {"nodeid": "tests/jaxpr_effects_test.py::EffectOrderingTest::test_different_threads_get_different_tokens", "type": "TestCaseFunction", "lineno": 581}, {"nodeid": "tests/jaxpr_effects_test.py::EffectOrderingTest::test_ordered_effect_remains_ordered_across_multiple_devices", "type": "TestCaseFunction", "lineno": 550}, {"nodeid": "tests/jaxpr_effects_test.py::ParallelEffectsTest::test_can_pmap_unordered_callback", "type": "TestCaseFunction", "lineno": 645}, {"nodeid": "tests/jaxpr_effects_test.py::ParallelEffectsTest::test_can_pmap_unordered_effect", "type": "TestCaseFunction", "lineno": 637}, {"nodeid": "tests/jaxpr_effects_test.py::ParallelEffectsTest::test_cannot_pmap_ordered_effect", "type": "TestCaseFunction", "lineno": 618}, {"nodeid": "tests/jaxpr_effects_test.py::ParallelEffectsTest::test_cannot_pmap_unlowerable_effect", "type": "TestCaseFunction", "lineno": 608}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_effect_in_cond", "type": "TestCaseFunction", "lineno": 677}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_effect_in_cond_body", "type": "TestCaseFunction", "lineno": 779}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_effect_in_cond_jvp", "type": "TestCaseFunction", "lineno": 688}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_effect_in_cond_jvp2", "type": "TestCaseFunction", "lineno": 706}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_effect_in_scan", "type": "TestCaseFunction", "lineno": 833}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_effect_in_while_body", "type": "TestCaseFunction", "lineno": 769}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_ordered_effect_in_cond", "type": "TestCaseFunction", "lineno": 734}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_ordered_effect_in_scan", "type": "TestCaseFunction", "lineno": 841}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_ordered_effect_in_while_body", "type": "TestCaseFunction", "lineno": 789}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_effects_disallowed_in_cond", "type": "TestCaseFunction", "lineno": 665}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_effects_disallowed_in_scan", "type": "TestCaseFunction", "lineno": 858}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_effects_disallowed_in_while", "type": "TestCaseFunction", "lineno": 810}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_multiple_allowed_ordered_effect_in_cond", "type": "TestCaseFunction", "lineno": 745}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_multiple_allowed_ordered_effect_in_scan", "type": "TestCaseFunction", "lineno": 849}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_multiple_allowed_ordered_effect_in_while_body", "type": "TestCaseFunction", "lineno": 799}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_by_index_properly", "type": "TestCaseFunction", "lineno": 886}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_through_a_jit", "type": "TestCaseFunction", "lineno": 897}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_through_cond", "type": "TestCaseFunction", "lineno": 1061}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_through_dce", "type": "TestCaseFunction", "lineno": 940}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_through_partial_eval_custom", "type": "TestCaseFunction", "lineno": 920}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_through_scan", "type": "TestCaseFunction", "lineno": 1004}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_through_scan_with_dce", "type": "TestCaseFunction", "lineno": 1031}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_through_while_loop", "type": "TestCaseFunction", "lineno": 970}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_simple_jaxpr_input_effect", "type": "TestCaseFunction", "lineno": 880}]}], "tests": [{"nodeid": "tests/jaxpr_effects_test.py::JaxprEffectsTest::test_different_effects_in_jaxpr", "lineno": 136, "outcome": "passed", "keywords": ["test_different_effects_in_jaxpr", "JaxprEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00032649748027324677, "outcome": "passed"}, "call": {"duration": 0.0017096605151891708, "outcome": "passed"}, "teardown": {"duration": 0.00011041481047868729, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprEffectsTest::test_effectful_primitive_in_jaxpr_creates_effects", "lineno": 128, "outcome": "passed", "keywords": ["test_effectful_primitive_in_jaxpr_creates_effects", "JaxprEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001662168651819229, "outcome": "passed"}, "call": {"duration": 0.0007978426292538643, "outcome": "passed"}, "teardown": {"duration": 0.00010447949171066284, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprEffectsTest::test_jaxpr_typecheck_should_verify_eqn_effects_are_subset", "lineno": 146, "outcome": "passed", "keywords": ["test_jaxpr_typecheck_should_verify_eqn_effects_are_subset", "JaxprEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00015315786004066467, "outcome": "passed"}, "call": {"duration": 0.0020147887989878654, "outcome": "passed"}, "teardown": {"duration": 9.26060602068901e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprEffectsTest::test_trivial_jaxpr_has_no_effects", "lineno": 122, "outcome": "passed", "keywords": ["test_trivial_jaxpr_has_no_effects", "JaxprEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001519685611128807, "outcome": "passed"}, "call": {"duration": 0.0008144630119204521, "outcome": "passed"}, "teardown": {"duration": 0.00011991430073976517, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_core_call_primitive_inherits_effects", "lineno": 162, "outcome": "passed", "keywords": ["test_core_call_primitive_inherits_effects", "HigherOrderPrimitiveTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018877536058425903, "outcome": "passed"}, "call": {"duration": 0.0009035086259245872, "outcome": "passed"}, "teardown": {"duration": 8.78581777215004e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_custom_jvp_primitive_inherits_effects", "lineno": 208, "outcome": "passed", "keywords": ["test_custom_jvp_primitive_inherits_effects", "HigherOrderPrimitiveTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00014959461987018585, "outcome": "passed"}, "call": {"duration": 0.002553805708885193, "outcome": "passed"}, "teardown": {"duration": 9.141862392425537e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_custom_vjp_primitive_inherits_effects", "lineno": 219, "outcome": "passed", "keywords": ["test_custom_vjp_primitive_inherits_effects", "HigherOrderPrimitiveTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00015197042375802994, "outcome": "passed"}, "call": {"duration": 0.025998717173933983, "outcome": "passed"}, "teardown": {"duration": 0.00010566692799329758, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_jit_inherits_effects", "lineno": 246, "outcome": "passed", "keywords": ["test_jit_inherits_effects", "HigherOrderPrimitiveTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018521305173635483, "outcome": "passed"}, "call": {"duration": 4.993746184743941, "outcome": "passed"}, "teardown": {"duration": 0.00016265548765659332, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_jit_primitive_inherits_effects", "lineno": 176, "outcome": "passed", "keywords": ["test_jit_primitive_inherits_effects", "HigherOrderPrimitiveTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00022676773369312286, "outcome": "passed"}, "call": {"duration": 0.0013914741575717926, "outcome": "passed"}, "teardown": {"duration": 9.616930037736893e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_new_remat_allows_certain_effects", "lineno": 199, "outcome": "passed", "keywords": ["test_new_remat_allows_certain_effects", "HigherOrderPrimitiveTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00015671923756599426, "outcome": "passed"}, "call": {"duration": 0.0009165685623884201, "outcome": "passed"}, "teardown": {"duration": 9.14204865694046e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_pjit_const_input_effect_indexing", "lineno": 258, "outcome": "passed", "keywords": ["test_pjit_const_input_effect_indexing", "HigherOrderPrimitiveTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00016740337014198303, "outcome": "passed"}, "call": {"duration": 1.9949915241450071, "outcome": "passed"}, "teardown": {"duration": 0.0002730712294578552, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_pmap_inherits_effects", "lineno": 232, "outcome": "skipped", "keywords": ["test_pmap_inherits_effects", "HigherOrderPrimitiveTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00044285040348768234, "outcome": "passed"}, "call": {"duration": 0.0009581223130226135, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/jaxpr_effects_test.py', 233, 'Skipped: Test does not raise under `pmap_shmap_merge=True`.')"}, "teardown": {"duration": 0.0002208305522799492, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_remat_call_primitive_inherits_effects", "lineno": 188, "outcome": "passed", "keywords": ["test_remat_call_primitive_inherits_effects", "HigherOrderPrimitiveTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.000375174917280674, "outcome": "passed"}, "call": {"duration": 0.008075774647295475, "outcome": "passed"}, "teardown": {"duration": 0.00026357267051935196, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_can_lower_and_run_jaxpr_with_ordered_effects", "lineno": 450, "outcome": "passed", "keywords": ["test_can_lower_and_run_jaxpr_with_ordered_effects", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00046184565871953964, "outcome": "passed"}, "call": {"duration": 0.5248920479789376, "outcome": "passed"}, "teardown": {"duration": 0.00018046516925096512, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_can_lower_and_run_jaxpr_with_unordered_effects", "lineno": 457, "outcome": "passed", "keywords": ["test_can_lower_and_run_jaxpr_with_unordered_effects", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00025170017033815384, "outcome": "passed"}, "call": {"duration": 0.17775844130665064, "outcome": "passed"}, "teardown": {"duration": 0.00013416074216365814, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_can_lower_lowerable_effect", "lineno": 303, "outcome": "passed", "keywords": ["test_can_lower_lowerable_effect", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00020539667457342148, "outcome": "passed"}, "call": {"duration": 0.005055372603237629, "outcome": "passed"}, "teardown": {"duration": 0.00010566692799329758, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_can_lower_multiple_effects", "lineno": 506, "outcome": "passed", "keywords": ["test_can_lower_multiple_effects", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00017809029668569565, "outcome": "passed"}, "call": {"duration": 0.1520137982442975, "outcome": "passed"}, "teardown": {"duration": 0.0001329723745584488, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_cannot_lower_unlowerable_effect", "lineno": 310, "outcome": "passed", "keywords": ["test_cannot_lower_unlowerable_effect", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00020421016961336136, "outcome": "passed"}, "call": {"duration": 0.0016419868916273117, "outcome": "passed"}, "teardown": {"duration": 9.498093277215958e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_cant_jit_and_pmap_function_with_ordered_effects", "lineno": 475, "outcome": "skipped", "keywords": ["test_cant_jit_and_pmap_function_with_ordered_effects", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00015790574252605438, "outcome": "passed"}, "call": {"duration": 0.00046540796756744385, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/jaxpr_effects_test.py', 476, \"Skipped: This test won't raise with 1 device.\")"}, "teardown": {"duration": 9.616836905479431e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_cant_jit_and_pmap_function_with_unordered_effects", "lineno": 464, "outcome": "skipped", "keywords": ["test_cant_jit_and_pmap_function_with_unordered_effects", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00015790574252605438, "outcome": "passed"}, "call": {"duration": 0.0003502434119582176, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/jaxpr_effects_test.py', 465, 'Skipped: Test requires >= 2 devices.')"}, "teardown": {"duration": 8.548330515623093e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_lowered_jaxpr_with_multiple_ordered_effects_takes_in_tokens", "lineno": 430, "outcome": "passed", "keywords": ["test_lowered_jaxpr_with_multiple_ordered_effects_takes_in_tokens", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00014840811491012573, "outcome": "passed"}, "call": {"duration": 0.004519917070865631, "outcome": "passed"}, "teardown": {"duration": 0.0001032920554280281, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_lowered_jaxpr_with_ordered_effects_takes_token_inputs", "lineno": 413, "outcome": "passed", "keywords": ["test_lowered_jaxpr_with_ordered_effects_takes_token_inputs", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00016384292393922806, "outcome": "passed"}, "call": {"duration": 0.0037030791863799095, "outcome": "passed"}, "teardown": {"duration": 0.00010210555046796799, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_lowered_jaxpr_without_ordered_effects_takes_no_dummy_inputs", "lineno": 398, "outcome": "passed", "keywords": ["test_lowered_jaxpr_without_ordered_effects_takes_no_dummy_inputs", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001626545563340187, "outcome": "passed"}, "call": {"duration": 0.0036496510729193687, "outcome": "passed"}, "teardown": {"duration": 9.735580533742905e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_lowering_that_doesnt_set_tokens_should_cause_error", "lineno": 331, "outcome": "passed", "keywords": ["test_lowering_that_doesnt_set_tokens_should_cause_error", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001662168651819229, "outcome": "passed"}, "call": {"duration": 0.012915065512061119, "outcome": "passed"}, "teardown": {"duration": 0.00012347660958766937, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_lowering_that_sets_wrong_tokens_should_cause_error", "lineno": 346, "outcome": "passed", "keywords": ["test_lowering_that_sets_wrong_tokens_should_cause_error", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00017215311527252197, "outcome": "passed"}, "call": {"duration": 0.0130005469545722, "outcome": "passed"}, "teardown": {"duration": 0.00010804086923599243, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_nontrivial_lowering_with_ordered_effect_should_consume_token", "lineno": 361, "outcome": "passed", "keywords": ["test_nontrivial_lowering_with_ordered_effect_should_consume_token", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00016859173774719238, "outcome": "passed"}, "call": {"duration": 0.004074691794812679, "outcome": "passed"}, "teardown": {"duration": 0.00010210368782281876, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_nontrivial_lowering_with_unordered_effect_should_consume_token", "lineno": 380, "outcome": "passed", "keywords": ["test_nontrivial_lowering_with_unordered_effect_should_consume_token", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019589904695749283, "outcome": "passed"}, "call": {"duration": 0.003894227556884289, "outcome": "passed"}, "teardown": {"duration": 0.00010566692799329758, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_runtime_tokens_should_update_after_running_effectful_function", "lineno": 494, "outcome": "passed", "keywords": ["test_runtime_tokens_should_update_after_running_effectful_function", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001662168651819229, "outcome": "passed"}, "call": {"duration": 0.01897842437028885, "outcome": "passed"}, "teardown": {"duration": 0.0001317868009209633, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_should_not_pass_tokens_into_unordered_effect", "lineno": 318, "outcome": "passed", "keywords": ["test_should_not_pass_tokens_into_unordered_effect", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019946135580539703, "outcome": "passed"}, "call": {"duration": 0.004612523131072521, "outcome": "passed"}, "teardown": {"duration": 0.00012941192835569382, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectOrderingTest::test_can_execute_python_callback", "lineno": 532, "outcome": "passed", "keywords": ["test_can_execute_python_callback", "EffectOrderingTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00021133292466402054, "outcome": "passed"}, "call": {"duration": 0.13083893340080976, "outcome": "passed"}, "teardown": {"duration": 0.000136534683406353, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectOrderingTest::test_different_threads_get_different_tokens", "lineno": 581, "outcome": "skipped", "keywords": ["test_different_threads_get_different_tokens", "EffectOrderingTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00020895898342132568, "outcome": "passed"}, "call": {"duration": 0.00043572578579187393, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/jaxpr_effects_test.py', 582, 'Skipped: Test requires >= 2 devices.')"}, "teardown": {"duration": 0.00010448042303323746, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectOrderingTest::test_ordered_effect_remains_ordered_across_multiple_devices", "lineno": 550, "outcome": "skipped", "keywords": ["test_ordered_effect_remains_ordered_across_multiple_devices", "__wrapped__", "EffectOrderingTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00016977917402982712, "outcome": "passed"}, "call": {"duration": 0.00034786853939294815, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/jaxpr_effects_test.py', 551, 'Skipped: Test requires >= 2 devices.')"}, "teardown": {"duration": 0.00011516455560922623, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ParallelEffectsTest::test_can_pmap_unordered_callback", "lineno": 645, "outcome": "skipped", "keywords": ["test_can_pmap_unordered_callback", "ParallelEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018521305173635483, "outcome": "passed"}, "call": {"duration": 0.00032887328416109085, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/jaxpr_effects_test.py', 646, 'Skipped: Test requires >= 2 devices.')"}, "teardown": {"duration": 8.904468268156052e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ParallelEffectsTest::test_can_pmap_unordered_effect", "lineno": 637, "outcome": "passed", "keywords": ["test_can_pmap_unordered_effect", "ParallelEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001507829874753952, "outcome": "passed"}, "call": {"duration": 0.25074909534305334, "outcome": "passed"}, "teardown": {"duration": 0.00021489523351192474, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ParallelEffectsTest::test_cannot_pmap_ordered_effect", "lineno": 618, "outcome": "skipped", "keywords": ["test_cannot_pmap_ordered_effect", "ParallelEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00033718254417181015, "outcome": "passed"}, "call": {"duration": 0.0007598502561450005, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/jaxpr_effects_test.py', 619, \"Skipped: This test won't raise with 1 device.\")"}, "teardown": {"duration": 0.00016859080642461777, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ParallelEffectsTest::test_cannot_pmap_unlowerable_effect", "lineno": 608, "outcome": "passed", "keywords": ["test_cannot_pmap_unlowerable_effect", "ParallelEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00036211591213941574, "outcome": "passed"}, "call": {"duration": 0.0077314674854278564, "outcome": "passed"}, "teardown": {"duration": 0.00025882385671138763, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_effect_in_cond", "lineno": 677, "outcome": "passed", "keywords": ["test_allowed_effect_in_cond", "ControlFlowEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004749055951833725, "outcome": "passed"}, "call": {"duration": 0.28160491585731506, "outcome": "passed"}, "teardown": {"duration": 0.00021133292466402054, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_effect_in_cond_body", "lineno": 779, "outcome": "passed", "keywords": ["test_allowed_effect_in_cond_body", "ControlFlowEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003348086029291153, "outcome": "passed"}, "call": {"duration": 0.025381342507898808, "outcome": "passed"}, "teardown": {"duration": 0.00019352510571479797, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_effect_in_cond_jvp", "lineno": 688, "outcome": "passed", "keywords": ["test_allowed_effect_in_cond_jvp", "ControlFlowEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00031818728893995285, "outcome": "passed"}, "call": {"duration": 0.029788468964397907, "outcome": "passed"}, "teardown": {"duration": 0.00012703705579042435, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_effect_in_cond_jvp2", "lineno": 706, "outcome": "passed", "keywords": ["test_allowed_effect_in_cond_jvp2", "ControlFlowEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001947116106748581, "outcome": "passed"}, "call": {"duration": 0.14757936540991068, "outcome": "passed"}, "teardown": {"duration": 0.00013534817844629288, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_effect_in_scan", "lineno": 833, "outcome": "passed", "keywords": ["test_allowed_effect_in_scan", "ControlFlowEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019946135580539703, "outcome": "passed"}, "call": {"duration": 0.2627036655321717, "outcome": "passed"}, "teardown": {"duration": 0.00014247186481952667, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_effect_in_while_body", "lineno": 769, "outcome": "passed", "keywords": ["test_allowed_effect_in_while_body", "ControlFlowEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00020420923829078674, "outcome": "passed"}, "call": {"duration": 0.014707834459841251, "outcome": "passed"}, "teardown": {"duration": 0.00011160317808389664, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_ordered_effect_in_cond", "lineno": 734, "outcome": "passed", "keywords": ["test_allowed_ordered_effect_in_cond", "ControlFlowEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00017215311527252197, "outcome": "passed"}, "call": {"duration": 0.013908804394304752, "outcome": "passed"}, "teardown": {"duration": 0.0001104157418012619, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_ordered_effect_in_scan", "lineno": 841, "outcome": "passed", "keywords": ["test_allowed_ordered_effect_in_scan", "ControlFlowEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001769028604030609, "outcome": "passed"}, "call": {"duration": 0.024391165003180504, "outcome": "passed"}, "teardown": {"duration": 0.00018283724784851074, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_ordered_effect_in_while_body", "lineno": 789, "outcome": "passed", "keywords": ["test_allowed_ordered_effect_in_while_body", "ControlFlowEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00025526154786348343, "outcome": "passed"}, "call": {"duration": 0.01514830905944109, "outcome": "passed"}, "teardown": {"duration": 0.00012703798711299896, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_effects_disallowed_in_cond", "lineno": 665, "outcome": "passed", "keywords": ["test_effects_disallowed_in_cond", "ControlFlowEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019708648324012756, "outcome": "passed"}, "call": {"duration": 0.001894875429570675, "outcome": "passed"}, "teardown": {"duration": 9.97297465801239e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_effects_disallowed_in_scan", "lineno": 858, "outcome": "passed", "keywords": ["test_effects_disallowed_in_scan", "ControlFlowEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001650303602218628, "outcome": "passed"}, "call": {"duration": 0.0013499194756150246, "outcome": "passed"}, "teardown": {"duration": 9.616836905479431e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_effects_disallowed_in_while", "lineno": 810, "outcome": "passed", "keywords": ["test_effects_disallowed_in_while", "ControlFlowEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001626545563340187, "outcome": "passed"}, "call": {"duration": 0.0021430132910609245, "outcome": "passed"}, "teardown": {"duration": 9.735580533742905e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_multiple_allowed_ordered_effect_in_cond", "lineno": 745, "outcome": "passed", "keywords": ["test_multiple_allowed_ordered_effect_in_cond", "ControlFlowEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001555308699607849, "outcome": "passed"}, "call": {"duration": 0.12686159927397966, "outcome": "passed"}, "teardown": {"duration": 0.00016977917402982712, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_multiple_allowed_ordered_effect_in_scan", "lineno": 849, "outcome": "passed", "keywords": ["test_multiple_allowed_ordered_effect_in_scan", "ControlFlowEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00022320635616779327, "outcome": "passed"}, "call": {"duration": 0.133739423006773, "outcome": "passed"}, "teardown": {"duration": 0.0001875879243016243, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_multiple_allowed_ordered_effect_in_while_body", "lineno": 799, "outcome": "passed", "keywords": ["test_multiple_allowed_ordered_effect_in_while_body", "ControlFlowEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00025526247918605804, "outcome": "passed"}, "call": {"duration": 0.01793363131582737, "outcome": "passed"}, "teardown": {"duration": 0.00015197042375802994, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_by_index_properly", "lineno": 886, "outcome": "passed", "keywords": ["test_jaxpr_input_effect_is_tracked_by_index_properly", "JaxprInputEffectTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00024457741528749466, "outcome": "passed"}, "call": {"duration": 0.0011124666780233383, "outcome": "passed"}, "teardown": {"duration": 9.379442781209946e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_through_a_jit", "lineno": 897, "outcome": "passed", "keywords": ["test_jaxpr_input_effect_is_tracked_through_a_jit", "JaxprInputEffectTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001590922474861145, "outcome": "passed"}, "call": {"duration": 0.003496493212878704, "outcome": "passed"}, "teardown": {"duration": 0.00010091718286275864, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_through_cond", "lineno": 1061, "outcome": "passed", "keywords": ["test_jaxpr_input_effect_is_tracked_through_cond", "JaxprInputEffectTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00017215311527252197, "outcome": "passed"}, "call": {"duration": 0.0026119817048311234, "outcome": "passed"}, "teardown": {"duration": 9.973160922527313e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_through_dce", "lineno": 940, "outcome": "passed", "keywords": ["test_jaxpr_input_effect_is_tracked_through_dce", "JaxprInputEffectTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00015909411013126373, "outcome": "passed"}, "call": {"duration": 0.001719159074127674, "outcome": "passed"}, "teardown": {"duration": 9.973160922527313e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_through_partial_eval_custom", "lineno": 920, "outcome": "passed", "keywords": ["test_jaxpr_input_effect_is_tracked_through_partial_eval_custom", "JaxprInputEffectTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001614680513739586, "outcome": "passed"}, "call": {"duration": 0.0008180253207683563, "outcome": "passed"}, "teardown": {"duration": 9.854324162006378e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_through_scan", "lineno": 1004, "outcome": "passed", "keywords": ["test_jaxpr_input_effect_is_tracked_through_scan", "JaxprInputEffectTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00015196949243545532, "outcome": "passed"}, "call": {"duration": 0.14547909423708916, "outcome": "passed"}, "teardown": {"duration": 0.00016740430146455765, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_through_scan_with_dce", "lineno": 1031, "outcome": "passed", "keywords": ["test_jaxpr_input_effect_is_tracked_through_scan_with_dce", "JaxprInputEffectTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00021370779722929, "outcome": "passed"}, "call": {"duration": 0.004174423404037952, "outcome": "passed"}, "teardown": {"duration": 0.00010091811418533325, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_through_while_loop", "lineno": 970, "outcome": "passed", "keywords": ["test_jaxpr_input_effect_is_tracked_through_while_loop", "JaxprInputEffectTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001626545563340187, "outcome": "passed"}, "call": {"duration": 0.005956505425274372, "outcome": "passed"}, "teardown": {"duration": 9.97297465801239e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_simple_jaxpr_input_effect", "lineno": 880, "outcome": "passed", "keywords": ["test_simple_jaxpr_input_effect", "JaxprInputEffectTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00016265548765659332, "outcome": "passed"}, "call": {"duration": 0.0006577437743544579, "outcome": "passed"}, "teardown": {"duration": 0.000416729599237442, "outcome": "passed"}}]}