diff --git a/jaxlib/jax.bzl b/jaxlib/jax.bzl
index 28f236783..8e961fbd0 100644
--- a/jaxlib/jax.bzl
+++ b/jaxlib/jax.bzl
@@ -192,10 +192,13 @@ def _gpu_test_deps():
             "//jaxlib/rocm:gpu_only_test_deps",
             "//jax_plugins:gpu_plugin_only_test_deps",
         ],
-        "//jax:config_build_jaxlib_false": [
+        "//jax:config_build_jaxlib_false": if_rocm_is_configured([
+            "//jaxlib/tools:rocm_plugin_kernels_wheel",
+            "//jaxlib/tools:rocm_plugin_pjrt_wheel",
+        ]) + if_cuda_is_configured([
             "//jaxlib/tools:pypi_jax_cuda_plugin_with_cuda_deps",
             "//jaxlib/tools:pypi_jax_cuda_pjrt_with_cuda_deps",
-        ],
+        ]),
         "//jax:config_build_jaxlib_wheel": [
             "//jaxlib/tools:jax_cuda_plugin_py_import",
             "//jaxlib/tools:jax_cuda_pjrt_py_import",
@@ -304,6 +307,7 @@ def jax_multiplatform_test(
             tags = test_tags,
             main = main,
             exec_properties = tf_exec_properties({"tags": test_tags}),
+            legacy_create_init = 0,
         )
 
 def jax_generate_backend_suites(backends = []):
diff --git a/jaxlib/tools/BUILD.bazel b/jaxlib/tools/BUILD.bazel
index 3a1a48736..8618f5e74 100644
--- a/jaxlib/tools/BUILD.bazel
+++ b/jaxlib/tools/BUILD.bazel
@@ -137,9 +137,25 @@ string_flag(
 py_binary(
     name = "build_wheel_tool",
     srcs = ["build_wheel.py"],
+    data = [
+        "LICENSE.txt",
+        "//jaxlib",
+        "//jaxlib:README.md",
+        "//jaxlib:_ifrt_proxy.pyi",
+        "//jaxlib:_pathways.pyi",
+        "//jaxlib:init.py",
+        "//jaxlib:jaxlib_binaries",
+        "//jaxlib:setup.py",
+        "//jaxlib:weakref_lru_cache.pyi",
+        "//jaxlib/mlir/_mlir_libs:_triton_ext.pyi",
+        "//jaxlib/mosaic/dialect/gpu:_mosaic_gpu_gen_enums.py",
+        "//jaxlib/mosaic/dialect/gpu:_mosaic_gpu_gen_ops.py",
+        "@xla//xla/ffi/api:ffi",
+    ],
     main = "build_wheel.py",
     deps = [
         ":build_utils",
+        "//jaxlib:jaxlib_files",
         "@bazel_tools//tools/python/runfiles",
         "@pypi//build",
         "@pypi//setuptools",
@@ -451,6 +467,16 @@ py_import(
     wheel = ":jaxlib_wheel",
 )
 
+py_import(
+    name = "rocm_plugin_kernels_wheel",
+    wheel = "@pypi_jax_rocm7_plugin//:whl",
+)
+
+py_import(
+    name = "rocm_plugin_pjrt_wheel",
+    wheel = "@pypi_jax_rocm7_pjrt//:whl",
+)
+
 py_import(
     name = "jax_cuda_plugin_py_import",
     wheel = ":jax_cuda{cuda}_plugin_wheel".format(cuda = cuda_major_version),
diff --git a/jaxlib/tools/build_wheel.py b/jaxlib/tools/build_wheel.py
index 593dfcdaa..a0d24d4f5 100644
--- a/jaxlib/tools/build_wheel.py
+++ b/jaxlib/tools/build_wheel.py
@@ -59,6 +59,12 @@ parser.add_argument(
 parser.add_argument(
     "--srcs", help="source files for the wheel", action="append"
 )
+parser.add_argument(
+    "--build_from_external_workspace",
+    action="store_true",
+    help="Set when building from an external/umbrella workspace where jax is @jax. "
+    "When true, source prefix is 'jax/' instead of '__main__/'.",
+)
 args = parser.parse_args()
 
 r = runfiles.Create()
@@ -116,7 +122,7 @@ def verify_mac_libraries_dont_reference_chkstack(
   if not _is_mac():
     return
   file_path = _get_file_path(
-      f"__main__/jaxlib/_jax.{pyext}", runfiles, wheel_sources_map
+      f"{jax_source_prefix}jaxlib/_jax.{pyext}", runfiles, wheel_sources_map
   )
   nm = subprocess.run(
       ["nm", "-g", file_path],
@@ -147,8 +153,16 @@ plat_name={tag}
 
 
 def prepare_wheel(wheel_sources_path: pathlib.Path, *, cpu, wheel_sources):
-  """Assembles a source tree for the wheel in `wheel_sources_path`."""
-  source_file_prefix = build_utils.get_source_file_prefix(wheel_sources)
+  """Assembles a source tree for the wheel in `wheel_sources_path`. In case of
+  build under @jax strip the prefix"""
+  # wheel_sources is a list of file paths, not a prefix. If provided, use empty prefix.
+  # Otherwise, determine prefix based on build_from_external_workspace flag.
+  if wheel_sources:
+    source_file_prefix = ""
+  elif args.build_from_external_workspace:
+    source_file_prefix = "jax/"
+  else:
+    source_file_prefix = "__main__/"
   # The wheel sources provided by the transitive rules might have different path
   # prefixes, so we need to create a map of paths relative to the root package
   # to the full paths.
@@ -389,13 +403,25 @@ def prepare_wheel(wheel_sources_path: pathlib.Path, *, cpu, wheel_sources):
       wheel_sources_map=wheel_sources_map,
   )
 
+  # XLA FFI headers have different paths depending on build method:
+  # - wheel_sources_map: "xla/ffi/api/..." (mapped from external/xla/xla/ffi/api/...)
+  # - runfiles: "{source_file_prefix}jaxlib/include/xla/ffi/api/..." (copied to jaxlib/include/)
+  if args.build_from_external_workspace:
+    xla_ffi_files = [
+        f"{source_file_prefix}jaxlib/include/xla/ffi/api/c_api.h",
+        f"{source_file_prefix}jaxlib/include/xla/ffi/api/api.h",
+        f"{source_file_prefix}jaxlib/include/xla/ffi/api/ffi.h",
+    ]
+  else:
+    xla_ffi_files = [
+        "xla/ffi/api/c_api.h",
+        "xla/ffi/api/api.h",
+        "xla/ffi/api/ffi.h",
+    ]
+
   copy_files(
       dst_dir=jaxlib_dir / "include" / "xla" / "ffi" / "api",
-      src_files=[
-          "xla/ffi/api/c_api.h",
-          "xla/ffi/api/api.h",
-          "xla/ffi/api/ffi.h",
-      ],
+      src_files=xla_ffi_files,
   )
 
 tmpdir = None
