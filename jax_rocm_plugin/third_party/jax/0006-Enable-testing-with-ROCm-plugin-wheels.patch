diff --git a/jaxlib/jax.bzl b/jaxlib/jax.bzl
index 067e4dd6e..5e0319b45 100644
--- a/jaxlib/jax.bzl
+++ b/jaxlib/jax.bzl
@@ -192,10 +192,13 @@ def _gpu_test_deps():
             "//jaxlib/rocm:gpu_only_test_deps",
             "//jax_plugins:gpu_plugin_only_test_deps",
         ],
-        "//jax:config_build_jaxlib_false": [
+        "//jax:config_build_jaxlib_false": if_rocm_is_configured([
+            "//jaxlib/tools:rocm_plugin_kernels_wheel",
+            "//jaxlib/tools:rocm_plugin_pjrt_wheel",
+        ]) + if_cuda_is_configured([
             "//jaxlib/tools:pypi_jax_cuda_plugin_with_cuda_deps",
             "//jaxlib/tools:pypi_jax_cuda_pjrt_with_cuda_deps",
-        ],
+        ]),
         "//jax:config_build_jaxlib_wheel": [
             "//jaxlib/tools:jax_cuda_plugin_py_import",
             "//jaxlib/tools:jax_cuda_pjrt_py_import",
@@ -302,7 +305,8 @@ def jax_multiplatform_test(
             shard_count = test_shards,
             tags = test_tags,
             main = main,
-            exec_properties = tf_exec_properties({"tags": test_tags}),
+            exec_properties = {},  #tf_exec_properties({"tags": test_tags}),
+            legacy_create_init = 0,
         )
 
 def jax_generate_backend_suites(backends = []):
diff --git a/jaxlib/tools/BUILD.bazel b/jaxlib/tools/BUILD.bazel
index 3a1a48736..a1862ba28 100644
--- a/jaxlib/tools/BUILD.bazel
+++ b/jaxlib/tools/BUILD.bazel
@@ -137,9 +137,25 @@ string_flag(
 py_binary(
     name = "build_wheel_tool",
     srcs = ["build_wheel.py"],
+    data = [
+        "LICENSE.txt",
+        "//jaxlib",
+        "//jaxlib:jaxlib_binaries",
+        "//jaxlib:README.md",
+        "//jaxlib:setup.py",
+        "//jaxlib:init.py",
+        "//jaxlib:weakref_lru_cache.pyi",
+        "//jaxlib:_ifrt_proxy.pyi",
+        "//jaxlib:_pathways.pyi",
+        "//jaxlib/mlir/_mlir_libs:_triton_ext.pyi",
+        "//jaxlib/mosaic/dialect/gpu:_mosaic_gpu_gen_enums.py",
+        "//jaxlib/mosaic/dialect/gpu:_mosaic_gpu_gen_ops.py",
+        "@xla//xla/ffi/api:ffi",
+    ],
     main = "build_wheel.py",
     deps = [
         ":build_utils",
+        "//jaxlib:jaxlib_files",
         "@bazel_tools//tools/python/runfiles",
         "@pypi//build",
         "@pypi//setuptools",
@@ -476,6 +492,24 @@ py_import(
     wheel_deps = if_pypi_cuda_wheel_deps([":nvidia_wheel_deps"]),
 )
 
+filegroup(
+    name = "rocm_wheel_deps",
+    srcs = [
+    ],
+)
+
+py_import(
+    name = "rocm_plugin_kernels_wheel",
+    wheel = "@pypi_jax_rocm7_plugin//:whl",
+    wheel_deps = [":rocm_wheel_deps"],
+)
+
+py_import(
+    name = "rocm_plugin_pjrt_wheel",
+    wheel = "@pypi_jax_rocm7_pjrt//:whl",
+    wheel_deps = [":rocm_wheel_deps"],
+)
+
 # Mosaic GPU
 
 py_binary(
diff --git a/jaxlib/tools/build_wheel.py b/jaxlib/tools/build_wheel.py
index cb44d694c..85003c3d5 100644
--- a/jaxlib/tools/build_wheel.py
+++ b/jaxlib/tools/build_wheel.py
@@ -146,9 +146,26 @@ plat_name={tag}
     )
 
 
+def _detect_source_file_prefix(runfiles):
+  """Detect the correct runfiles prefix for jaxlib files.
+
+  When building from inside the jax repository, files are at __main__/jaxlib/...
+  When building as @jax external repository, files are at jax/jaxlib/...
+  When wheel_sources are provided, no prefix is needed.
+  """
+  # Try __main__ first (building from inside jax repo)
+  if runfiles.Rlocation("__main__/jaxlib/tools/LICENSE.txt"):
+    return "__main__/"
+  # Try jax/ (building as @jax external repository)
+  if runfiles.Rlocation("jax/jaxlib/tools/LICENSE.txt"):
+    return "jax/"
+  # Fallback to empty prefix (wheel_sources should be provided)
+  return ""
+
+
 def prepare_wheel(wheel_sources_path: pathlib.Path, *, cpu, wheel_sources):
   """Assembles a source tree for the wheel in `wheel_sources_path`."""
-  source_file_prefix = build_utils.get_source_file_prefix(wheel_sources)
+  source_file_prefix = _detect_source_file_prefix(r) if not wheel_sources else ""
   # The wheel sources provided by the transitive rules might have different path
   # prefixes, so we need to create a map of paths relative to the root package
   # to the full paths.
@@ -159,7 +176,7 @@ def prepare_wheel(wheel_sources_path: pathlib.Path, *, cpu, wheel_sources):
   # 'bazel-out/k8-opt/bin/jaxlib/mlir/_mlir_libs/_jax_mlir_ext.py',
   # 'xla/ffi/api/c_api.h': 'external/xla/xla/ffi/api/c_api.h'}
   wheel_sources_map = build_utils.create_wheel_sources_map(
-      wheel_sources, root_packages=["jaxlib", "xla"]
+      wheel_sources, root_packages=["jaxlib", "xla", "jax"]
   )
   copy_files = functools.partial(
       build_utils.copy_file,
@@ -391,9 +408,9 @@ def prepare_wheel(wheel_sources_path: pathlib.Path, *, cpu, wheel_sources):
   copy_files(
       dst_dir=jaxlib_dir / "include" / "xla" / "ffi" / "api",
       src_files=[
-          "xla/xla/ffi/api/c_api.h",
-          "xla/xla/ffi/api/api.h",
-          "xla/xla/ffi/api/ffi.h",
+          f"{source_file_prefix}jaxlib/include/xla/ffi/api/c_api.h",
+          f"{source_file_prefix}jaxlib/include/xla/ffi/api/api.h",
+          f"{source_file_prefix}jaxlib/include/xla/ffi/api/ffi.h",
       ],
   )
 
