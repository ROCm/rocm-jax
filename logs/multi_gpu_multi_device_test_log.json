{"created": 1763600090.2259135, "duration": 27.00115728378296, "exitcode": 1, "root": "/dockerx/rocm/rocm-jax/jax", "environment": {}, "summary": {"passed": 17, "failed": 1, "total": 18, "collected": 18}, "collectors": [{"nodeid": "", "outcome": "passed", "result": [{"nodeid": "tests/multi_device_test.py", "type": "Module"}]}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest", "outcome": "passed", "result": [{"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_broadcast", "type": "TestCaseFunction", "lineno": 189}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_closed_over_values_device_placement", "type": "TestCaseFunction", "lineno": 167}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_computation_follows_data", "type": "TestCaseFunction", "lineno": 46}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_computation_follows_data_prng", "type": "TestCaseFunction", "lineno": 118}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_device_put", "type": "TestCaseFunction", "lineno": 139}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_device_put_committed_check", "type": "TestCaseFunction", "lineno": 239}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_different_devices_input_error", "type": "TestCaseFunction", "lineno": 213}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_grad_device_put_src_inference", "type": "TestCaseFunction", "lineno": 245}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_lax_full_like_custom_shape_sharded", "type": "TestCaseFunction", "lineno": 275}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_lax_full_like_efficient", "type": "TestCaseFunction", "lineno": 297}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_lax_full_like_same_device", "type": "TestCaseFunction", "lineno": 267}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_lax_full_like_sharding", "type": "TestCaseFunction", "lineno": 259}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_lax_full_like_single_device", "type": "TestCaseFunction", "lineno": 284}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_lax_full_sharding", "type": "TestCaseFunction", "lineno": 252}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_primitive_compilation_cache", "type": "TestCaseFunction", "lineno": 125}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_reshape", "type": "TestCaseFunction", "lineno": 180}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_single_input_committed_multi_output", "type": "TestCaseFunction", "lineno": 199}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_transpose", "type": "TestCaseFunction", "lineno": 226}]}, {"nodeid": "tests/multi_device_test.py", "outcome": "passed", "result": [{"nodeid": "tests/multi_device_test.py::MultiDeviceTest", "type": "UnitTestCase"}]}], "tests": [{"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_broadcast", "lineno": 189, "outcome": "passed", "keywords": ["test_broadcast", "MultiDeviceTest", "multi_device_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003101881593465805, "outcome": "passed"}, "call": {"duration": 15.87172590661794, "outcome": "passed"}, "teardown": {"duration": 0.00014389213174581528, "outcome": "passed"}}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_closed_over_values_device_placement", "lineno": 167, "outcome": "passed", "keywords": ["test_closed_over_values_device_placement", "MultiDeviceTest", "multi_device_test.py", "tests", "jax", ""], "setup": {"duration": 0.0002033105120062828, "outcome": "passed"}, "call": {"duration": 1.535571032203734, "outcome": "passed"}, "teardown": {"duration": 0.00013661198318004608, "outcome": "passed"}}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_computation_follows_data", "lineno": 46, "outcome": "passed", "keywords": ["test_computation_follows_data", "MultiDeviceTest", "multi_device_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019395630806684494, "outcome": "passed"}, "call": {"duration": 3.812872310169041, "outcome": "passed"}, "teardown": {"duration": 0.0001286594197154045, "outcome": "passed"}}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_computation_follows_data_prng", "lineno": 118, "outcome": "passed", "keywords": ["test_computation_follows_data_prng", "__wrapped__", "MultiDeviceTest", "multi_device_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001971907913684845, "outcome": "passed"}, "call": {"duration": 0.5166510734707117, "outcome": "passed"}, "teardown": {"duration": 0.0001278892159461975, "outcome": "passed"}}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_device_put", "lineno": 139, "outcome": "passed", "keywords": ["test_device_put", "MultiDeviceTest", "multi_device_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019891280680894852, "outcome": "passed"}, "call": {"duration": 0.00270210113376379, "outcome": "passed"}, "teardown": {"duration": 8.330307900905609e-05, "outcome": "passed"}}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_device_put_committed_check", "lineno": 239, "outcome": "passed", "keywords": ["test_device_put_committed_check", "MultiDeviceTest", "multi_device_test.py", "tests", "jax", ""], "setup": {"duration": 0.00014788750559091568, "outcome": "passed"}, "call": {"duration": 0.01275712251663208, "outcome": "passed"}, "teardown": {"duration": 9.184423834085464e-05, "outcome": "passed"}}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_different_devices_input_error", "lineno": 213, "outcome": "passed", "keywords": ["test_different_devices_input_error", "MultiDeviceTest", "multi_device_test.py", "tests", "jax", ""], "setup": {"duration": 0.00029409583657979965, "outcome": "passed"}, "call": {"duration": 0.0022930074483156204, "outcome": "passed"}, "teardown": {"duration": 0.0001485385000705719, "outcome": "passed"}}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_grad_device_put_src_inference", "lineno": 245, "outcome": "passed", "keywords": ["test_grad_device_put_src_inference", "MultiDeviceTest", "multi_device_test.py", "tests", "jax", ""], "setup": {"duration": 0.00027474481612443924, "outcome": "passed"}, "call": {"duration": 0.0034259799867868423, "outcome": "passed"}, "teardown": {"duration": 0.00015847384929656982, "outcome": "passed"}}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_lax_full_like_custom_shape_sharded", "lineno": 275, "outcome": "passed", "keywords": ["test_lax_full_like_custom_shape_sharded", "MultiDeviceTest", "multi_device_test.py", "tests", "jax", ""], "setup": {"duration": 0.00028966832906007767, "outcome": "passed"}, "call": {"duration": 3.4448116859421134, "outcome": "passed"}, "teardown": {"duration": 0.00012589618563652039, "outcome": "passed"}}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_lax_full_like_efficient", "lineno": 297, "outcome": "failed", "keywords": ["test_lax_full_like_efficient", "MultiDeviceTest", "multi_device_test.py", "tests", "jax", ""], "setup": {"duration": 0.00016775727272033691, "outcome": "passed"}, "call": {"duration": 0.00033844076097011566, "outcome": "failed", "crash": {"path": "/dockerx/rocm/rocm-jax/jax/tests/multi_device_test.py", "lineno": 307, "message": "KeyError: 'bytes_reservable_limit'"}, "traceback": [{"path": "jax/tests/multi_device_test.py", "lineno": 307, "message": "KeyError"}], "longrepr": "self = <tests.multi_device_test.MultiDeviceTest testMethod=test_lax_full_like_efficient>\n\n    def test_lax_full_like_efficient(self):\n      devices = self.get_devices()\n      if len(devices) < 4:\n        self.skipTest(\"test requires 4 devices\")\n      mem_stats = devices[0].memory_stats()\n      if mem_stats is None:\n        self.skipTest('Only can run test on device with mem_stats')\n      mesh = Mesh(devices, axis_names=(\"i\"))\n      sharding = NamedSharding(mesh, P('i'))\n>     available_memory = mem_stats['bytes_reservable_limit']\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE     KeyError: 'bytes_reservable_limit'\n\njax/tests/multi_device_test.py:307: KeyError"}, "teardown": {"duration": 9.8484568297863e-05, "outcome": "passed"}}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_lax_full_like_same_device", "lineno": 267, "outcome": "passed", "keywords": ["test_lax_full_like_same_device", "MultiDeviceTest", "multi_device_test.py", "tests", "jax", ""], "setup": {"duration": 0.00014960113912820816, "outcome": "passed"}, "call": {"duration": 0.12714814580976963, "outcome": "passed"}, "teardown": {"duration": 0.0001233825460076332, "outcome": "passed"}}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_lax_full_like_sharding", "lineno": 259, "outcome": "passed", "keywords": ["test_lax_full_like_sharding", "MultiDeviceTest", "multi_device_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019120238721370697, "outcome": "passed"}, "call": {"duration": 0.2796257510781288, "outcome": "passed"}, "teardown": {"duration": 0.00023033097386360168, "outcome": "passed"}}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_lax_full_like_single_device", "lineno": 284, "outcome": "passed", "keywords": ["test_lax_full_like_single_device", "MultiDeviceTest", "multi_device_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004095453768968582, "outcome": "passed"}, "call": {"duration": 0.03792821895331144, "outcome": "passed"}, "teardown": {"duration": 0.00021553877741098404, "outcome": "passed"}}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_lax_full_sharding", "lineno": 252, "outcome": "passed", "keywords": ["test_lax_full_sharding", "MultiDeviceTest", "multi_device_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004067299887537956, "outcome": "passed"}, "call": {"duration": 0.04000913165509701, "outcome": "passed"}, "teardown": {"duration": 0.00018261931836605072, "outcome": "passed"}}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_primitive_compilation_cache", "lineno": 125, "outcome": "passed", "keywords": ["test_primitive_compilation_cache", "__wrapped__", "MultiDeviceTest", "multi_device_test.py", "tests", "jax", ""], "setup": {"duration": 0.00031217094510793686, "outcome": "passed"}, "call": {"duration": 0.16694713849574327, "outcome": "passed"}, "teardown": {"duration": 0.00012297183275222778, "outcome": "passed"}}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_reshape", "lineno": 180, "outcome": "passed", "keywords": ["test_reshape", "MultiDeviceTest", "multi_device_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001930147409439087, "outcome": "passed"}, "call": {"duration": 0.12276210635900497, "outcome": "passed"}, "teardown": {"duration": 0.0001232316717505455, "outcome": "passed"}}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_single_input_committed_multi_output", "lineno": 199, "outcome": "passed", "keywords": ["test_single_input_committed_multi_output", "MultiDeviceTest", "multi_device_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001930147409439087, "outcome": "passed"}, "call": {"duration": 0.14975128881633282, "outcome": "passed"}, "teardown": {"duration": 0.00023607909679412842, "outcome": "passed"}}, {"nodeid": "tests/multi_device_test.py::MultiDeviceTest::test_transpose", "lineno": 226, "outcome": "passed", "keywords": ["test_transpose", "MultiDeviceTest", "multi_device_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004043569788336754, "outcome": "passed"}, "call": {"duration": 0.32276667933911085, "outcome": "passed"}, "teardown": {"duration": 0.00025854166597127914, "outcome": "passed"}}]}