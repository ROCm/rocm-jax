{"created": 1763602802.8967886, "duration": 807.0551550388336, "exitcode": 1, "root": "/dockerx/rocm/rocm-jax/jax", "environment": {}, "summary": {"passed": 305, "skipped": 69, "rerun": 1, "failed": 6, "total": 381, "collected": 381}, "collectors": [{"nodeid": "", "outcome": "passed", "result": [{"nodeid": "tests/shard_map_test.py", "type": "Module"}]}, {"nodeid": "tests/shard_map_test.py::ShardMapTest", "outcome": "passed", "result": [{"nodeid": "tests/shard_map_test.py::ShardMapTest::test_all_gather", "type": "TestCaseFunction", "lineno": 92}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_all_gather_invariant_basic", "type": "TestCaseFunction", "lineno": 111}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_all_gather_invariant_complex", "type": "TestCaseFunction", "lineno": 133}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_all_gather_with_axis_index_groups", "type": "TestCaseFunction", "lineno": 169}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_all_gather_with_vma_in_types", "type": "TestCaseFunction", "lineno": 3579}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_all_to_all_grad", "type": "TestCaseFunction", "lineno": 713}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_all_to_all_multiple_axis_names", "type": "TestCaseFunction", "lineno": 615}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_all_to_all_single_axis_name", "type": "TestCaseFunction", "lineno": 615}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_all_to_all_with_axis_index_groups", "type": "TestCaseFunction", "lineno": 680}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_approx_top_k", "type": "TestCaseFunction", "lineno": 2445}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_argmax_pvary", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_axis_env_extension_regression", "type": "TestCaseFunction", "lineno": 2287}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_axis_index", "type": "TestCaseFunction", "lineno": 966}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_axis_index_basic0", "type": "TestCaseFunction", "lineno": 1718}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_axis_index_basic1", "type": "TestCaseFunction", "lineno": 1718}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_axis_index_eager", "type": "TestCaseFunction", "lineno": 1752}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_axis_index_explicit_mesh_eager_shmap", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_axis_index_twoaxes0", "type": "TestCaseFunction", "lineno": 1731}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_axis_index_twoaxes1", "type": "TestCaseFunction", "lineno": 1731}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_axis_size_1_partial_auto", "type": "TestCaseFunction", "lineno": 3098}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_check_rep_failure_inside_rule0", "type": "TestCaseFunction", "lineno": 2344}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_check_rep_failure_inside_rule1", "type": "TestCaseFunction", "lineno": 2344}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_check_rep_false_doesnt_hit_rep_rules", "type": "TestCaseFunction", "lineno": 1071}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_check_rep_false_grads", "type": "TestCaseFunction", "lineno": 2258}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_close_over_explicit_sharded_input_error", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_close_over_input_explict_ctx_mesh", "type": "TestCaseFunction", "lineno": 2860}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_collective_permute", "type": "TestCaseFunction", "lineno": 279}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_collective_permute_with_multiple_axis_names", "type": "TestCaseFunction", "lineno": 582}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_collectives_not_saved", "type": "TestCaseFunction", "lineno": 1059}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_cond_pvary_errors", "type": "TestCaseFunction", "lineno": 3651}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_cond_pvary_errors_pytree", "type": "TestCaseFunction", "lineno": 3665}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_cond_rep_rule", "type": "TestCaseFunction", "lineno": 1614}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_conv_general_dilated", "type": "TestCaseFunction", "lineno": 2359}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_cumsum", "type": "TestCaseFunction", "lineno": 2375}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_custom_jvp_inside_jit", "type": "TestCaseFunction", "lineno": 2381}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_custom_jvp_symbolic_zeros", "type": "TestCaseFunction", "lineno": 3627}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_custom_linear_solve_rep_rules", "type": "TestCaseFunction", "lineno": 3469}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_custom_vjp_replication_error_message_hint", "type": "TestCaseFunction", "lineno": 2411}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_dce", "type": "TestCaseFunction", "lineno": 1854}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_debug_print_eager", "type": "TestCaseFunction", "lineno": 1404}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_debug_print_jit0", "type": "TestCaseFunction", "lineno": 1333}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_debug_print_jit1", "type": "TestCaseFunction", "lineno": 1333}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_debug_print_jit_partial_auto", "type": "TestCaseFunction", "lineno": 1387}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_device_put", "type": "TestCaseFunction", "lineno": 1780}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_different_devices_shmap_abstract_mesh_cache_hit", "type": "TestCaseFunction", "lineno": 1266}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_disable_jit", "type": "TestCaseFunction", "lineno": 2452}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_dynamic_slice_transpose", "type": "TestCaseFunction", "lineno": 3321}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_eager_control_flow", "type": "TestCaseFunction", "lineno": 852}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_eager_custom_jvp_basic", "type": "TestCaseFunction", "lineno": 1683}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_eager_custom_vjp_basic", "type": "TestCaseFunction", "lineno": 1699}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_eager_repr", "type": "TestCaseFunction", "lineno": 742}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_erf_rules", "type": "TestCaseFunction", "lineno": 2393}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_error_for_variable_num_args", "type": "TestCaseFunction", "lineno": 2399}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_eval_shape_vma", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_fanin_psum_transposes_to_fanout", "type": "TestCaseFunction", "lineno": 2142}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_fanout_specs_transpose_to_psum", "type": "TestCaseFunction", "lineno": 2129}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness0", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness1", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness10", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness11", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness12", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness13", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness14", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness15", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness16", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness17", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness18", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness19", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness2", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness20", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness21", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness22", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness23", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness24", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness25", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness26", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness27", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness28", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness29", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness3", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness30", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness31", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness32", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness33", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness34", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness35", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness36", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness37", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness38", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness39", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness4", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness40", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness41", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness42", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness43", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness44", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness45", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness46", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness47", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness48", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness49", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness5", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness50", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness51", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness52", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness53", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness54", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness55", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness56", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness57", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness58", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness59", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness6", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness60", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness61", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness62", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness63", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness7", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness8", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness9", "type": "TestCaseFunction", "lineno": 2516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_functools_partial_rank_error", "type": "TestCaseFunction", "lineno": 1495}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_get_check_rep", "type": "TestCaseFunction", "lineno": 3513}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_grad_nested_partial_auto", "type": "TestCaseFunction", "lineno": 3055}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_grad_nested_partial_auto_with_residuals", "type": "TestCaseFunction", "lineno": 3078}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_grad_remat", "type": "TestCaseFunction", "lineno": 3261}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_grad_shmap_residuals_axis_names_in_mesh_order", "type": "TestCaseFunction", "lineno": 3296}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_identity", "type": "TestCaseFunction", "lineno": 73}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_in_spec_none", "type": "TestCaseFunction", "lineno": 3369}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_in_spec_none_divisibility_errors", "type": "TestCaseFunction", "lineno": 3421}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_in_spec_none_hashability", "type": "TestCaseFunction", "lineno": 3500}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_in_spec_none_rank_errors", "type": "TestCaseFunction", "lineno": 3445}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_in_specs_none_error", "type": "TestCaseFunction", "lineno": 1507}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_jacrev_explicit", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_jacrev_explicit_complex", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_jaxpr_shardings_with_no_outputs", "type": "TestCaseFunction", "lineno": 1763}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_jnp_histogram", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_jvp_basic", "type": "TestCaseFunction", "lineno": 756}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_key_array_with_replicated_last_tile_dim", "type": "TestCaseFunction", "lineno": 1802}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_linalg_inv", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_linearize_basic", "type": "TestCaseFunction", "lineno": 764}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_linearize_basic_repres", "type": "TestCaseFunction", "lineno": 778}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_linearize_basic_repres_jit", "type": "TestCaseFunction", "lineno": 792}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_matmul_partial", "type": "TestCaseFunction", "lineno": 208}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_matmul_reduce_scatter", "type": "TestCaseFunction", "lineno": 224}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_mul_with_vma_in_types", "type": "TestCaseFunction", "lineno": 3558}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_multiple_result_primitive_with_none_sharding", "type": "TestCaseFunction", "lineno": 1097}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_mutable_array_arg_basic", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_mutable_array_internal_basic", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_nested_partial_auto", "type": "TestCaseFunction", "lineno": 2999}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_nested_partial_auto_1d_0", "type": "TestCaseFunction", "lineno": 3018}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_nested_partial_auto_1d_1", "type": "TestCaseFunction", "lineno": 3018}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_nested_partial_auto_1d_2", "type": "TestCaseFunction", "lineno": 3018}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_nested_partial_auto_1d_3", "type": "TestCaseFunction", "lineno": 3018}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_nested_vmap_with_capture_spmd_axis_name", "type": "TestCaseFunction", "lineno": 1211}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_no_mesh_context_error", "type": "TestCaseFunction", "lineno": 3820}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_optimize_remat", "type": "TestCaseFunction", "lineno": 978}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_outer_jit_detects_shard_map_mesh", "type": "TestCaseFunction", "lineno": 868}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto", "type": "TestCaseFunction", "lineno": 2661}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_axis_index", "type": "TestCaseFunction", "lineno": 3156}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_axis_index_degenerated_axis", "type": "TestCaseFunction", "lineno": 3169}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_axis_index_eager", "type": "TestCaseFunction", "lineno": 1422}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_debug_print", "type": "TestCaseFunction", "lineno": 3217}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_error_invalid_auto", "type": "TestCaseFunction", "lineno": 2931}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_error_wrong_in_specs", "type": "TestCaseFunction", "lineno": 2954}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_error_wsc_manual", "type": "TestCaseFunction", "lineno": 2908}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_explicit", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_explicit_multi_explicit", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_explicit_no_set_mesh", "type": "TestCaseFunction", "lineno": 2695}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_mismatch_mesh_error", "type": "TestCaseFunction", "lineno": 2977}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_of_pjit", "type": "TestCaseFunction", "lineno": 3116}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_of_pjit_different_mesh", "type": "TestCaseFunction", "lineno": 3133}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_of_random_keys", "type": "TestCaseFunction", "lineno": 3235}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_of_random_keys_slice", "type": "TestCaseFunction", "lineno": 3249}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_ppermute", "type": "TestCaseFunction", "lineno": 3181}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_propagate_through", "type": "TestCaseFunction", "lineno": 2789}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_eval_custom_axis_env", "type": "TestCaseFunction", "lineno": 1436}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_manual_explicit_shmap_1", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_manual_explicit_shmap_2", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_pbroadcast_fully_replicated", "type": "TestCaseFunction", "lineno": 647}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_pbroadcast_partial_replicated", "type": "TestCaseFunction", "lineno": 647}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_pmax", "type": "TestCaseFunction", "lineno": 3542}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_pmax_vma_in_types", "type": "TestCaseFunction", "lineno": 3549}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_pmin", "type": "TestCaseFunction", "lineno": 3535}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_post_process", "type": "TestCaseFunction", "lineno": 949}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_post_process_partial_eval_with_scalar_res", "type": "TestCaseFunction", "lineno": 1905}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_print_inside_shard_map0", "type": "TestCaseFunction", "lineno": 3338}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_print_inside_shard_map1", "type": "TestCaseFunction", "lineno": 3338}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_print_inside_shard_map2", "type": "TestCaseFunction", "lineno": 3338}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_prngkeyarray_eager", "type": "TestCaseFunction", "lineno": 1449}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_process_env_traces", "type": "TestCaseFunction", "lineno": 840}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_psend_precv_basic_two_gpus", "type": "TestCaseFunction", "lineno": 297}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_psend_precv_basic_with_dangling_recv", "type": "TestCaseFunction", "lineno": 444}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_psend_precv_basic_with_deadlock_cycle", "type": "TestCaseFunction", "lineno": 405}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_psend_precv_basic_with_duplicate_source_target_pairs", "type": "TestCaseFunction", "lineno": 514}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_psend_precv_basic_with_no_deadlock_cycle", "type": "TestCaseFunction", "lineno": 343}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_psend_precv_basic_with_non_matching_source_target_pairs", "type": "TestCaseFunction", "lineno": 475}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_psend_precv_reverse_two_gpus", "type": "TestCaseFunction", "lineno": 553}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_psum_not_under_shmap_error", "type": "TestCaseFunction", "lineno": 2629}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_psum_transpose_non_zero_cts", "type": "TestCaseFunction", "lineno": 1371}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_psum_with_implicit_fanout_self_transposes", "type": "TestCaseFunction", "lineno": 2154}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_pure_callback_return_multiple_arrays", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_pvary", "type": "TestCaseFunction", "lineno": 2216}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_pvary_in_shmap_of_grad", "type": "TestCaseFunction", "lineno": 3824}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_random_beta_vma", "type": "TestCaseFunction", "lineno": 4139}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_random_choice_pvary", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_random_normal_rules", "type": "TestCaseFunction", "lineno": 2387}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_rank_errors", "type": "TestCaseFunction", "lineno": 915}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_reduce_scatter_with_axis_index_groups", "type": "TestCaseFunction", "lineno": 246}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_remat_basic", "type": "TestCaseFunction", "lineno": 1004}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_remat_scalar_residuals", "type": "TestCaseFunction", "lineno": 1046}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_rep_none_canonicalization", "type": "TestCaseFunction", "lineno": 3595}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_rep_none_canonicalization_again", "type": "TestCaseFunction", "lineno": 3619}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_repeated_psum_allowed", "type": "TestCaseFunction", "lineno": 2433}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_replication_checker_eager", "type": "TestCaseFunction", "lineno": 806}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_replication_checker_jit", "type": "TestCaseFunction", "lineno": 824}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_res_forwarding_optimization0", "type": "TestCaseFunction", "lineno": 2299}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_res_forwarding_optimization1", "type": "TestCaseFunction", "lineno": 2299}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_res_forwarding_optimization2", "type": "TestCaseFunction", "lineno": 2299}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_res_forwarding_optimization3", "type": "TestCaseFunction", "lineno": 2299}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_res_forwarding_optimization_complex0", "type": "TestCaseFunction", "lineno": 2321}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_res_forwarding_optimization_complex1", "type": "TestCaseFunction", "lineno": 2321}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_res_forwarding_optimization_complex2", "type": "TestCaseFunction", "lineno": 2321}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_res_forwarding_optimization_complex3", "type": "TestCaseFunction", "lineno": 2321}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_returned_out_sharding", "type": "TestCaseFunction", "lineno": 1845}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_reverse_mode_ad", "type": "TestCaseFunction", "lineno": 936}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_rewrite_binops", "type": "TestCaseFunction", "lineno": 2228}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_rewrite_custom_vjp_call_jaxpr0", "type": "TestCaseFunction", "lineno": 2072}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_rewrite_custom_vjp_call_jaxpr1", "type": "TestCaseFunction", "lineno": 2072}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_rewrite_post_process_call", "type": "TestCaseFunction", "lineno": 1958}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_rewrite_process_call", "type": "TestCaseFunction", "lineno": 1944}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_rewrite_process_custom_jvp_call0", "type": "TestCaseFunction", "lineno": 1975}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_rewrite_process_custom_jvp_call1", "type": "TestCaseFunction", "lineno": 1975}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_rewrite_process_custom_vjp_call0", "type": "TestCaseFunction", "lineno": 2000}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_rewrite_process_custom_vjp_call1", "type": "TestCaseFunction", "lineno": 2000}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_rewrite_process_custom_vjp_call_match_more_replicated0", "type": "TestCaseFunction", "lineno": 2028}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_rewrite_process_custom_vjp_call_match_more_replicated1", "type": "TestCaseFunction", "lineno": 2028}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_rewrite_scan", "type": "TestCaseFunction", "lineno": 2241}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_same_pspec_eager_shard_map", "type": "TestCaseFunction", "lineno": 2056}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_scan_pvary_errors", "type": "TestCaseFunction", "lineno": 3680}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_scan_pvary_errors2", "type": "TestCaseFunction", "lineno": 3710}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_scan_rep_rule", "type": "TestCaseFunction", "lineno": 1516}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_shard_map_abstract_mesh", "type": "TestCaseFunction", "lineno": 1242}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_sharded_prng_with_abstract_mesh", "type": "TestCaseFunction", "lineno": 2891}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_sharded_random_bits0", "type": "TestCaseFunction", "lineno": 1467}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_sharded_random_bits1", "type": "TestCaseFunction", "lineno": 1467}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_sharded_random_bits2", "type": "TestCaseFunction", "lineno": 1467}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_sharding_metadata_in_hlo_attrs", "type": "TestCaseFunction", "lineno": 1911}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_shmap_abstract_mesh_errors", "type": "TestCaseFunction", "lineno": 1296}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_shmap_auto_unreduced_error", "type": "TestCaseFunction", "lineno": 2645}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_shmap_close_over_unused_params", "type": "TestCaseFunction", "lineno": 2825}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_shmap_close_over_unused_params_vmap", "type": "TestCaseFunction", "lineno": 2873}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_shmap_full_manual_context_auto", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_shmap_full_manual_context_explicit", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_shmap_linearize_and_linearize_transpose_error", "type": "TestCaseFunction", "lineno": 3850}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_shmap_of_remat_basic", "type": "TestCaseFunction", "lineno": 1033}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_shmap_partial_manual_auto", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_shmap_partial_manual_explicit", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_shmap_unreduced_custom_vjp_bwd", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap0", "type": "TestCaseFunction", "lineno": 3887}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap1", "type": "TestCaseFunction", "lineno": 3887}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_auto_error0", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_auto_error1", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_auto_explicit0", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_auto_explicit1", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_auto_explicit_nest0", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_auto_explicit_nest1", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_auto_explicit_nest_inner_none0", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_auto_explicit_nest_inner_none1", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_auto_explicit_nest_mesh_call_time0", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_auto_explicit_nest_mesh_call_time1", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_explicit0", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_explicit1", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_nested_psum0", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_nested_psum1", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_replicated0", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_replicated1", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_replicated_sharded0", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_replicated_sharded1", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_switch_rep_rule", "type": "TestCaseFunction", "lineno": 1673}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_temporary_error_suppression_flag", "type": "TestCaseFunction", "lineno": 3482}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_transpose_float0", "type": "TestCaseFunction", "lineno": 2167}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_transpose_identity", "type": "TestCaseFunction", "lineno": 2104}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_tree_prefix_error", "type": "TestCaseFunction", "lineno": 904}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_vma_out_specs_error_check", "type": "TestCaseFunction", "lineno": 1482}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_vmap_basic", "type": "TestCaseFunction", "lineno": 874}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_vmap_basic_axis_name", "type": "TestCaseFunction", "lineno": 884}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_vmap_basic_axis_name_reuse_mesh_name", "type": "TestCaseFunction", "lineno": 894}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_vmap_explicit_mesh_axis", "type": "TestCaseFunction", "lineno": 1125}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_vmap_explicit_mesh_axis_error", "type": "TestCaseFunction", "lineno": 1152}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_vmap_explicit_mesh_axis_single_axis", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_vmap_grad_remat_shmap_spmd_axis_name_residuals", "type": "TestCaseFunction", "lineno": 3283}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_vmap_grad_shmap_spmd_axis_name_residuals", "type": "TestCaseFunction", "lineno": 3271}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_vmap_of_grad_spmd_axis_name", "type": "TestCaseFunction", "lineno": 1176}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_vmap_spmd_axis_name", "type": "TestCaseFunction", "lineno": 1110}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_vmap_spmd_axis_name_error", "type": "TestCaseFunction", "lineno": 3349}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_vmap_spmd_axis_name_pair", "type": "TestCaseFunction", "lineno": 1196}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_while_rep_rule", "type": "TestCaseFunction", "lineno": 1561}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_with_static_arg", "type": "TestCaseFunction", "lineno": 191}]}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest", "outcome": "passed", "result": [{"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_eager_against_ref0", "type": "TestCaseFunction", "lineno": 4437}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_eager_against_ref1", "type": "TestCaseFunction", "lineno": 4437}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_eager_against_ref2", "type": "TestCaseFunction", "lineno": 4437}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_eager_against_ref3", "type": "TestCaseFunction", "lineno": 4437}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_eager_against_ref4", "type": "TestCaseFunction", "lineno": 4437}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_eager_against_ref5", "type": "TestCaseFunction", "lineno": 4437}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_eager_against_ref6", "type": "TestCaseFunction", "lineno": 4437}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_eager_against_ref7", "type": "TestCaseFunction", "lineno": 4437}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_eager_against_ref8", "type": "TestCaseFunction", "lineno": 4437}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_eager_against_ref9", "type": "TestCaseFunction", "lineno": 4437}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads0", "type": "TestCaseFunction", "lineno": 4457}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads1", "type": "TestCaseFunction", "lineno": 4457}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads10", "type": "TestCaseFunction", "lineno": 4457}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads11", "type": "TestCaseFunction", "lineno": 4457}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads12", "type": "TestCaseFunction", "lineno": 4457}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads13", "type": "TestCaseFunction", "lineno": 4457}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads14", "type": "TestCaseFunction", "lineno": 4457}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads15", "type": "TestCaseFunction", "lineno": 4457}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads16", "type": "TestCaseFunction", "lineno": 4457}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads17", "type": "TestCaseFunction", "lineno": 4457}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads18", "type": "TestCaseFunction", "lineno": 4457}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads19", "type": "TestCaseFunction", "lineno": 4457}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads2", "type": "TestCaseFunction", "lineno": 4457}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads3", "type": "TestCaseFunction", "lineno": 4457}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads4", "type": "TestCaseFunction", "lineno": 4457}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads5", "type": "TestCaseFunction", "lineno": 4457}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads6", "type": "TestCaseFunction", "lineno": 4457}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads7", "type": "TestCaseFunction", "lineno": 4457}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads8", "type": "TestCaseFunction", "lineno": 4457}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads9", "type": "TestCaseFunction", "lineno": 4457}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads_closure0", "type": "TestCaseFunction", "lineno": 4473}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads_closure1", "type": "TestCaseFunction", "lineno": 4473}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads_closure2", "type": "TestCaseFunction", "lineno": 4473}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads_closure3", "type": "TestCaseFunction", "lineno": 4473}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads_closure4", "type": "TestCaseFunction", "lineno": 4473}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads_closure5", "type": "TestCaseFunction", "lineno": 4473}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads_closure6", "type": "TestCaseFunction", "lineno": 4473}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads_closure7", "type": "TestCaseFunction", "lineno": 4473}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads_closure8", "type": "TestCaseFunction", "lineno": 4473}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads_closure9", "type": "TestCaseFunction", "lineno": 4473}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_jit_against_ref0", "type": "TestCaseFunction", "lineno": 4447}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_jit_against_ref1", "type": "TestCaseFunction", "lineno": 4447}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_jit_against_ref2", "type": "TestCaseFunction", "lineno": 4447}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_jit_against_ref3", "type": "TestCaseFunction", "lineno": 4447}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_jit_against_ref4", "type": "TestCaseFunction", "lineno": 4447}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_jit_against_ref5", "type": "TestCaseFunction", "lineno": 4447}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_jit_against_ref6", "type": "TestCaseFunction", "lineno": 4447}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_jit_against_ref7", "type": "TestCaseFunction", "lineno": 4447}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_jit_against_ref8", "type": "TestCaseFunction", "lineno": 4447}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_jit_against_ref9", "type": "TestCaseFunction", "lineno": 4447}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap0", "type": "TestCaseFunction", "lineno": 4493}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap1", "type": "TestCaseFunction", "lineno": 4493}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap2", "type": "TestCaseFunction", "lineno": 4493}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap3", "type": "TestCaseFunction", "lineno": 4493}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap4", "type": "TestCaseFunction", "lineno": 4493}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap5", "type": "TestCaseFunction", "lineno": 4493}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap6", "type": "TestCaseFunction", "lineno": 4493}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap7", "type": "TestCaseFunction", "lineno": 4493}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap8", "type": "TestCaseFunction", "lineno": 4493}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap9", "type": "TestCaseFunction", "lineno": 4493}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap_closure0", "type": "TestCaseFunction", "lineno": 4516}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap_closure1", "type": "TestCaseFunction", "lineno": 4516}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap_closure2", "type": "TestCaseFunction", "lineno": 4516}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap_closure3", "type": "TestCaseFunction", "lineno": 4516}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap_closure4", "type": "TestCaseFunction", "lineno": 4516}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap_closure5", "type": "TestCaseFunction", "lineno": 4516}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap_closure6", "type": "TestCaseFunction", "lineno": 4516}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap_closure7", "type": "TestCaseFunction", "lineno": 4516}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap_closure8", "type": "TestCaseFunction", "lineno": 4516}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap_closure9", "type": "TestCaseFunction", "lineno": 4516}]}, {"nodeid": "tests/shard_map_test.py::CustomPartitionerTest", "outcome": "passed", "result": [{"nodeid": "tests/shard_map_test.py::CustomPartitionerTest::test_custom_partitioning", "type": "TestCaseFunction", "lineno": 4562}, {"nodeid": "tests/shard_map_test.py::CustomPartitionerTest::test_partially_sharded_dim_with_auto", "type": "TestCaseFunction", "lineno": 4609}]}, {"nodeid": "tests/shard_map_test.py::SmapSystematicTest", "outcome": "passed", "result": [{"nodeid": "tests/shard_map_test.py::SmapSystematicTest::test_against_ref0", "type": "TestCaseFunction", "lineno": 4696}, {"nodeid": "tests/shard_map_test.py::SmapSystematicTest::test_against_ref1", "type": "TestCaseFunction", "lineno": 4696}, {"nodeid": "tests/shard_map_test.py::SmapSystematicTest::test_against_ref2", "type": "TestCaseFunction", "lineno": 4696}, {"nodeid": "tests/shard_map_test.py::SmapSystematicTest::test_against_ref3", "type": "TestCaseFunction", "lineno": 4696}, {"nodeid": "tests/shard_map_test.py::SmapSystematicTest::test_against_ref4", "type": "TestCaseFunction", "lineno": 4696}, {"nodeid": "tests/shard_map_test.py::SmapSystematicTest::test_against_ref5", "type": "TestCaseFunction", "lineno": 4696}, {"nodeid": "tests/shard_map_test.py::SmapSystematicTest::test_against_ref6", "type": "TestCaseFunction", "lineno": 4696}, {"nodeid": "tests/shard_map_test.py::SmapSystematicTest::test_against_ref7", "type": "TestCaseFunction", "lineno": 4696}, {"nodeid": "tests/shard_map_test.py::SmapSystematicTest::test_against_ref8", "type": "TestCaseFunction", "lineno": 4696}, {"nodeid": "tests/shard_map_test.py::SmapSystematicTest::test_against_ref9", "type": "TestCaseFunction", "lineno": 4696}]}, {"nodeid": "tests/shard_map_test.py::SdyIntegrationTest", "outcome": "passed", "result": [{"nodeid": "tests/shard_map_test.py::SdyIntegrationTest::test_shardy_collective_permute", "type": "TestCaseFunction", "lineno": 4718}]}, {"nodeid": "tests/shard_map_test.py", "outcome": "passed", "result": [{"nodeid": "tests/shard_map_test.py::ShardMapTest", "type": "UnitTestCase"}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest", "type": "UnitTestCase"}, {"nodeid": "tests/shard_map_test.py::CustomPartitionerTest", "type": "UnitTestCase"}, {"nodeid": "tests/shard_map_test.py::SmapSystematicTest", "type": "UnitTestCase"}, {"nodeid": "tests/shard_map_test.py::SdyIntegrationTest", "type": "UnitTestCase"}]}], "tests": [{"nodeid": "tests/shard_map_test.py::ShardMapTest::test_all_gather", "lineno": 92, "outcome": "passed", "keywords": ["test_all_gather", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.000322757288813591, "outcome": "passed"}, "call": {"duration": 60.153401682153344, "outcome": "passed", "stderr": "E1120 01:27:09.324138 2677657 rendezvous.cc:92] [id=0] This thread has been waiting for `initialize clique for rank 1; clique=devices=[0,2,4,6]; is_p2p=0; groups=[[0,2,4,6],[1,3,5,7]]; root_device=-1; num_local_participants=4; incarnations=[]; run_id=140313119` for 10 seconds and may be stuck. All 4 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:27:09.324140 2677651 rendezvous.cc:92] [id=2] This thread has been waiting for `initialize clique for rank 0; clique=devices=[0,2,4,6]; is_p2p=0; groups=[[0,2,4,6],[1,3,5,7]]; root_device=-1; num_local_participants=4; incarnations=[]; run_id=140313119` for 10 seconds and may be stuck. All 4 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:27:09.324140 2677669 rendezvous.cc:92] [id=1] This thread has been waiting for `initialize clique for rank 3; clique=devices=[0,2,4,6]; is_p2p=0; groups=[[0,2,4,6],[1,3,5,7]]; root_device=-1; num_local_participants=4; incarnations=[]; run_id=140313119` for 10 seconds and may be stuck. All 4 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:27:09.324140 2677660 rendezvous.cc:92] [id=1] This thread has been waiting for `initialize clique for rank 1; clique=devices=[1,3,5,7]; is_p2p=0; groups=[[0,2,4,6],[1,3,5,7]]; root_device=-1; num_local_participants=4; incarnations=[]; run_id=140313119` for 10 seconds and may be stuck. All 4 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:27:09.324145 2677666 rendezvous.cc:92] [id=2] This thread has been waiting for `initialize clique for rank 2; clique=devices=[1,3,5,7]; is_p2p=0; groups=[[0,2,4,6],[1,3,5,7]]; root_device=-1; num_local_participants=4; incarnations=[]; run_id=140313119` for 10 seconds and may be stuck. All 4 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:27:09.324140 2677654 rendezvous.cc:92] [id=0] This thread has been waiting for `initialize clique for rank 0; clique=devices=[1,3,5,7]; is_p2p=0; groups=[[0,2,4,6],[1,3,5,7]]; root_device=-1; num_local_participants=4; incarnations=[]; run_id=140313119` for 10 seconds and may be stuck. All 4 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:27:23.266583 2677669 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:27:23.266583 2677651 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:27:23.266599 2677657 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:27:23.933258 2677654 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:27:23.933254 2677660 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:27:23.933259 2677666 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:27:33.933491 2677672 rendezvous.cc:92] [id=0] This thread has been waiting for `initialize clique for rank 1; clique=devices=[6,7]; is_p2p=0; groups=[[0,1],[2,3],[4,5],[6,7]]; root_device=-1; num_local_participants=2; incarnations=[]; run_id=140313119` for 10 seconds and may be stuck. All 2 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:27:33.933607 2677660 rendezvous.cc:92] [id=0] This thread has been waiting for `initialize clique for rank 1; clique=devices=[2,3]; is_p2p=0; groups=[[0,1],[2,3],[4,5],[6,7]]; root_device=-1; num_local_participants=2; incarnations=[]; run_id=140313119` for 10 seconds and may be stuck. All 2 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:27:33.933680 2677666 rendezvous.cc:92] [id=0] This thread has been waiting for `initialize clique for rank 1; clique=devices=[4,5]; is_p2p=0; groups=[[0,1],[2,3],[4,5],[6,7]]; root_device=-1; num_local_participants=2; incarnations=[]; run_id=140313119` for 10 seconds and may be stuck. All 2 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:27:34.528217 2677660 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:27:34.650604 2677666 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:27:34.707899 2677672 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\n"}, "teardown": {"duration": 0.0002406751736998558, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_all_gather_invariant_basic", "lineno": 111, "outcome": "passed", "keywords": ["test_all_gather_invariant_basic", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00035729724913835526, "outcome": "passed"}, "call": {"duration": 9.151148368604481, "outcome": "passed"}, "teardown": {"duration": 0.00017028115689754486, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_all_gather_invariant_complex", "lineno": 133, "outcome": "passed", "keywords": ["test_all_gather_invariant_complex", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019961409270763397, "outcome": "passed"}, "call": {"duration": 5.687395108863711, "outcome": "passed"}, "teardown": {"duration": 0.00013270601630210876, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_all_gather_with_axis_index_groups", "lineno": 169, "outcome": "passed", "keywords": ["test_all_gather_with_axis_index_groups", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0002015586942434311, "outcome": "passed"}, "call": {"duration": 26.720925614237785, "outcome": "passed", "stderr": "E1120 01:28:01.889695 2677663 rendezvous.cc:92] [id=0] This thread has been waiting for `initialize clique for rank 1; clique=devices=[0,4]; is_p2p=0; groups=[[0,4],[1,5],[2,6],[3,7]]; root_device=-1; num_local_participants=2; incarnations=[]; run_id=764318892` for 10 seconds and may be stuck. All 2 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:28:01.887857 2677672 rendezvous.cc:92] [id=0] This thread has been waiting for `initialize clique for rank 1; clique=devices=[3,7]; is_p2p=0; groups=[[0,4],[1,5],[2,6],[3,7]]; root_device=-1; num_local_participants=2; incarnations=[]; run_id=764318892` for 10 seconds and may be stuck. All 2 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:28:01.892158 2677657 rendezvous.cc:92] [id=0] This thread has been waiting for `initialize clique for rank 0; clique=devices=[2,6]; is_p2p=0; groups=[[0,4],[1,5],[2,6],[3,7]]; root_device=-1; num_local_participants=2; incarnations=[]; run_id=764318892` for 10 seconds and may be stuck. All 2 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:28:02.488549 2677663 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:28:02.616387 2677657 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:28:02.616473 2677672 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:28:12.871776 2677669 rendezvous.cc:92] [id=0] This thread has been waiting for `initialize clique for rank 2; clique=devices=[4,5,6,7]; is_p2p=0; groups=[[0,1,2,3],[4,5,6,7]]; root_device=-1; num_local_participants=4; incarnations=[]; run_id=-1846604476` for 10 seconds and may be stuck. All 4 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:28:12.871794 2677663 rendezvous.cc:92] [id=1] This thread has been waiting for `initialize clique for rank 0; clique=devices=[4,5,6,7]; is_p2p=0; groups=[[0,1,2,3],[4,5,6,7]]; root_device=-1; num_local_participants=4; incarnations=[]; run_id=-1846604476` for 10 seconds and may be stuck. All 4 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:28:12.871783 2677666 rendezvous.cc:92] [id=2] This thread has been waiting for `initialize clique for rank 1; clique=devices=[4,5,6,7]; is_p2p=0; groups=[[0,1,2,3],[4,5,6,7]]; root_device=-1; num_local_participants=4; incarnations=[]; run_id=-1846604476` for 10 seconds and may be stuck. All 4 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:28:12.880233 2677660 rendezvous.cc:92] [id=1] This thread has been waiting for `initialize clique for rank 3; clique=devices=[0,1,2,3]; is_p2p=0; groups=[[0,1,2,3],[4,5,6,7]]; root_device=-1; num_local_participants=4; incarnations=[]; run_id=-1846604476` for 10 seconds and may be stuck. All 4 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:28:12.880267 2677657 rendezvous.cc:92] [id=0] This thread has been waiting for `initialize clique for rank 2; clique=devices=[0,1,2,3]; is_p2p=0; groups=[[0,1,2,3],[4,5,6,7]]; root_device=-1; num_local_participants=4; incarnations=[]; run_id=-1846604476` for 10 seconds and may be stuck. All 4 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:28:12.880283 2677654 rendezvous.cc:92] [id=2] This thread has been waiting for `initialize clique for rank 1; clique=devices=[0,1,2,3]; is_p2p=0; groups=[[0,1,2,3],[4,5,6,7]]; root_device=-1; num_local_participants=4; incarnations=[]; run_id=-1846604476` for 10 seconds and may be stuck. All 4 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:28:17.434798 2677669 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:28:17.434808 2677663 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:28:17.434815 2677666 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:28:17.720849 2677654 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:28:17.720848 2677660 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:28:17.720854 2677657 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\n"}, "teardown": {"duration": 0.0002568783238530159, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_all_gather_with_vma_in_types", "lineno": 3579, "outcome": "passed", "keywords": ["test_all_gather_with_vma_in_types", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004097959026694298, "outcome": "passed"}, "call": {"duration": 1.789522111415863, "outcome": "passed"}, "teardown": {"duration": 0.00024105608463287354, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_all_to_all_grad", "lineno": 713, "outcome": "passed", "keywords": ["test_all_to_all_grad", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004093050956726074, "outcome": "passed"}, "call": {"duration": 5.696940001100302, "outcome": "passed"}, "teardown": {"duration": 0.000199134461581707, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_all_to_all_multiple_axis_names", "lineno": 615, "outcome": "passed", "keywords": ["test_all_to_all_multiple_axis_names", "__wrapped__", "__x_use_name__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0008911062031984329, "outcome": "passed"}, "call": {"duration": 78.4011691622436, "outcome": "passed", "stderr": "E1120 01:28:36.044656 2677663 rendezvous.cc:92] [id=2] This thread has been waiting for `initialize clique for rank 4; clique=devices=[0,1,2,3,4,5,6,7]; is_p2p=0; groups=[[0,1,2,3,4,5,6,7]]; root_device=-1; num_local_participants=8; incarnations=[]; run_id=545035574` for 10 seconds and may be stuck. All 8 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:28:36.044672 2677657 rendezvous.cc:92] [id=5] This thread has been waiting for `initialize clique for rank 2; clique=devices=[0,1,2,3,4,5,6,7]; is_p2p=0; groups=[[0,1,2,3,4,5,6,7]]; root_device=-1; num_local_participants=8; incarnations=[]; run_id=545035574` for 10 seconds and may be stuck. All 8 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:28:36.044670 2677672 rendezvous.cc:92] [id=0] This thread has been waiting for `initialize clique for rank 7; clique=devices=[0,1,2,3,4,5,6,7]; is_p2p=0; groups=[[0,1,2,3,4,5,6,7]]; root_device=-1; num_local_participants=8; incarnations=[]; run_id=545035574` for 10 seconds and may be stuck. All 8 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:28:36.044655 2677666 rendezvous.cc:92] [id=1] This thread has been waiting for `initialize clique for rank 5; clique=devices=[0,1,2,3,4,5,6,7]; is_p2p=0; groups=[[0,1,2,3,4,5,6,7]]; root_device=-1; num_local_participants=8; incarnations=[]; run_id=545035574` for 10 seconds and may be stuck. All 8 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:28:36.044658 2677654 rendezvous.cc:92] [id=4] This thread has been waiting for `initialize clique for rank 1; clique=devices=[0,1,2,3,4,5,6,7]; is_p2p=0; groups=[[0,1,2,3,4,5,6,7]]; root_device=-1; num_local_participants=8; incarnations=[]; run_id=545035574` for 10 seconds and may be stuck. All 8 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:28:36.044662 2677660 rendezvous.cc:92] [id=6] This thread has been waiting for `initialize clique for rank 3; clique=devices=[0,1,2,3,4,5,6,7]; is_p2p=0; groups=[[0,1,2,3,4,5,6,7]]; root_device=-1; num_local_participants=8; incarnations=[]; run_id=545035574` for 10 seconds and may be stuck. All 8 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:28:36.044662 2677669 rendezvous.cc:92] [id=3] This thread has been waiting for `initialize clique for rank 6; clique=devices=[0,1,2,3,4,5,6,7]; is_p2p=0; groups=[[0,1,2,3,4,5,6,7]]; root_device=-1; num_local_participants=8; incarnations=[]; run_id=545035574` for 10 seconds and may be stuck. All 8 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:29:20.452933 2677660 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:29:20.452931 2677669 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:29:20.452962 2677657 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:29:20.452939 2677663 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:29:20.452968 2677666 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:29:20.452970 2677672 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:29:20.452955 2677654 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\n"}, "teardown": {"duration": 0.0002598334103822708, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_all_to_all_single_axis_name", "lineno": 615, "outcome": "passed", "keywords": ["test_all_to_all_single_axis_name", "__wrapped__", "__x_use_name__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.000429774634540081, "outcome": "passed"}, "call": {"duration": 0.18786221649497747, "outcome": "passed"}, "teardown": {"duration": 0.00012242048978805542, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_all_to_all_with_axis_index_groups", "lineno": 680, "outcome": "passed", "keywords": ["test_all_to_all_with_axis_index_groups", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019175373017787933, "outcome": "passed"}, "call": {"duration": 6.621349238790572, "outcome": "passed"}, "teardown": {"duration": 0.00023688003420829773, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_approx_top_k", "lineno": 2445, "outcome": "passed", "keywords": ["test_approx_top_k", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004008319228887558, "outcome": "passed"}, "call": {"duration": 0.889911056496203, "outcome": "passed"}, "teardown": {"duration": 0.00023812241852283478, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_argmax_pvary", "lineno": 1539, "outcome": "passed", "keywords": ["test_argmax_pvary", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004064999520778656, "outcome": "passed"}, "call": {"duration": 1.3438919689506292, "outcome": "passed"}, "teardown": {"duration": 0.00020141806453466415, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_axis_env_extension_regression", "lineno": 2287, "outcome": "passed", "keywords": ["test_axis_env_extension_regression", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003359271213412285, "outcome": "passed"}, "call": {"duration": 0.22805737238377333, "outcome": "passed"}, "teardown": {"duration": 0.00012447405606508255, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_axis_index", "lineno": 966, "outcome": "passed", "keywords": ["test_axis_index", "__wrapped__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001961793750524521, "outcome": "passed"}, "call": {"duration": 0.33830685168504715, "outcome": "passed"}, "teardown": {"duration": 0.00023715104907751083, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_axis_index_basic0", "lineno": 1718, "outcome": "passed", "keywords": ["test_axis_index_basic0", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004141824319958687, "outcome": "passed"}, "call": {"duration": 0.56775186304003, "outcome": "passed"}, "teardown": {"duration": 0.00023752078413963318, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_axis_index_basic1", "lineno": 1718, "outcome": "passed", "keywords": ["test_axis_index_basic1", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003930898383259773, "outcome": "passed"}, "call": {"duration": 0.2825879789888859, "outcome": "passed"}, "teardown": {"duration": 0.00019617006182670593, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_axis_index_eager", "lineno": 1752, "outcome": "passed", "keywords": ["test_axis_index_eager", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00032118428498506546, "outcome": "passed"}, "call": {"duration": 1.3520129127427936, "outcome": "passed"}, "teardown": {"duration": 0.0001874370500445366, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_axis_index_explicit_mesh_eager_shmap", "lineno": 1539, "outcome": "passed", "keywords": ["test_axis_index_explicit_mesh_eager_shmap", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00033611617982387543, "outcome": "passed"}, "call": {"duration": 2.2907131146639585, "outcome": "passed"}, "teardown": {"duration": 0.00012399256229400635, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_axis_index_twoaxes0", "lineno": 1731, "outcome": "passed", "keywords": ["test_axis_index_twoaxes0", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.000196920707821846, "outcome": "passed"}, "call": {"duration": 1.722538636997342, "outcome": "passed"}, "teardown": {"duration": 0.00024132616817951202, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_axis_index_twoaxes1", "lineno": 1731, "outcome": "passed", "keywords": ["test_axis_index_twoaxes1", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.000401962548494339, "outcome": "passed"}, "call": {"duration": 2.0360751440748572, "outcome": "passed"}, "teardown": {"duration": 0.0001224912703037262, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_axis_size_1_partial_auto", "lineno": 3098, "outcome": "passed", "keywords": ["test_axis_size_1_partial_auto", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019234325736761093, "outcome": "passed"}, "call": {"duration": 0.8722610669210553, "outcome": "passed"}, "teardown": {"duration": 0.000239434652030468, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_check_rep_failure_inside_rule0", "lineno": 2344, "outcome": "passed", "keywords": ["test_check_rep_failure_inside_rule0", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00039487332105636597, "outcome": "passed"}, "call": {"duration": 0.4856449170038104, "outcome": "passed"}, "teardown": {"duration": 0.00012166984379291534, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_check_rep_failure_inside_rule1", "lineno": 2344, "outcome": "passed", "keywords": ["test_check_rep_failure_inside_rule1", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001923535019159317, "outcome": "passed"}, "call": {"duration": 2.388910190202296, "outcome": "passed"}, "teardown": {"duration": 0.0001244833692908287, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_check_rep_false_doesnt_hit_rep_rules", "lineno": 1071, "outcome": "passed", "keywords": ["test_check_rep_false_doesnt_hit_rep_rules", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001896703615784645, "outcome": "passed"}, "call": {"duration": 0.1848715990781784, "outcome": "passed"}, "teardown": {"duration": 0.00011707283556461334, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_check_rep_false_grads", "lineno": 2258, "outcome": "passed", "keywords": ["test_check_rep_false_grads", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018651504069566727, "outcome": "passed"}, "call": {"duration": 5.95569365657866, "outcome": "passed"}, "teardown": {"duration": 0.00012035854160785675, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_close_over_explicit_sharded_input_error", "lineno": 1539, "outcome": "passed", "keywords": ["test_close_over_explicit_sharded_input_error", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019533932209014893, "outcome": "passed"}, "call": {"duration": 1.3588023651391268, "outcome": "passed"}, "teardown": {"duration": 0.00011812523007392883, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_close_over_input_explict_ctx_mesh", "lineno": 2860, "outcome": "passed", "keywords": ["test_close_over_input_explict_ctx_mesh", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00020012445747852325, "outcome": "passed"}, "call": {"duration": 0.9509172923862934, "outcome": "passed"}, "teardown": {"duration": 0.00012224074453115463, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_collective_permute", "lineno": 279, "outcome": "passed", "keywords": ["test_collective_permute", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019944366067647934, "outcome": "passed"}, "call": {"duration": 0.40856360364705324, "outcome": "passed"}, "teardown": {"duration": 0.00023308396339416504, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_collective_permute_with_multiple_axis_names", "lineno": 582, "outcome": "passed", "keywords": ["test_collective_permute_with_multiple_axis_names", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00038789305835962296, "outcome": "passed"}, "call": {"duration": 0.5650341371074319, "outcome": "passed"}, "teardown": {"duration": 0.00024384073913097382, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_collectives_not_saved", "lineno": 1059, "outcome": "passed", "keywords": ["test_collectives_not_saved", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00038941577076911926, "outcome": "passed"}, "call": {"duration": 0.20622524712234735, "outcome": "passed"}, "teardown": {"duration": 0.00019043218344449997, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_cond_pvary_errors", "lineno": 3651, "outcome": "passed", "keywords": ["test_cond_pvary_errors", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00030710361897945404, "outcome": "passed"}, "call": {"duration": 0.18506089877337217, "outcome": "passed"}, "teardown": {"duration": 0.0001845620572566986, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_cond_pvary_errors_pytree", "lineno": 3665, "outcome": "passed", "keywords": ["test_cond_pvary_errors_pytree", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003088163211941719, "outcome": "passed"}, "call": {"duration": 0.039407541044056416, "outcome": "passed"}, "teardown": {"duration": 0.00010435376316308975, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_cond_rep_rule", "lineno": 1614, "outcome": "passed", "keywords": ["test_cond_rep_rule", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00017029140144586563, "outcome": "passed"}, "call": {"duration": 3.839097906835377, "outcome": "passed"}, "teardown": {"duration": 0.00012182909995317459, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_conv_general_dilated", "lineno": 2359, "outcome": "passed", "keywords": ["test_conv_general_dilated", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018936023116111755, "outcome": "passed"}, "call": {"duration": 2.2505187410861254, "outcome": "passed"}, "teardown": {"duration": 0.0001293513923883438, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_cumsum", "lineno": 2375, "outcome": "passed", "keywords": ["test_cumsum", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001939060166478157, "outcome": "passed"}, "call": {"duration": 0.2535395761951804, "outcome": "passed"}, "teardown": {"duration": 0.0001983828842639923, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_custom_jvp_inside_jit", "lineno": 2381, "outcome": "passed", "keywords": ["test_custom_jvp_inside_jit", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00032326672226190567, "outcome": "passed"}, "call": {"duration": 0.7548898160457611, "outcome": "passed"}, "teardown": {"duration": 0.00023994501680135727, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_custom_jvp_symbolic_zeros", "lineno": 3627, "outcome": "passed", "keywords": ["test_custom_jvp_symbolic_zeros", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00039898883551359177, "outcome": "passed"}, "call": {"duration": 1.8539908528327942, "outcome": "passed"}, "teardown": {"duration": 0.00020197778940200806, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_custom_linear_solve_rep_rules", "lineno": 3469, "outcome": "passed", "keywords": ["test_custom_linear_solve_rep_rules", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003251098096370697, "outcome": "passed"}, "call": {"duration": 1.0381016563624144, "outcome": "passed"}, "teardown": {"duration": 0.00012874044477939606, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_custom_vjp_replication_error_message_hint", "lineno": 2411, "outcome": "passed", "keywords": ["test_custom_vjp_replication_error_message_hint", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001952778548002243, "outcome": "passed"}, "call": {"duration": 1.435843015089631, "outcome": "passed"}, "teardown": {"duration": 0.00024102628231048584, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_dce", "lineno": 1854, "outcome": "passed", "keywords": ["test_dce", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003991592675447464, "outcome": "passed"}, "call": {"duration": 4.544440036639571, "outcome": "passed"}, "teardown": {"duration": 0.00012163911014795303, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_debug_print_eager", "lineno": 1404, "outcome": "passed", "keywords": ["test_debug_print_eager", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019318517297506332, "outcome": "passed"}, "call": {"duration": 0.6865949593484402, "outcome": "passed"}, "teardown": {"duration": 0.00011895503848791122, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_debug_print_jit0", "lineno": 1333, "outcome": "passed", "keywords": ["test_debug_print_jit0", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019353628158569336, "outcome": "passed"}, "call": {"duration": 0.22818333562463522, "outcome": "passed"}, "teardown": {"duration": 0.0001283884048461914, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_debug_print_jit1", "lineno": 1333, "outcome": "passed", "keywords": ["test_debug_print_jit1", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019653048366308212, "outcome": "passed"}, "call": {"duration": 0.3473220132291317, "outcome": "passed"}, "teardown": {"duration": 0.0001228824257850647, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_debug_print_jit_partial_auto", "lineno": 1387, "outcome": "passed", "keywords": ["test_debug_print_jit_partial_auto", "__wrapped__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018749665468931198, "outcome": "passed"}, "call": {"duration": 0.23698478564620018, "outcome": "passed", "stdout": "instance 0 has value x=[0 1 2 3 4 5 6 7]\ninstance 1 has value x=[ 8  9 10 11 12 13 14 15]\n"}, "teardown": {"duration": 0.00012421328574419022, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_device_put", "lineno": 1780, "outcome": "passed", "keywords": ["test_device_put", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019370578229427338, "outcome": "passed"}, "call": {"duration": 0.7143225306645036, "outcome": "passed"}, "teardown": {"duration": 0.00012166984379291534, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_different_devices_shmap_abstract_mesh_cache_hit", "lineno": 1266, "outcome": "passed", "keywords": ["test_different_devices_shmap_abstract_mesh_cache_hit", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019492767751216888, "outcome": "passed"}, "call": {"duration": 0.22718207817524672, "outcome": "passed"}, "teardown": {"duration": 0.00019917450845241547, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_disable_jit", "lineno": 2452, "outcome": "passed", "keywords": ["test_disable_jit", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003333520144224167, "outcome": "passed"}, "call": {"duration": 0.21867625508457422, "outcome": "passed"}, "teardown": {"duration": 0.00011781416833400726, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_dynamic_slice_transpose", "lineno": 3321, "outcome": "passed", "keywords": ["test_dynamic_slice_transpose", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018455274403095245, "outcome": "passed"}, "call": {"duration": 2.850524020381272, "outcome": "passed"}, "teardown": {"duration": 0.00012491457164287567, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_eager_control_flow", "lineno": 852, "outcome": "passed", "keywords": ["test_eager_control_flow", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.000193755142390728, "outcome": "passed"}, "call": {"duration": 1.585763631388545, "outcome": "passed"}, "teardown": {"duration": 0.00024203676730394363, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_eager_custom_jvp_basic", "lineno": 1683, "outcome": "passed", "keywords": ["test_eager_custom_jvp_basic", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003916686400771141, "outcome": "passed"}, "call": {"duration": 1.190013311803341, "outcome": "passed"}, "teardown": {"duration": 0.00023636966943740845, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_eager_custom_vjp_basic", "lineno": 1699, "outcome": "passed", "keywords": ["test_eager_custom_vjp_basic", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00038833264261484146, "outcome": "passed"}, "call": {"duration": 0.28308740444481373, "outcome": "passed"}, "teardown": {"duration": 0.00012439396232366562, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_eager_repr", "lineno": 742, "outcome": "passed", "keywords": ["test_eager_repr", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018999073654413223, "outcome": "passed"}, "call": {"duration": 0.059765757992863655, "outcome": "passed"}, "teardown": {"duration": 0.00011996738612651825, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_erf_rules", "lineno": 2393, "outcome": "passed", "keywords": ["test_erf_rules", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018551386892795563, "outcome": "passed"}, "call": {"duration": 0.2315363995730877, "outcome": "passed"}, "teardown": {"duration": 0.00012101884931325912, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_error_for_variable_num_args", "lineno": 2399, "outcome": "passed", "keywords": ["test_error_for_variable_num_args", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018575508147478104, "outcome": "passed"}, "call": {"duration": 0.0018214499577879906, "outcome": "passed"}, "teardown": {"duration": 8.119922131299973e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_eval_shape_vma", "lineno": 1539, "outcome": "passed", "keywords": ["test_eval_shape_vma", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00014132820069789886, "outcome": "passed"}, "call": {"duration": 3.0249033281579614, "outcome": "passed"}, "teardown": {"duration": 0.00012685731053352356, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_fanin_psum_transposes_to_fanout", "lineno": 2142, "outcome": "passed", "keywords": ["test_fanin_psum_transposes_to_fanout", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019430648535490036, "outcome": "passed"}, "call": {"duration": 0.2578348387032747, "outcome": "passed"}, "teardown": {"duration": 0.00013715215027332306, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_fanout_specs_transpose_to_psum", "lineno": 2129, "outcome": "passed", "keywords": ["test_fanout_specs_transpose_to_psum", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001767510548233986, "outcome": "passed"}, "call": {"duration": 0.265777419321239, "outcome": "passed"}, "teardown": {"duration": 0.00011671334505081177, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness0", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness0", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00017275474965572357, "outcome": "passed"}, "call": {"duration": 0.0004415716975927353, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 8.301250636577606e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness1", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness1", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00014065764844417572, "outcome": "passed"}, "call": {"duration": 0.0003231968730688095, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.584225386381149e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness10", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness10", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013975519686937332, "outcome": "passed"}, "call": {"duration": 0.0003068428486585617, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.397029548883438e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness11", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness11", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013876520097255707, "outcome": "passed"}, "call": {"duration": 0.000407341867685318, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.27381557226181e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness12", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness12", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013605132699012756, "outcome": "passed"}, "call": {"duration": 0.0003072340041399002, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.333792746067047e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness13", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness13", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001359805464744568, "outcome": "passed"}, "call": {"duration": 0.00030581187456846237, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.42301344871521e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness14", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness14", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0002844901755452156, "outcome": "passed"}, "call": {"duration": 0.00030383747071027756, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.862597703933716e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness15", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness15", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013340730220079422, "outcome": "passed"}, "call": {"duration": 0.0003020456060767174, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.32792541384697e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness16", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness16", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013256631791591644, "outcome": "passed"}, "call": {"duration": 0.0003072042018175125, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.472094148397446e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness17", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness17", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013342685997486115, "outcome": "passed"}, "call": {"duration": 0.000301203690469265, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.26180151104927e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness18", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness18", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001380443572998047, "outcome": "passed"}, "call": {"duration": 0.0003025773912668228, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.590185850858688e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness19", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness19", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001313844695687294, "outcome": "passed"}, "call": {"duration": 0.0003045797348022461, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.135514169931412e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness2", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness2", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00012881960719823837, "outcome": "passed"}, "call": {"duration": 0.0004381369799375534, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.74431973695755e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness20", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness20", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013734307140111923, "outcome": "passed"}, "call": {"duration": 0.0003095576539635658, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.621292024850845e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness21", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness21", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013107247650623322, "outcome": "passed"}, "call": {"duration": 0.00030094385147094727, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.850583642721176e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness22", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness22", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001315642148256302, "outcome": "passed"}, "call": {"duration": 0.00030247680842876434, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.221568375825882e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness23", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness23", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013061240315437317, "outcome": "passed"}, "call": {"duration": 0.0002998011186718941, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.502175867557526e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness24", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness24", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001281285658478737, "outcome": "passed"}, "call": {"duration": 0.0002964884042739868, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.144641131162643e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness25", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness25", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013262685388326645, "outcome": "passed"}, "call": {"duration": 0.0004377765581011772, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.503107190132141e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness26", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness26", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013488903641700745, "outcome": "passed"}, "call": {"duration": 0.00030458997935056686, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.455982267856598e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness27", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness27", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013505946844816208, "outcome": "passed"}, "call": {"duration": 0.000298510305583477, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.515121251344681e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness28", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness28", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013112463057041168, "outcome": "passed"}, "call": {"duration": 0.0003055920824408531, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.299799472093582e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness29", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness29", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00012952089309692383, "outcome": "passed"}, "call": {"duration": 0.00030405912548303604, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.095560431480408e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness3", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness3", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.000134187750518322, "outcome": "passed"}, "call": {"duration": 0.000323418527841568, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.51810148358345e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness30", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness30", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00012790784239768982, "outcome": "passed"}, "call": {"duration": 0.00043034646660089493, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.558148354291916e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness31", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness31", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013288669288158417, "outcome": "passed"}, "call": {"duration": 0.00029797013849020004, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.409974932670593e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness32", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness32", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001308247447013855, "outcome": "passed"}, "call": {"duration": 0.0002993028610944748, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 8.332356810569763e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness33", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness33", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013060308992862701, "outcome": "passed"}, "call": {"duration": 0.00030161626636981964, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.167644798755646e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness34", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness34", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00012790784239768982, "outcome": "passed"}, "call": {"duration": 0.0003018854185938835, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.218588143587112e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness35", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness35", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00012810900807380676, "outcome": "passed"}, "call": {"duration": 0.0003066631034016609, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.013417780399323e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness36", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness36", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013815425336360931, "outcome": "passed"}, "call": {"duration": 0.0006987322121858597, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.606297731399536e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness37", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness37", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013579055666923523, "outcome": "passed"}, "call": {"duration": 0.0003065727651119232, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.292721420526505e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness38", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness38", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013190414756536484, "outcome": "passed"}, "call": {"duration": 0.0003058305010199547, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.277820259332657e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness39", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness39", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00014107860624790192, "outcome": "passed"}, "call": {"duration": 0.0002997731789946556, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.087457925081253e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness4", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness4", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001293513923883438, "outcome": "passed"}, "call": {"duration": 0.0003038588911294937, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.300823926925659e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness40", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness40", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013127457350492477, "outcome": "passed"}, "call": {"duration": 0.000302756205201149, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.202569395303726e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness41", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness41", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013208482414484024, "outcome": "passed"}, "call": {"duration": 0.0003013554960489273, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.579196244478226e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness42", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness42", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001368122175335884, "outcome": "passed"}, "call": {"duration": 0.00030476972460746765, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.524155080318451e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness43", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness43", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013124383985996246, "outcome": "passed"}, "call": {"duration": 0.0002998523414134979, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.268786430358887e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness44", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness44", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001277988776564598, "outcome": "passed"}, "call": {"duration": 0.00030269846320152283, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.087457925081253e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness45", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness45", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00012976210564374924, "outcome": "passed"}, "call": {"duration": 0.00030190590769052505, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.187575101852417e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness46", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness46", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001282189041376114, "outcome": "passed"}, "call": {"duration": 0.0003038691356778145, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.101520895957947e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness47", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness47", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00012692809104919434, "outcome": "passed"}, "call": {"duration": 0.00030180439352989197, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.303804159164429e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness48", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness48", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00025751907378435135, "outcome": "passed"}, "call": {"duration": 0.0003267638385295868, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.279869168996811e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness49", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness49", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013242661952972412, "outcome": "passed"}, "call": {"duration": 0.00030411873012781143, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.200613617897034e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness5", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness5", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013008154928684235, "outcome": "passed"}, "call": {"duration": 0.00030122511088848114, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.208622992038727e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness50", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness50", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013173464685678482, "outcome": "passed"}, "call": {"duration": 0.0003057112917304039, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.196608930826187e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness51", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness51", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013089273124933243, "outcome": "passed"}, "call": {"duration": 0.0003009047359228134, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.765460759401321e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness52", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness52", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00012808851897716522, "outcome": "passed"}, "call": {"duration": 0.0002995021641254425, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.520150393247604e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness53", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness53", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00012822914868593216, "outcome": "passed"}, "call": {"duration": 0.0004282817244529724, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.605180144309998e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness54", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness54", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.000135139562189579, "outcome": "passed"}, "call": {"duration": 0.0003040991723537445, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.412862032651901e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness55", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness55", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00012963078916072845, "outcome": "passed"}, "call": {"duration": 0.0002964278683066368, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.066410034894943e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness56", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness56", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001281891018152237, "outcome": "passed"}, "call": {"duration": 0.00030104443430900574, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.292814552783966e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness57", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness57", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00012777931988239288, "outcome": "passed"}, "call": {"duration": 0.0003047492355108261, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.46697187423706e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness58", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness58", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013366714119911194, "outcome": "passed"}, "call": {"duration": 0.00030193571001291275, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.028412073850632e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness59", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness59", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013122428208589554, "outcome": "passed"}, "call": {"duration": 0.00043014436960220337, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.396936416625977e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness6", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness6", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00012969132512807846, "outcome": "passed"}, "call": {"duration": 0.0003031175583600998, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.18357041478157e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness60", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness60", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013091322034597397, "outcome": "passed"}, "call": {"duration": 0.00030175503343343735, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.307808846235275e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness61", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness61", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001279180869460106, "outcome": "passed"}, "call": {"duration": 0.00030336808413267136, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.018353790044785e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness62", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness62", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00012717768549919128, "outcome": "passed"}, "call": {"duration": 0.00030181650072336197, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.026363164186478e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness63", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness63", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001339782029390335, "outcome": "passed"}, "call": {"duration": 0.0003097979351878166, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.078424096107483e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness7", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness7", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00012729782611131668, "outcome": "passed"}, "call": {"duration": 0.0003002732992172241, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 0.00020326022058725357, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness8", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness8", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001329965889453888, "outcome": "passed"}, "call": {"duration": 0.00030027423053979874, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.400941103696823e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_forwarding_correctness9", "lineno": 2516, "outcome": "skipped", "keywords": ["test_forwarding_correctness9", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013017188757658005, "outcome": "passed"}, "call": {"duration": 0.00030121486634016037, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 2517, \"Skipped: test_forwarding_correctness not supported on device with tags {'gpu', 'rocm'}.\")"}, "teardown": {"duration": 7.594190537929535e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_functools_partial_rank_error", "lineno": 1495, "outcome": "passed", "keywords": ["test_functools_partial_rank_error", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013113394379615784, "outcome": "passed"}, "call": {"duration": 0.0010552778840065002, "outcome": "passed"}, "teardown": {"duration": 7.80150294303894e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_get_check_rep", "lineno": 3513, "outcome": "passed", "keywords": ["test_get_check_rep", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013927649706602097, "outcome": "passed"}, "call": {"duration": 5.303357585333288, "outcome": "passed"}, "teardown": {"duration": 0.00012288149446249008, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_grad_nested_partial_auto", "lineno": 3055, "outcome": "passed", "keywords": ["test_grad_nested_partial_auto", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.000189879909157753, "outcome": "passed"}, "call": {"duration": 0.7630677605047822, "outcome": "passed"}, "teardown": {"duration": 0.0002361387014389038, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_grad_nested_partial_auto_with_residuals", "lineno": 3078, "outcome": "passed", "keywords": ["test_grad_nested_partial_auto_with_residuals", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00040456652641296387, "outcome": "passed"}, "call": {"duration": 0.5944183506071568, "outcome": "passed"}, "teardown": {"duration": 0.0002405252307653427, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_grad_remat", "lineno": 3261, "outcome": "passed", "keywords": ["test_grad_remat", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00039872899651527405, "outcome": "passed"}, "call": {"duration": 3.083593612536788, "outcome": "passed"}, "teardown": {"duration": 0.0001291409134864807, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_grad_shmap_residuals_axis_names_in_mesh_order", "lineno": 3296, "outcome": "passed", "keywords": ["test_grad_shmap_residuals_axis_names_in_mesh_order", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018962938338518143, "outcome": "passed"}, "call": {"duration": 0.017480596899986267, "outcome": "passed"}, "teardown": {"duration": 9.407941251993179e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_identity", "lineno": 73, "outcome": "passed", "keywords": ["test_identity", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00015641096979379654, "outcome": "passed"}, "call": {"duration": 0.041497076861560345, "outcome": "passed"}, "teardown": {"duration": 0.00011262763291597366, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_in_spec_none", "lineno": 3369, "outcome": "passed", "keywords": ["test_in_spec_none", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001755189150571823, "outcome": "passed"}, "call": {"duration": 1.7730996841564775, "outcome": "passed"}, "teardown": {"duration": 0.00012227986007928848, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_in_spec_none_divisibility_errors", "lineno": 3421, "outcome": "passed", "keywords": ["test_in_spec_none_divisibility_errors", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019095279276371002, "outcome": "passed"}, "call": {"duration": 0.1491198455914855, "outcome": "passed"}, "teardown": {"duration": 0.00012365169823169708, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_in_spec_none_hashability", "lineno": 3500, "outcome": "passed", "keywords": ["test_in_spec_none_hashability", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00017402786761522293, "outcome": "passed"}, "call": {"duration": 0.0005675582215189934, "outcome": "passed"}, "teardown": {"duration": 7.174629718065262e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_in_spec_none_rank_errors", "lineno": 3445, "outcome": "passed", "keywords": ["test_in_spec_none_rank_errors", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00014560483396053314, "outcome": "passed"}, "call": {"duration": 0.0016910769045352936, "outcome": "passed"}, "teardown": {"duration": 7.99279659986496e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_in_specs_none_error", "lineno": 1507, "outcome": "passed", "keywords": ["test_in_specs_none_error", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013986695557832718, "outcome": "passed"}, "call": {"duration": 0.18367948662489653, "outcome": "passed"}, "teardown": {"duration": 0.00012188032269477844, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_jacrev_explicit", "lineno": 1539, "outcome": "passed", "keywords": ["test_jacrev_explicit", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018774718046188354, "outcome": "passed"}, "call": {"duration": 1.492064910940826, "outcome": "passed"}, "teardown": {"duration": 0.00012850016355514526, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_jacrev_explicit_complex", "lineno": 1539, "outcome": "passed", "keywords": ["test_jacrev_explicit_complex", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019260495901107788, "outcome": "passed"}, "call": {"duration": 0.5785920871421695, "outcome": "passed"}, "teardown": {"duration": 0.0001297416165471077, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_jaxpr_shardings_with_no_outputs", "lineno": 1763, "outcome": "passed", "keywords": ["test_jaxpr_shardings_with_no_outputs", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00020834803581237793, "outcome": "passed"}, "call": {"duration": 0.7471024310216308, "outcome": "passed"}, "teardown": {"duration": 0.00024108588695526123, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_jnp_histogram", "lineno": 1539, "outcome": "passed", "keywords": ["test_jnp_histogram", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00039576366543769836, "outcome": "passed"}, "call": {"duration": 8.394615177996457, "outcome": "passed"}, "teardown": {"duration": 0.00013545993715524673, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_jvp_basic", "lineno": 756, "outcome": "passed", "keywords": ["test_jvp_basic", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001963600516319275, "outcome": "passed"}, "call": {"duration": 3.533545811660588, "outcome": "passed"}, "teardown": {"duration": 0.00024263840168714523, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_key_array_with_replicated_last_tile_dim", "lineno": 1802, "outcome": "passed", "keywords": ["test_key_array_with_replicated_last_tile_dim", "__wrapped__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00039261020720005035, "outcome": "passed"}, "call": {"duration": 0.5073664421215653, "outcome": "passed"}, "teardown": {"duration": 0.00012847967445850372, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_linalg_inv", "lineno": 1539, "outcome": "rerun", "keywords": ["test_linalg_inv", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00022665411233901978, "outcome": "passed"}, "call": {"duration": 0.37907356582581997, "outcome": "passed", "stderr": "E1120 01:31:12.232089 2677651 pjrt_stream_executor_client.cc:2974] Execution of replica 0 failed: INTERNAL: external/jax/jaxlib/gpu/linalg_kernels.cc:113: operation gpuGetLastError() failed: peer access is already enabled\nE1120 01:31:12.265629 2677654 pjrt_stream_executor_client.cc:2974] Execution of replica 0 failed: INTERNAL: external/jax/jaxlib/gpu/linalg_kernels.cc:113: operation gpuGetLastError() failed: peer access is already enabled\n"}, "teardown": {"duration": 0.000131264328956604, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_linearize_basic", "lineno": 764, "outcome": "passed", "keywords": ["test_linearize_basic", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00020452216267585754, "outcome": "passed"}, "call": {"duration": 1.3698141751810908, "outcome": "passed"}, "teardown": {"duration": 0.0001246938481926918, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_linearize_basic_repres", "lineno": 778, "outcome": "passed", "keywords": ["test_linearize_basic_repres", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018898863345384598, "outcome": "passed"}, "call": {"duration": 1.3036734005436301, "outcome": "passed"}, "teardown": {"duration": 0.00012702681124210358, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_linearize_basic_repres_jit", "lineno": 792, "outcome": "passed", "keywords": ["test_linearize_basic_repres_jit", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018734578043222427, "outcome": "passed"}, "call": {"duration": 1.2943055341020226, "outcome": "passed"}, "teardown": {"duration": 0.00012426357716321945, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_matmul_partial", "lineno": 208, "outcome": "skipped", "keywords": ["test_matmul_partial", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018771644681692123, "outcome": "passed"}, "call": {"duration": 0.00039006583392620087, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 209, 'Skipped: invalid replication asserted by out_spec?')"}, "teardown": {"duration": 7.749348878860474e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_matmul_reduce_scatter", "lineno": 224, "outcome": "passed", "keywords": ["test_matmul_reduce_scatter", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013865530490875244, "outcome": "passed"}, "call": {"duration": 27.04723080713302, "outcome": "passed", "stderr": "E1120 01:31:27.908507 2677657 rendezvous.cc:92] [id=0] This thread has been waiting for `initialize clique for rank 1; clique=devices=[0,2]; is_p2p=0; groups=[[0,2],[1,3],[4,6],[5,7]]; root_device=-1; num_local_participants=2; incarnations=[]; run_id=-1135282449` for 10 seconds and may be stuck. All 2 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:31:27.920226 2677669 rendezvous.cc:92] [id=0] This thread has been waiting for `initialize clique for rank 1; clique=devices=[4,6]; is_p2p=0; groups=[[0,2],[1,3],[4,6],[5,7]]; root_device=-1; num_local_participants=2; incarnations=[]; run_id=-1135282449` for 10 seconds and may be stuck. All 2 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:31:27.949356 2677654 rendezvous.cc:92] [id=0] This thread has been waiting for `initialize clique for rank 0; clique=devices=[1,3]; is_p2p=0; groups=[[0,2],[1,3],[4,6],[5,7]]; root_device=-1; num_local_participants=2; incarnations=[]; run_id=-1135282449` for 10 seconds and may be stuck. All 2 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:31:27.973692 2677672 rendezvous.cc:92] [id=0] This thread has been waiting for `initialize clique for rank 1; clique=devices=[5,7]; is_p2p=0; groups=[[0,2],[1,3],[4,6],[5,7]]; root_device=-1; num_local_participants=2; incarnations=[]; run_id=-1135282449` for 10 seconds and may be stuck. All 2 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:31:27.994389 2677669 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:31:28.811291 2677654 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:31:28.811304 2677657 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:31:28.813592 2677672 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:31:39.304104 2677651 rendezvous.cc:92] [id=2] This thread has been waiting for `initialize clique for rank 0; clique=devices=[0,2,1,3]; is_p2p=0; groups=[[0,1,2,3],[4,5,6,7]]; root_device=-1; num_local_participants=4; incarnations=[]; run_id=1159427045` for 10 seconds and may be stuck. All 4 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:31:39.304167 2677660 rendezvous.cc:92] [id=0] This thread has been waiting for `initialize clique for rank 3; clique=devices=[0,2,1,3]; is_p2p=0; groups=[[0,1,2,3],[4,5,6,7]]; root_device=-1; num_local_participants=4; incarnations=[]; run_id=1159427045` for 10 seconds and may be stuck. All 4 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:31:39.304157 2677657 rendezvous.cc:92] [id=1] This thread has been waiting for `initialize clique for rank 1; clique=devices=[0,2,1,3]; is_p2p=0; groups=[[0,1,2,3],[4,5,6,7]]; root_device=-1; num_local_participants=4; incarnations=[]; run_id=1159427045` for 10 seconds and may be stuck. All 4 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:31:39.305679 2677669 rendezvous.cc:92] [id=2] This thread has been waiting for `initialize clique for rank 1; clique=devices=[4,6,5,7]; is_p2p=0; groups=[[0,1,2,3],[4,5,6,7]]; root_device=-1; num_local_participants=4; incarnations=[]; run_id=1159427045` for 10 seconds and may be stuck. All 4 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:31:39.305711 2677666 rendezvous.cc:92] [id=1] This thread has been waiting for `initialize clique for rank 2; clique=devices=[4,6,5,7]; is_p2p=0; groups=[[0,1,2,3],[4,5,6,7]]; root_device=-1; num_local_participants=4; incarnations=[]; run_id=1159427045` for 10 seconds and may be stuck. All 4 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:31:39.305709 2677672 rendezvous.cc:92] [id=0] This thread has been waiting for `initialize clique for rank 3; clique=devices=[4,6,5,7]; is_p2p=0; groups=[[0,1,2,3],[4,5,6,7]]; root_device=-1; num_local_participants=4; incarnations=[]; run_id=1159427045` for 10 seconds and may be stuck. All 4 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:31:42.502678 2677651 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:31:42.502680 2677660 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:31:42.502684 2677657 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:31:43.841261 2677666 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:31:43.841266 2677669 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:31:43.841266 2677672 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\n"}, "teardown": {"duration": 0.0003493456169962883, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_mul_with_vma_in_types", "lineno": 3558, "outcome": "passed", "keywords": ["test_mul_with_vma_in_types", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003919089213013649, "outcome": "passed"}, "call": {"duration": 0.20588761568069458, "outcome": "passed"}, "teardown": {"duration": 0.0001267269253730774, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_multiple_result_primitive_with_none_sharding", "lineno": 1097, "outcome": "passed", "keywords": ["test_multiple_result_primitive_with_none_sharding", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001913122832775116, "outcome": "passed"}, "call": {"duration": 1.8705503642559052, "outcome": "passed"}, "teardown": {"duration": 0.00028555281460285187, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_mutable_array_arg_basic", "lineno": 1539, "outcome": "passed", "keywords": ["test_mutable_array_arg_basic", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00041493307799100876, "outcome": "passed"}, "call": {"duration": 0.7856240877881646, "outcome": "passed"}, "teardown": {"duration": 0.0002665538340806961, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_mutable_array_internal_basic", "lineno": 1539, "outcome": "passed", "keywords": ["test_mutable_array_internal_basic", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003934009000658989, "outcome": "passed"}, "call": {"duration": 0.22863652277737856, "outcome": "passed"}, "teardown": {"duration": 0.00024654343724250793, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_nested_partial_auto", "lineno": 2999, "outcome": "passed", "keywords": ["test_nested_partial_auto", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004000011831521988, "outcome": "passed"}, "call": {"duration": 0.19112923927605152, "outcome": "passed"}, "teardown": {"duration": 0.00021668989211320877, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_nested_partial_auto_1d_0", "lineno": 3018, "outcome": "passed", "keywords": ["test_nested_partial_auto_1d_0", "__wrapped__", "__x_use_name__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003291359171271324, "outcome": "passed"}, "call": {"duration": 0.06511291582137346, "outcome": "passed"}, "teardown": {"duration": 0.00019714143127202988, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_nested_partial_auto_1d_1", "lineno": 3018, "outcome": "passed", "keywords": ["test_nested_partial_auto_1d_1", "__wrapped__", "__x_use_name__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00032656174153089523, "outcome": "passed"}, "call": {"duration": 0.04415972903370857, "outcome": "passed"}, "teardown": {"duration": 0.00011584069579839706, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_nested_partial_auto_1d_2", "lineno": 3018, "outcome": "passed", "keywords": ["test_nested_partial_auto_1d_2", "__wrapped__", "__x_use_name__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001826295629143715, "outcome": "passed"}, "call": {"duration": 1.4529246035963297, "outcome": "passed"}, "teardown": {"duration": 0.00012489501386880875, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_nested_partial_auto_1d_3", "lineno": 3018, "outcome": "passed", "keywords": ["test_nested_partial_auto_1d_3", "__wrapped__", "__x_use_name__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019240379333496094, "outcome": "passed"}, "call": {"duration": 0.20431556459516287, "outcome": "passed"}, "teardown": {"duration": 0.00020476337522268295, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_nested_vmap_with_capture_spmd_axis_name", "lineno": 1211, "outcome": "skipped", "keywords": ["test_nested_vmap_with_capture_spmd_axis_name", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003994405269622803, "outcome": "passed"}, "call": {"duration": 0.0008565951138734818, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 1212, 'Skipped: https://github.com/jax-ml/jax/issues/23476')"}, "teardown": {"duration": 0.00018848851323127747, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_no_mesh_context_error", "lineno": 3820, "outcome": "passed", "keywords": ["test_no_mesh_context_error", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.000345851294696331, "outcome": "passed"}, "call": {"duration": 0.0012355335056781769, "outcome": "passed"}, "teardown": {"duration": 0.00017703231424093246, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_optimize_remat", "lineno": 978, "outcome": "passed", "keywords": ["test_optimize_remat", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003404030576348305, "outcome": "passed"}, "call": {"duration": 0.6612970186397433, "outcome": "passed"}, "teardown": {"duration": 0.00013052299618721008, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_outer_jit_detects_shard_map_mesh", "lineno": 868, "outcome": "passed", "keywords": ["test_outer_jit_detects_shard_map_mesh", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001931348815560341, "outcome": "passed"}, "call": {"duration": 0.04225428495556116, "outcome": "passed"}, "teardown": {"duration": 0.0001178346574306488, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto", "lineno": 2661, "outcome": "passed", "keywords": ["test_partial_auto", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018560513854026794, "outcome": "passed"}, "call": {"duration": 0.05582778248935938, "outcome": "passed"}, "teardown": {"duration": 0.00012110825628042221, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_axis_index", "lineno": 3156, "outcome": "passed", "keywords": ["test_partial_auto_axis_index", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001900307834148407, "outcome": "passed"}, "call": {"duration": 0.1858814274892211, "outcome": "passed"}, "teardown": {"duration": 0.0001258663833141327, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_axis_index_degenerated_axis", "lineno": 3169, "outcome": "passed", "keywords": ["test_partial_auto_axis_index_degenerated_axis", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001897905021905899, "outcome": "passed"}, "call": {"duration": 0.18111906480044127, "outcome": "passed"}, "teardown": {"duration": 0.00024386029690504074, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_axis_index_eager", "lineno": 1422, "outcome": "passed", "keywords": ["test_partial_auto_axis_index_eager", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004020640626549721, "outcome": "passed"}, "call": {"duration": 0.46708868257701397, "outcome": "passed"}, "teardown": {"duration": 0.00012586545199155807, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_debug_print", "lineno": 3217, "outcome": "skipped", "keywords": ["test_partial_auto_debug_print", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.000187787227332592, "outcome": "passed"}, "call": {"duration": 0.00038813333958387375, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 3218, 'Skipped: shardy error')"}, "teardown": {"duration": 7.993821054697037e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_error_invalid_auto", "lineno": 2931, "outcome": "passed", "keywords": ["test_partial_auto_error_invalid_auto", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013862457126379013, "outcome": "passed"}, "call": {"duration": 0.019142392091453075, "outcome": "passed"}, "teardown": {"duration": 9.65222716331482e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_error_wrong_in_specs", "lineno": 2954, "outcome": "passed", "keywords": ["test_partial_auto_error_wrong_in_specs", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00015905499458312988, "outcome": "passed"}, "call": {"duration": 0.0018898816779255867, "outcome": "passed"}, "teardown": {"duration": 8.276291191577911e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_error_wsc_manual", "lineno": 2908, "outcome": "passed", "keywords": ["test_partial_auto_error_wsc_manual", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00014629680663347244, "outcome": "passed"}, "call": {"duration": 0.0181656489148736, "outcome": "passed"}, "teardown": {"duration": 9.352806955575943e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_explicit", "lineno": 1539, "outcome": "passed", "keywords": ["test_partial_auto_explicit", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00015939585864543915, "outcome": "passed"}, "call": {"duration": 1.5592327378690243, "outcome": "passed"}, "teardown": {"duration": 0.0001323949545621872, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_explicit_multi_explicit", "lineno": 1539, "outcome": "passed", "keywords": ["test_partial_auto_explicit_multi_explicit", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019479822367429733, "outcome": "passed"}, "call": {"duration": 0.5934062413871288, "outcome": "passed"}, "teardown": {"duration": 0.00021045096218585968, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_explicit_no_set_mesh", "lineno": 2695, "outcome": "passed", "keywords": ["test_partial_auto_explicit_no_set_mesh", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00033375341445207596, "outcome": "passed"}, "call": {"duration": 0.08767009060829878, "outcome": "passed"}, "teardown": {"duration": 0.0001223115250468254, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_mismatch_mesh_error", "lineno": 2977, "outcome": "passed", "keywords": ["test_partial_auto_mismatch_mesh_error", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001872871071100235, "outcome": "passed"}, "call": {"duration": 0.002605978399515152, "outcome": "passed"}, "teardown": {"duration": 8.641835302114487e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_of_pjit", "lineno": 3116, "outcome": "passed", "keywords": ["test_partial_auto_of_pjit", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00014884024858474731, "outcome": "passed"}, "call": {"duration": 0.35606037452816963, "outcome": "passed"}, "teardown": {"duration": 0.00025010015815496445, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_of_pjit_different_mesh", "lineno": 3133, "outcome": "skipped", "keywords": ["test_partial_auto_of_pjit_different_mesh", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004014531150460243, "outcome": "passed"}, "call": {"duration": 0.000848342664539814, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 3134, 'Skipped: Shardy requires the mesh axis names to be the same across the entire computation.')"}, "teardown": {"duration": 0.00019449740648269653, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_of_random_keys", "lineno": 3235, "outcome": "passed", "keywords": ["test_partial_auto_of_random_keys", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00033919140696525574, "outcome": "passed"}, "call": {"duration": 0.5655367998406291, "outcome": "passed"}, "teardown": {"duration": 0.00022336002439260483, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_of_random_keys_slice", "lineno": 3249, "outcome": "passed", "keywords": ["test_partial_auto_of_random_keys_slice", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00032900460064411163, "outcome": "passed"}, "call": {"duration": 0.3810414895415306, "outcome": "passed"}, "teardown": {"duration": 0.0001282794401049614, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_ppermute", "lineno": 3181, "outcome": "passed", "keywords": ["test_partial_auto_ppermute", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001914631575345993, "outcome": "passed"}, "call": {"duration": 0.19817499537020922, "outcome": "passed"}, "teardown": {"duration": 0.000238882377743721, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_auto_propagate_through", "lineno": 2789, "outcome": "passed", "keywords": ["test_partial_auto_propagate_through", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004140818491578102, "outcome": "passed"}, "call": {"duration": 0.4154269639402628, "outcome": "passed"}, "teardown": {"duration": 0.0001277374103665352, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_eval_custom_axis_env", "lineno": 1436, "outcome": "passed", "keywords": ["test_partial_eval_custom_axis_env", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018768664449453354, "outcome": "passed"}, "call": {"duration": 0.008165430277585983, "outcome": "passed"}, "teardown": {"duration": 8.835084736347198e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_manual_explicit_shmap_1", "lineno": 1539, "outcome": "passed", "keywords": ["test_partial_manual_explicit_shmap_1", "__wrapped__", "__x_use_name__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001446027308702469, "outcome": "passed"}, "call": {"duration": 0.7435632757842541, "outcome": "passed"}, "teardown": {"duration": 0.00012873951345682144, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_partial_manual_explicit_shmap_2", "lineno": 1539, "outcome": "passed", "keywords": ["test_partial_manual_explicit_shmap_2", "__wrapped__", "__x_use_name__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019026082009077072, "outcome": "passed"}, "call": {"duration": 0.17201037239283323, "outcome": "passed"}, "teardown": {"duration": 0.00012439396232366562, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_pbroadcast_fully_replicated", "lineno": 647, "outcome": "passed", "keywords": ["test_pbroadcast_fully_replicated", "__wrapped__", "__x_use_name__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001875767484307289, "outcome": "passed"}, "call": {"duration": 0.3967026798054576, "outcome": "passed"}, "teardown": {"duration": 0.00024890806525945663, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_pbroadcast_partial_replicated", "lineno": 647, "outcome": "passed", "keywords": ["test_pbroadcast_partial_replicated", "__wrapped__", "__x_use_name__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00040031131356954575, "outcome": "passed"}, "call": {"duration": 0.6237305263057351, "outcome": "passed"}, "teardown": {"duration": 0.0002516424283385277, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_pmax", "lineno": 3542, "outcome": "passed", "keywords": ["test_pmax", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004226146265864372, "outcome": "passed"}, "call": {"duration": 0.26876163482666016, "outcome": "passed"}, "teardown": {"duration": 0.00012437254190444946, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_pmax_vma_in_types", "lineno": 3549, "outcome": "passed", "keywords": ["test_pmax_vma_in_types", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018484331667423248, "outcome": "passed"}, "call": {"duration": 0.032297009602189064, "outcome": "passed"}, "teardown": {"duration": 0.00011412892490625381, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_pmin", "lineno": 3535, "outcome": "passed", "keywords": ["test_pmin", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00017959438264369965, "outcome": "passed"}, "call": {"duration": 0.09303403180092573, "outcome": "passed"}, "teardown": {"duration": 0.00012453366070985794, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_post_process", "lineno": 949, "outcome": "passed", "keywords": ["test_post_process", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018797814846038818, "outcome": "passed"}, "call": {"duration": 2.5828189374879003, "outcome": "passed"}, "teardown": {"duration": 0.000251120887696743, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_post_process_partial_eval_with_scalar_res", "lineno": 1905, "outcome": "passed", "keywords": ["test_post_process_partial_eval_with_scalar_res", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00041043665260076523, "outcome": "passed"}, "call": {"duration": 1.167559095658362, "outcome": "passed"}, "teardown": {"duration": 0.00013165362179279327, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_print_inside_shard_map0", "lineno": 3338, "outcome": "passed", "keywords": ["test_print_inside_shard_map0", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00020285043865442276, "outcome": "passed"}, "call": {"duration": 0.4722618917003274, "outcome": "passed", "stdout": "On rocm:0 at mesh coordinates (x, y,) = (0, 0):\n[0. 1. 2. 3.]\n\nOn rocm:1 at mesh coordinates (x, y,) = (0, 1):\n[0. 1. 2. 3.]\n\nOn rocm:2 at mesh coordinates (x, y,) = (1, 0):\n[0. 1. 2. 3.]\n\nOn rocm:3 at mesh coordinates (x, y,) = (1, 1):\n[0. 1. 2. 3.]\n\n"}, "teardown": {"duration": 0.00021025072783231735, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_print_inside_shard_map1", "lineno": 3338, "outcome": "passed", "keywords": ["test_print_inside_shard_map1", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003212839365005493, "outcome": "passed"}, "call": {"duration": 0.47738959453999996, "outcome": "passed", "stdout": "On rocm:0 at mesh coordinates (x, y,) = (0, 0):\n[0. 1.]\n\nOn rocm:1 at mesh coordinates (x, y,) = (0, 1):\n[0. 1.]\n\nOn rocm:2 at mesh coordinates (x, y,) = (1, 0):\n[2. 3.]\n\nOn rocm:3 at mesh coordinates (x, y,) = (1, 1):\n[2. 3.]\n\n"}, "teardown": {"duration": 0.00012784916907548904, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_print_inside_shard_map2", "lineno": 3338, "outcome": "passed", "keywords": ["test_print_inside_shard_map2", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018693599849939346, "outcome": "passed"}, "call": {"duration": 0.27214876655489206, "outcome": "passed", "stdout": "On rocm:0 at mesh coordinates (x, y,) = (0, 0):\n[0.]\n\nOn rocm:1 at mesh coordinates (x, y,) = (0, 1):\n[1.]\n\nOn rocm:2 at mesh coordinates (x, y,) = (1, 0):\n[2.]\n\nOn rocm:3 at mesh coordinates (x, y,) = (1, 1):\n[3.]\n\n"}, "teardown": {"duration": 0.00012670829892158508, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_prngkeyarray_eager", "lineno": 1449, "outcome": "passed", "keywords": ["test_prngkeyarray_eager", "__wrapped__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018390174955129623, "outcome": "passed"}, "call": {"duration": 2.0575826466083527, "outcome": "passed"}, "teardown": {"duration": 0.00021816231310367584, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_process_env_traces", "lineno": 840, "outcome": "passed", "keywords": ["test_process_env_traces", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00033099856227636337, "outcome": "passed"}, "call": {"duration": 3.255225310102105, "outcome": "passed"}, "teardown": {"duration": 0.00012810900807380676, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_psend_precv_basic_two_gpus", "lineno": 297, "outcome": "failed", "keywords": ["test_psend_precv_basic_two_gpus", "__wrapped__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00021709129214286804, "outcome": "passed"}, "call": {"duration": 0.0217268792912364, "outcome": "failed", "crash": {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/lax/parallel.py", "lineno": 1195, "message": "NotImplementedError: psend is currently only implemented on GPUs"}, "traceback": [{"path": "jax/tests/shard_map_test.py", "lineno": 341, "message": ""}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py", "lineno": 263, "message": "in cache_miss"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py", "lineno": 146, "message": "in _python_pjit_helper"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py", "lineno": 1590, "message": "in _pjit_call_impl_python"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py", "lineno": 1554, "message": "in _resolve_and_lower"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py", "lineno": 1696, "message": "in _pjit_lower"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/profiler.py", "lineno": 359, "message": "in wrapper"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py", "lineno": 2411, "message": "in lower_sharding_computation"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py", "lineno": 2007, "message": "in _cached_lowering_to_hlo"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 1322, "message": "in lower_jaxpr_to_module"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 1900, "message": "in lower_jaxpr_to_fun"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2080, "message": "in jaxpr_subcomp"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2143, "message": "in _cached_lowering"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2222, "message": "in _emit_lowering_rule_as_fun"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2273, "message": "in _uncached_lowering"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2388, "message": "in lower_per_platform"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/shard_map.py", "lineno": 922, "message": "in _shard_map_lowering"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/shard_map.py", "lineno": 902, "message": "in _shard_map_lowering_shardy"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2080, "message": "in jaxpr_subcomp"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2143, "message": "in _cached_lowering"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2222, "message": "in _emit_lowering_rule_as_fun"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2273, "message": "in _uncached_lowering"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2388, "message": "in lower_per_platform"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/lax/parallel.py", "lineno": 1195, "message": "NotImplementedError"}], "longrepr": ">   c = fwd(a)\n\njax/tests/shard_map_test.py:341: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n>   fwd_token = jax.lax.psend(a, 'x', [(0, 1)])\nE   jax._src.source_info_util.JaxStackTraceBeforeTransformation: NotImplementedError: psend is currently only implemented on GPUs\nE   \nE   The preceding stack trace is the source of the JAX operation that, once transformed by JAX, triggered the following exception.\nE   \nE   --------------------\n\njax/tests/shard_map_test.py:313: JaxStackTraceBeforeTransformation\n\nThe above exception was the direct cause of the following exception:\n\nself = <tests.shard_map_test.ShardMapTest testMethod=test_psend_precv_basic_two_gpus>\n\n    @jtu.run_on_devices(\"gpu\")\n    def test_psend_precv_basic_two_gpus(self):\n      mesh = jtu.create_mesh((2,), 'x')\n      a = jax.device_put(\n          jnp.arange(2 * 2, dtype=jnp.float32).reshape((2, 2)),\n          jax.sharding.NamedSharding(mesh, P('x', None)))\n      weights = jax.random.uniform(\n          key=jax.random.key(0), shape=(2, 1), dtype=jnp.float32)\n    \n      @jax.jit\n      @partial(\n          shard_map, mesh=mesh, in_specs=(P('x', None),), out_specs=P('x', None)\n      )\n      def fwd(a):\n        return_dtype_and_shape = jax.ShapeDtypeStruct(a.shape, a.dtype)\n        fwd_token = jax.lax.psend(a, 'x', [(0, 1)])\n        data = jax.lax.precv(\n            fwd_token, return_dtype_and_shape, 'x', [(0, 1)])\n        # Here we use an optimization barrier to enforce an arbitrary ordering of\n        # operations. This makes sure the mat mul only happens after the recv is\n        # complete.\n        weights_, _ = (\n            jax.lax.optimization_barrier(\n                (weights, data)\n            )\n        )\n        res = jnp.dot(weights_, data)\n    \n        # send the compute result back to the first device\n        bwd_token = jax.lax.psend(\n            res,\n            axis_name='x',\n            perm=[(1, 0)],\n        )\n    \n        bwd_data = jax.lax.precv(\n            bwd_token,\n            out_shape=return_dtype_and_shape,\n            axis_name='x',\n            perm=[(1, 0)]\n        )\n        return bwd_data\n    \n>     c = fwd(a)\n          ^^^^^^\n\njax/tests/shard_map_test.py:341: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py:263: in cache_miss\n    executable, pgle_profiler, const_args) = _python_pjit_helper(\n/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py:146: in _python_pjit_helper\n    out_flat, compiled, profiler, const_args = _pjit_call_impl_python(\n/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py:1590: in _pjit_call_impl_python\n    computation = _resolve_and_lower(\n/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py:1554: in _resolve_and_lower\n    return _pjit_lower(\n/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py:1696: in _pjit_lower\n    return pxla.lower_sharding_computation(\n/usr/local/lib/python3.12/dist-packages/jax/_src/profiler.py:359: in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py:2411: in lower_sharding_computation\n    nreps, tuple_args, shape_poly_state) = _cached_lowering_to_hlo(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py:2007: in _cached_lowering_to_hlo\n    lowering_result = mlir.lower_jaxpr_to_module(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:1322: in lower_jaxpr_to_module\n    lower_jaxpr_to_fun(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:1900: in lower_jaxpr_to_fun\n    out_vals, tokens_out = jaxpr_subcomp(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2080: in jaxpr_subcomp\n    out_nodes, tokens_out = _cached_lowering(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2143: in _cached_lowering\n    cache_entry = _emit_lowering_rule_as_fun(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2222: in _emit_lowering_rule_as_fun\n    outs, inline = lowering_rule(sub_ctx, *unflattened_args, **params)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2273: in _uncached_lowering\n    ans = lower_per_platform(ctx, str(primitive), platform_rules, default_rule,\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2388: in lower_per_platform\n    output = kept_rules[0](ctx, *rule_args, **rule_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n/usr/local/lib/python3.12/dist-packages/jax/_src/shard_map.py:922: in _shard_map_lowering\n    return _shard_map_lowering_shardy(\n/usr/local/lib/python3.12/dist-packages/jax/_src/shard_map.py:902: in _shard_map_lowering_shardy\n    out_nodes_, tokens_out = mlir.jaxpr_subcomp(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2080: in jaxpr_subcomp\n    out_nodes, tokens_out = _cached_lowering(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2143: in _cached_lowering\n    cache_entry = _emit_lowering_rule_as_fun(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2222: in _emit_lowering_rule_as_fun\n    outs, inline = lowering_rule(sub_ctx, *unflattened_args, **params)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2273: in _uncached_lowering\n    ans = lower_per_platform(ctx, str(primitive), platform_rules, default_rule,\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2388: in lower_per_platform\n    output = kept_rules[0](ctx, *rule_args, **rule_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nctx = LoweringRuleContext(module_context=ModuleContext(context=<jax._src.interpreters.mlir.JaxIrContext object at 0x7ee14c71...Mesh('x': 2, axis_types=(Manual,), device_kind=AMD Instinct MI300X, num_cores=304), xla_metadata=None), platforms=None)\nx = <jaxlib.mlir._mlir_libs._mlir.ir.BlockArgument object at 0x7ee20870a870>\n\n    def _psend_lowering_gpu(ctx, x, *, axis_name, perm):\n      if (\"cuda\" not in ctx.module_context.platforms):\n>       raise NotImplementedError(\"psend is currently only implemented on GPUs\")\nE       NotImplementedError: psend is currently only implemented on GPUs\n\n/usr/local/lib/python3.12/dist-packages/jax/_src/lax/parallel.py:1195: NotImplementedError"}, "teardown": {"duration": 0.00021076109260320663, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_psend_precv_basic_with_dangling_recv", "lineno": 444, "outcome": "passed", "keywords": ["test_psend_precv_basic_with_dangling_recv", "__wrapped__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00020538270473480225, "outcome": "passed"}, "call": {"duration": 0.02038294356316328, "outcome": "passed"}, "teardown": {"duration": 0.00010588578879833221, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_psend_precv_basic_with_deadlock_cycle", "lineno": 405, "outcome": "failed", "keywords": ["test_psend_precv_basic_with_deadlock_cycle", "__wrapped__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00024173688143491745, "outcome": "passed"}, "call": {"duration": 0.019261437468230724, "outcome": "failed", "crash": {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/lax/parallel.py", "lineno": 1195, "message": "NotImplementedError: psend is currently only implemented on GPUs"}, "traceback": [{"path": "jax/tests/shard_map_test.py", "lineno": 443, "message": ""}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/traceback_util.py", "lineno": 180, "message": "in reraise_with_filtered_traceback"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py", "lineno": 263, "message": "in cache_miss"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py", "lineno": 146, "message": "in _python_pjit_helper"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py", "lineno": 1590, "message": "in _pjit_call_impl_python"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py", "lineno": 1554, "message": "in _resolve_and_lower"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py", "lineno": 1696, "message": "in _pjit_lower"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/profiler.py", "lineno": 359, "message": "in wrapper"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py", "lineno": 2411, "message": "in lower_sharding_computation"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py", "lineno": 2007, "message": "in _cached_lowering_to_hlo"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 1322, "message": "in lower_jaxpr_to_module"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 1900, "message": "in lower_jaxpr_to_fun"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2080, "message": "in jaxpr_subcomp"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2143, "message": "in _cached_lowering"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2222, "message": "in _emit_lowering_rule_as_fun"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2273, "message": "in _uncached_lowering"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2388, "message": "in lower_per_platform"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/shard_map.py", "lineno": 922, "message": "in _shard_map_lowering"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/shard_map.py", "lineno": 902, "message": "in _shard_map_lowering_shardy"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2080, "message": "in jaxpr_subcomp"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2143, "message": "in _cached_lowering"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2222, "message": "in _emit_lowering_rule_as_fun"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2273, "message": "in _uncached_lowering"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2388, "message": "in lower_per_platform"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/lax/parallel.py", "lineno": 1195, "message": "NotImplementedError"}], "longrepr": ">   fwd(a)\n\njax/tests/shard_map_test.py:443: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n>   fwd_token = jax.lax.psend(\n        a,\n        axis_name='x',\n        perm=[(0, 1), (1, 0)],\n    )\nE   jax._src.source_info_util.JaxStackTraceBeforeTransformation: NotImplementedError: psend is currently only implemented on GPUs\nE   \nE   The preceding stack trace is the source of the JAX operation that, once transformed by JAX, triggered the following exception.\nE   \nE   --------------------\n\njax/tests/shard_map_test.py:423: JaxStackTraceBeforeTransformation\n\nThe above exception was the direct cause of the following exception:\n\nself = <tests.shard_map_test.ShardMapTest testMethod=test_psend_precv_basic_with_deadlock_cycle>\n\n    @jtu.run_on_devices('gpu')\n    def test_psend_precv_basic_with_deadlock_cycle(self):\n      mesh = jtu.create_mesh((2,), 'x')\n      a = jax.device_put(\n          jnp.arange(2 * 2, dtype=jnp.float32).reshape((2, 2)),\n          jax.sharding.NamedSharding(mesh, P('x', None)),\n      )\n    \n      @jax.jit\n      @partial(\n          jax.shard_map,\n          mesh=mesh,\n          in_specs=P('x', None),\n          out_specs=P('x', None),\n      )\n      def fwd(a):\n        return_dtype_and_shape = jax.ShapeDtypeStruct(a.shape, a.dtype)\n        fwd_token = jax.lax.psend(\n            a,\n            axis_name='x',\n            perm=[(0, 1), (1, 0)],\n        )\n    \n        data = jax.lax.precv(\n            fwd_token,\n            out_shape=return_dtype_and_shape,\n            axis_name='x',\n            perm=[(0, 1), (1, 0)],\n        )\n        return data\n      expected_error_message = (\n          'Expected send and recv instructions to have non-cyclical'\n          ' source-target pairs'\n      )\n      with self.assertRaisesRegex(\n          jax.errors.JaxRuntimeError, expected_error_message\n      ):\n>       fwd(a)\n\njax/tests/shard_map_test.py:443: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.12/dist-packages/jax/_src/traceback_util.py:180: in reraise_with_filtered_traceback\n    return fun(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^\n/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py:263: in cache_miss\n    executable, pgle_profiler, const_args) = _python_pjit_helper(\n/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py:146: in _python_pjit_helper\n    out_flat, compiled, profiler, const_args = _pjit_call_impl_python(\n/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py:1590: in _pjit_call_impl_python\n    computation = _resolve_and_lower(\n/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py:1554: in _resolve_and_lower\n    return _pjit_lower(\n/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py:1696: in _pjit_lower\n    return pxla.lower_sharding_computation(\n/usr/local/lib/python3.12/dist-packages/jax/_src/profiler.py:359: in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py:2411: in lower_sharding_computation\n    nreps, tuple_args, shape_poly_state) = _cached_lowering_to_hlo(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py:2007: in _cached_lowering_to_hlo\n    lowering_result = mlir.lower_jaxpr_to_module(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:1322: in lower_jaxpr_to_module\n    lower_jaxpr_to_fun(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:1900: in lower_jaxpr_to_fun\n    out_vals, tokens_out = jaxpr_subcomp(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2080: in jaxpr_subcomp\n    out_nodes, tokens_out = _cached_lowering(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2143: in _cached_lowering\n    cache_entry = _emit_lowering_rule_as_fun(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2222: in _emit_lowering_rule_as_fun\n    outs, inline = lowering_rule(sub_ctx, *unflattened_args, **params)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2273: in _uncached_lowering\n    ans = lower_per_platform(ctx, str(primitive), platform_rules, default_rule,\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2388: in lower_per_platform\n    output = kept_rules[0](ctx, *rule_args, **rule_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n/usr/local/lib/python3.12/dist-packages/jax/_src/shard_map.py:922: in _shard_map_lowering\n    return _shard_map_lowering_shardy(\n/usr/local/lib/python3.12/dist-packages/jax/_src/shard_map.py:902: in _shard_map_lowering_shardy\n    out_nodes_, tokens_out = mlir.jaxpr_subcomp(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2080: in jaxpr_subcomp\n    out_nodes, tokens_out = _cached_lowering(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2143: in _cached_lowering\n    cache_entry = _emit_lowering_rule_as_fun(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2222: in _emit_lowering_rule_as_fun\n    outs, inline = lowering_rule(sub_ctx, *unflattened_args, **params)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2273: in _uncached_lowering\n    ans = lower_per_platform(ctx, str(primitive), platform_rules, default_rule,\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2388: in lower_per_platform\n    output = kept_rules[0](ctx, *rule_args, **rule_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n    def _psend_lowering_gpu(ctx, x, *, axis_name, perm):\n      if (\"cuda\" not in ctx.module_context.platforms):\n>       raise NotImplementedError(\"psend is currently only implemented on GPUs\")\nE       NotImplementedError: psend is currently only implemented on GPUs\n\n/usr/local/lib/python3.12/dist-packages/jax/_src/lax/parallel.py:1195: NotImplementedError"}, "teardown": {"duration": 0.00021079182624816895, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_psend_precv_basic_with_duplicate_source_target_pairs", "lineno": 514, "outcome": "failed", "keywords": ["test_psend_precv_basic_with_duplicate_source_target_pairs", "__wrapped__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0002128947526216507, "outcome": "passed"}, "call": {"duration": 0.019341636449098587, "outcome": "failed", "crash": {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/lax/parallel.py", "lineno": 1195, "message": "NotImplementedError: psend is currently only implemented on GPUs"}, "traceback": [{"path": "jax/tests/shard_map_test.py", "lineno": 552, "message": ""}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/traceback_util.py", "lineno": 180, "message": "in reraise_with_filtered_traceback"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py", "lineno": 263, "message": "in cache_miss"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py", "lineno": 146, "message": "in _python_pjit_helper"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py", "lineno": 1590, "message": "in _pjit_call_impl_python"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py", "lineno": 1554, "message": "in _resolve_and_lower"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py", "lineno": 1696, "message": "in _pjit_lower"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/profiler.py", "lineno": 359, "message": "in wrapper"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py", "lineno": 2411, "message": "in lower_sharding_computation"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py", "lineno": 2007, "message": "in _cached_lowering_to_hlo"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 1322, "message": "in lower_jaxpr_to_module"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 1900, "message": "in lower_jaxpr_to_fun"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2080, "message": "in jaxpr_subcomp"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2143, "message": "in _cached_lowering"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2222, "message": "in _emit_lowering_rule_as_fun"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2273, "message": "in _uncached_lowering"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2388, "message": "in lower_per_platform"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/shard_map.py", "lineno": 922, "message": "in _shard_map_lowering"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/shard_map.py", "lineno": 902, "message": "in _shard_map_lowering_shardy"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2080, "message": "in jaxpr_subcomp"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2143, "message": "in _cached_lowering"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2222, "message": "in _emit_lowering_rule_as_fun"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2273, "message": "in _uncached_lowering"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2388, "message": "in lower_per_platform"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/lax/parallel.py", "lineno": 1195, "message": "NotImplementedError"}], "longrepr": ">   fwd(a)\n\njax/tests/shard_map_test.py:552: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n>   fwd_token = jax.lax.psend(\n        a,\n        axis_name='x',\n        perm=[(0, 1), (0, 1)],\n    )\nE   jax._src.source_info_util.JaxStackTraceBeforeTransformation: NotImplementedError: psend is currently only implemented on GPUs\nE   \nE   The preceding stack trace is the source of the JAX operation that, once transformed by JAX, triggered the following exception.\nE   \nE   --------------------\n\njax/tests/shard_map_test.py:532: JaxStackTraceBeforeTransformation\n\nThe above exception was the direct cause of the following exception:\n\nself = <tests.shard_map_test.ShardMapTest testMethod=test_psend_precv_basic_with_duplicate_source_target_pairs>\n\n    @jtu.run_on_devices('gpu')\n    def test_psend_precv_basic_with_duplicate_source_target_pairs(self):\n      mesh = jtu.create_mesh((2,), 'x')\n      a = jax.device_put(\n          jnp.arange(2 * 2, dtype=jnp.float32).reshape((2, 2)),\n          jax.sharding.NamedSharding(mesh, P('x', None)),\n      )\n    \n      @jax.jit\n      @partial(\n          jax.shard_map,\n          mesh=mesh,\n          in_specs=P('x', None),\n          out_specs=P('x', None),\n      )\n      def fwd(a):\n        return_dtype_and_shape = jax.ShapeDtypeStruct(a.shape, a.dtype)\n        fwd_token = jax.lax.psend(\n            a,\n            axis_name='x',\n            perm=[(0, 1), (0, 1)],\n        )\n    \n        data = jax.lax.precv(\n            fwd_token,\n            out_shape=return_dtype_and_shape,\n            axis_name='x',\n            perm=[(1, 0)],\n        )\n        return data\n    \n      expected_error_message = (\n          'psend sources and destinations must be unique'\n      )\n      with self.assertRaisesRegex(\n          ValueError, expected_error_message\n      ):\n>       fwd(a)\n\njax/tests/shard_map_test.py:552: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.12/dist-packages/jax/_src/traceback_util.py:180: in reraise_with_filtered_traceback\n    return fun(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^\n/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py:263: in cache_miss\n    executable, pgle_profiler, const_args) = _python_pjit_helper(\n/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py:146: in _python_pjit_helper\n    out_flat, compiled, profiler, const_args = _pjit_call_impl_python(\n/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py:1590: in _pjit_call_impl_python\n    computation = _resolve_and_lower(\n/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py:1554: in _resolve_and_lower\n    return _pjit_lower(\n/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py:1696: in _pjit_lower\n    return pxla.lower_sharding_computation(\n/usr/local/lib/python3.12/dist-packages/jax/_src/profiler.py:359: in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py:2411: in lower_sharding_computation\n    nreps, tuple_args, shape_poly_state) = _cached_lowering_to_hlo(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py:2007: in _cached_lowering_to_hlo\n    lowering_result = mlir.lower_jaxpr_to_module(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:1322: in lower_jaxpr_to_module\n    lower_jaxpr_to_fun(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:1900: in lower_jaxpr_to_fun\n    out_vals, tokens_out = jaxpr_subcomp(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2080: in jaxpr_subcomp\n    out_nodes, tokens_out = _cached_lowering(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2143: in _cached_lowering\n    cache_entry = _emit_lowering_rule_as_fun(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2222: in _emit_lowering_rule_as_fun\n    outs, inline = lowering_rule(sub_ctx, *unflattened_args, **params)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2273: in _uncached_lowering\n    ans = lower_per_platform(ctx, str(primitive), platform_rules, default_rule,\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2388: in lower_per_platform\n    output = kept_rules[0](ctx, *rule_args, **rule_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n/usr/local/lib/python3.12/dist-packages/jax/_src/shard_map.py:922: in _shard_map_lowering\n    return _shard_map_lowering_shardy(\n/usr/local/lib/python3.12/dist-packages/jax/_src/shard_map.py:902: in _shard_map_lowering_shardy\n    out_nodes_, tokens_out = mlir.jaxpr_subcomp(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2080: in jaxpr_subcomp\n    out_nodes, tokens_out = _cached_lowering(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2143: in _cached_lowering\n    cache_entry = _emit_lowering_rule_as_fun(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2222: in _emit_lowering_rule_as_fun\n    outs, inline = lowering_rule(sub_ctx, *unflattened_args, **params)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2273: in _uncached_lowering\n    ans = lower_per_platform(ctx, str(primitive), platform_rules, default_rule,\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2388: in lower_per_platform\n    output = kept_rules[0](ctx, *rule_args, **rule_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n    def _psend_lowering_gpu(ctx, x, *, axis_name, perm):\n      if (\"cuda\" not in ctx.module_context.platforms):\n>       raise NotImplementedError(\"psend is currently only implemented on GPUs\")\nE       NotImplementedError: psend is currently only implemented on GPUs\n\n/usr/local/lib/python3.12/dist-packages/jax/_src/lax/parallel.py:1195: NotImplementedError"}, "teardown": {"duration": 0.00020873825997114182, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_psend_precv_basic_with_no_deadlock_cycle", "lineno": 343, "outcome": "failed", "keywords": ["test_psend_precv_basic_with_no_deadlock_cycle", "__wrapped__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.000217570923268795, "outcome": "passed"}, "call": {"duration": 0.022020110860466957, "outcome": "failed", "crash": {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/lax/parallel.py", "lineno": 1195, "message": "NotImplementedError: psend is currently only implemented on GPUs"}, "traceback": [{"path": "jax/tests/shard_map_test.py", "lineno": 403, "message": ""}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py", "lineno": 263, "message": "in cache_miss"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py", "lineno": 146, "message": "in _python_pjit_helper"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py", "lineno": 1590, "message": "in _pjit_call_impl_python"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py", "lineno": 1554, "message": "in _resolve_and_lower"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py", "lineno": 1696, "message": "in _pjit_lower"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/profiler.py", "lineno": 359, "message": "in wrapper"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py", "lineno": 2411, "message": "in lower_sharding_computation"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py", "lineno": 2007, "message": "in _cached_lowering_to_hlo"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 1322, "message": "in lower_jaxpr_to_module"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 1900, "message": "in lower_jaxpr_to_fun"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2080, "message": "in jaxpr_subcomp"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2143, "message": "in _cached_lowering"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2222, "message": "in _emit_lowering_rule_as_fun"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2273, "message": "in _uncached_lowering"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2388, "message": "in lower_per_platform"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/shard_map.py", "lineno": 922, "message": "in _shard_map_lowering"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/shard_map.py", "lineno": 902, "message": "in _shard_map_lowering_shardy"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2080, "message": "in jaxpr_subcomp"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2143, "message": "in _cached_lowering"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2222, "message": "in _emit_lowering_rule_as_fun"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2273, "message": "in _uncached_lowering"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2388, "message": "in lower_per_platform"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/lax/parallel.py", "lineno": 1195, "message": "NotImplementedError"}], "longrepr": ">   c = fwd(a)\n\njax/tests/shard_map_test.py:403: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n>   fwd_token = jax.lax.psend(\n        a,\n        axis_name=\"x\",\n        perm=[(0, 1), (1, 2), (2, 3), (3, 4), (4, 5), (5, 6), (6, 7)],\n    )\nE   jax._src.source_info_util.JaxStackTraceBeforeTransformation: NotImplementedError: psend is currently only implemented on GPUs\nE   \nE   The preceding stack trace is the source of the JAX operation that, once transformed by JAX, triggered the following exception.\nE   \nE   --------------------\n\njax/tests/shard_map_test.py:362: JaxStackTraceBeforeTransformation\n\nThe above exception was the direct cause of the following exception:\n\nself = <tests.shard_map_test.ShardMapTest testMethod=test_psend_precv_basic_with_no_deadlock_cycle>\n\n    @jtu.run_on_devices(\"gpu\")\n    def test_psend_precv_basic_with_no_deadlock_cycle(self):\n      mesh = jtu.create_mesh((8,), 'x')\n      a = jax.device_put(\n          jnp.arange(8 * 8, dtype=jnp.float32).reshape((8, 8)),\n          jax.sharding.NamedSharding(mesh, P('x', None)))\n      weights = jax.random.uniform(\n          key=jax.random.key(0), shape=(8, 1), dtype=jnp.float32)\n    \n      @jax.jit\n      @partial(\n          jax.shard_map, mesh=mesh, in_specs=(P('x', None),), out_specs=P('x', None)\n      )\n      def fwd(a):\n        return_dtype_and_shape = jax.ShapeDtypeStruct(a.shape, a.dtype)\n    \n        # We define the \"forward edge\" to be the device-to-device communication\n        # originating from device 0 in increasing indices.\n        fwd_token = jax.lax.psend(\n            a,\n            axis_name=\"x\",\n            perm=[(0, 1), (1, 2), (2, 3), (3, 4), (4, 5), (5, 6), (6, 7)],\n        )\n    \n        data = jax.lax.precv(\n            fwd_token,\n            out_shape=return_dtype_and_shape,\n            axis_name=\"x\",\n            perm=[(0, 1), (1, 2), (2, 3), (3, 4), (4, 5), (5, 6), (6, 7)],\n        )\n    \n        # Here we use an optimization barrier to enforce an arbitrary ordering of\n        # collectives. This will make sure compute happens after recv on the forward\n        # edge, and by extension will make sure the send on the back edge happens\n        # after the recv on the forward edge. Without this optimization barrier, the\n        # send on the backward edge might slip before the forward edge recv ops are\n        # completed, and will cause a deadlock.\n        weights_, _ = (\n            jax.lax.optimization_barrier(\n                (weights, data)\n            )\n        )\n        res = jnp.dot(weights_, data)\n    \n        # send the compute result back to the first device\n        bwd_token = jax.lax.psend(\n            res,\n            axis_name=\"x\",\n            perm=[(7, 0)],\n        )\n    \n        bwd_data = jax.lax.precv(\n            bwd_token,\n            out_shape=return_dtype_and_shape,\n            axis_name=\"x\",\n            perm=[(7, 0)]\n        )\n        return bwd_data\n    \n>     c = fwd(a)\n          ^^^^^^\n\njax/tests/shard_map_test.py:403: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py:263: in cache_miss\n    executable, pgle_profiler, const_args) = _python_pjit_helper(\n/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py:146: in _python_pjit_helper\n    out_flat, compiled, profiler, const_args = _pjit_call_impl_python(\n/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py:1590: in _pjit_call_impl_python\n    computation = _resolve_and_lower(\n/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py:1554: in _resolve_and_lower\n    return _pjit_lower(\n/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py:1696: in _pjit_lower\n    return pxla.lower_sharding_computation(\n/usr/local/lib/python3.12/dist-packages/jax/_src/profiler.py:359: in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py:2411: in lower_sharding_computation\n    nreps, tuple_args, shape_poly_state) = _cached_lowering_to_hlo(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py:2007: in _cached_lowering_to_hlo\n    lowering_result = mlir.lower_jaxpr_to_module(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:1322: in lower_jaxpr_to_module\n    lower_jaxpr_to_fun(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:1900: in lower_jaxpr_to_fun\n    out_vals, tokens_out = jaxpr_subcomp(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2080: in jaxpr_subcomp\n    out_nodes, tokens_out = _cached_lowering(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2143: in _cached_lowering\n    cache_entry = _emit_lowering_rule_as_fun(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2222: in _emit_lowering_rule_as_fun\n    outs, inline = lowering_rule(sub_ctx, *unflattened_args, **params)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2273: in _uncached_lowering\n    ans = lower_per_platform(ctx, str(primitive), platform_rules, default_rule,\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2388: in lower_per_platform\n    output = kept_rules[0](ctx, *rule_args, **rule_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n/usr/local/lib/python3.12/dist-packages/jax/_src/shard_map.py:922: in _shard_map_lowering\n    return _shard_map_lowering_shardy(\n/usr/local/lib/python3.12/dist-packages/jax/_src/shard_map.py:902: in _shard_map_lowering_shardy\n    out_nodes_, tokens_out = mlir.jaxpr_subcomp(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2080: in jaxpr_subcomp\n    out_nodes, tokens_out = _cached_lowering(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2143: in _cached_lowering\n    cache_entry = _emit_lowering_rule_as_fun(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2222: in _emit_lowering_rule_as_fun\n    outs, inline = lowering_rule(sub_ctx, *unflattened_args, **params)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2273: in _uncached_lowering\n    ans = lower_per_platform(ctx, str(primitive), platform_rules, default_rule,\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2388: in lower_per_platform\n    output = kept_rules[0](ctx, *rule_args, **rule_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nctx = LoweringRuleContext(module_context=ModuleContext(context=<jax._src.interpreters.mlir.JaxIrContext object at 0x7ee2ec57...Mesh('x': 8, axis_types=(Manual,), device_kind=AMD Instinct MI300X, num_cores=304), xla_metadata=None), platforms=None)\nx = <jaxlib.mlir._mlir_libs._mlir.ir.BlockArgument object at 0x7ee0b473cb30>\n\n    def _psend_lowering_gpu(ctx, x, *, axis_name, perm):\n      if (\"cuda\" not in ctx.module_context.platforms):\n>       raise NotImplementedError(\"psend is currently only implemented on GPUs\")\nE       NotImplementedError: psend is currently only implemented on GPUs\n\n/usr/local/lib/python3.12/dist-packages/jax/_src/lax/parallel.py:1195: NotImplementedError"}, "teardown": {"duration": 0.00020640436559915543, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_psend_precv_basic_with_non_matching_source_target_pairs", "lineno": 475, "outcome": "failed", "keywords": ["test_psend_precv_basic_with_non_matching_source_target_pairs", "__wrapped__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00022052600979804993, "outcome": "passed"}, "call": {"duration": 0.01992669887840748, "outcome": "failed", "crash": {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/lax/parallel.py", "lineno": 1195, "message": "NotImplementedError: psend is currently only implemented on GPUs"}, "traceback": [{"path": "jax/tests/shard_map_test.py", "lineno": 513, "message": ""}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/traceback_util.py", "lineno": 180, "message": "in reraise_with_filtered_traceback"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py", "lineno": 263, "message": "in cache_miss"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py", "lineno": 146, "message": "in _python_pjit_helper"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py", "lineno": 1590, "message": "in _pjit_call_impl_python"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py", "lineno": 1554, "message": "in _resolve_and_lower"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py", "lineno": 1696, "message": "in _pjit_lower"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/profiler.py", "lineno": 359, "message": "in wrapper"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py", "lineno": 2411, "message": "in lower_sharding_computation"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py", "lineno": 2007, "message": "in _cached_lowering_to_hlo"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 1322, "message": "in lower_jaxpr_to_module"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 1900, "message": "in lower_jaxpr_to_fun"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2080, "message": "in jaxpr_subcomp"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2143, "message": "in _cached_lowering"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2222, "message": "in _emit_lowering_rule_as_fun"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2273, "message": "in _uncached_lowering"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2388, "message": "in lower_per_platform"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/shard_map.py", "lineno": 922, "message": "in _shard_map_lowering"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/shard_map.py", "lineno": 902, "message": "in _shard_map_lowering_shardy"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2080, "message": "in jaxpr_subcomp"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2143, "message": "in _cached_lowering"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2222, "message": "in _emit_lowering_rule_as_fun"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2273, "message": "in _uncached_lowering"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2388, "message": "in lower_per_platform"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/lax/parallel.py", "lineno": 1195, "message": "NotImplementedError"}], "longrepr": ">   fwd(a)\n\njax/tests/shard_map_test.py:513: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n>   fwd_token = jax.lax.psend(\n        a,\n        axis_name='x',\n        perm=[(0, 1)],\n    )\nE   jax._src.source_info_util.JaxStackTraceBeforeTransformation: NotImplementedError: psend is currently only implemented on GPUs\nE   \nE   The preceding stack trace is the source of the JAX operation that, once transformed by JAX, triggered the following exception.\nE   \nE   --------------------\n\njax/tests/shard_map_test.py:493: JaxStackTraceBeforeTransformation\n\nThe above exception was the direct cause of the following exception:\n\nself = <tests.shard_map_test.ShardMapTest testMethod=test_psend_precv_basic_with_non_matching_source_target_pairs>\n\n    @jtu.run_on_devices('gpu')\n    def test_psend_precv_basic_with_non_matching_source_target_pairs(self):\n      mesh = jtu.create_mesh((2,), 'x')\n      a = jax.device_put(\n          jnp.arange(2 * 2, dtype=jnp.float32).reshape((2, 2)),\n          jax.sharding.NamedSharding(mesh, P('x', None)),\n      )\n    \n      @jax.jit\n      @partial(\n          jax.shard_map,\n          mesh=mesh,\n          in_specs=P('x', None),\n          out_specs=P('x', None),\n      )\n      def fwd(a):\n        return_dtype_and_shape = jax.ShapeDtypeStruct(a.shape, a.dtype)\n        fwd_token = jax.lax.psend(\n            a,\n            axis_name='x',\n            perm=[(0, 1)],\n        )\n    \n        data = jax.lax.precv(\n            fwd_token,\n            out_shape=return_dtype_and_shape,\n            axis_name='x',\n            perm=[(1, 0)],\n        )\n        return data\n    \n      expected_error_message = (\n          'Deadlock detected. Last checked instructions: %psend'\n      )\n      with self.assertRaisesRegex(\n          jax.errors.JaxRuntimeError, expected_error_message\n      ):\n>       fwd(a)\n\njax/tests/shard_map_test.py:513: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.12/dist-packages/jax/_src/traceback_util.py:180: in reraise_with_filtered_traceback\n    return fun(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^\n/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py:263: in cache_miss\n    executable, pgle_profiler, const_args) = _python_pjit_helper(\n/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py:146: in _python_pjit_helper\n    out_flat, compiled, profiler, const_args = _pjit_call_impl_python(\n/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py:1590: in _pjit_call_impl_python\n    computation = _resolve_and_lower(\n/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py:1554: in _resolve_and_lower\n    return _pjit_lower(\n/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py:1696: in _pjit_lower\n    return pxla.lower_sharding_computation(\n/usr/local/lib/python3.12/dist-packages/jax/_src/profiler.py:359: in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py:2411: in lower_sharding_computation\n    nreps, tuple_args, shape_poly_state) = _cached_lowering_to_hlo(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py:2007: in _cached_lowering_to_hlo\n    lowering_result = mlir.lower_jaxpr_to_module(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:1322: in lower_jaxpr_to_module\n    lower_jaxpr_to_fun(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:1900: in lower_jaxpr_to_fun\n    out_vals, tokens_out = jaxpr_subcomp(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2080: in jaxpr_subcomp\n    out_nodes, tokens_out = _cached_lowering(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2143: in _cached_lowering\n    cache_entry = _emit_lowering_rule_as_fun(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2222: in _emit_lowering_rule_as_fun\n    outs, inline = lowering_rule(sub_ctx, *unflattened_args, **params)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2273: in _uncached_lowering\n    ans = lower_per_platform(ctx, str(primitive), platform_rules, default_rule,\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2388: in lower_per_platform\n    output = kept_rules[0](ctx, *rule_args, **rule_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n/usr/local/lib/python3.12/dist-packages/jax/_src/shard_map.py:922: in _shard_map_lowering\n    return _shard_map_lowering_shardy(\n/usr/local/lib/python3.12/dist-packages/jax/_src/shard_map.py:902: in _shard_map_lowering_shardy\n    out_nodes_, tokens_out = mlir.jaxpr_subcomp(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2080: in jaxpr_subcomp\n    out_nodes, tokens_out = _cached_lowering(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2143: in _cached_lowering\n    cache_entry = _emit_lowering_rule_as_fun(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2222: in _emit_lowering_rule_as_fun\n    outs, inline = lowering_rule(sub_ctx, *unflattened_args, **params)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2273: in _uncached_lowering\n    ans = lower_per_platform(ctx, str(primitive), platform_rules, default_rule,\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2388: in lower_per_platform\n    output = kept_rules[0](ctx, *rule_args, **rule_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n    def _psend_lowering_gpu(ctx, x, *, axis_name, perm):\n      if (\"cuda\" not in ctx.module_context.platforms):\n>       raise NotImplementedError(\"psend is currently only implemented on GPUs\")\nE       NotImplementedError: psend is currently only implemented on GPUs\n\n/usr/local/lib/python3.12/dist-packages/jax/_src/lax/parallel.py:1195: NotImplementedError"}, "teardown": {"duration": 0.00021712016314268112, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_psend_precv_reverse_two_gpus", "lineno": 553, "outcome": "failed", "keywords": ["test_psend_precv_reverse_two_gpus", "__wrapped__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00021813251078128815, "outcome": "passed"}, "call": {"duration": 0.01923012174665928, "outcome": "failed", "crash": {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/lax/parallel.py", "lineno": 1195, "message": "NotImplementedError: psend is currently only implemented on GPUs"}, "traceback": [{"path": "jax/tests/shard_map_test.py", "lineno": 580, "message": ""}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py", "lineno": 263, "message": "in cache_miss"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py", "lineno": 146, "message": "in _python_pjit_helper"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py", "lineno": 1590, "message": "in _pjit_call_impl_python"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py", "lineno": 1554, "message": "in _resolve_and_lower"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py", "lineno": 1696, "message": "in _pjit_lower"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/profiler.py", "lineno": 359, "message": "in wrapper"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py", "lineno": 2411, "message": "in lower_sharding_computation"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py", "lineno": 2007, "message": "in _cached_lowering_to_hlo"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 1322, "message": "in lower_jaxpr_to_module"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 1900, "message": "in lower_jaxpr_to_fun"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2080, "message": "in jaxpr_subcomp"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2143, "message": "in _cached_lowering"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2222, "message": "in _emit_lowering_rule_as_fun"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2273, "message": "in _uncached_lowering"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2388, "message": "in lower_per_platform"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/shard_map.py", "lineno": 922, "message": "in _shard_map_lowering"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/shard_map.py", "lineno": 902, "message": "in _shard_map_lowering_shardy"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2080, "message": "in jaxpr_subcomp"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2143, "message": "in _cached_lowering"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2222, "message": "in _emit_lowering_rule_as_fun"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2273, "message": "in _uncached_lowering"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py", "lineno": 2388, "message": "in lower_per_platform"}, {"path": "/usr/local/lib/python3.12/dist-packages/jax/_src/lax/parallel.py", "lineno": 1195, "message": "NotImplementedError"}], "longrepr": ">   c = fwd(a)\n\njax/tests/shard_map_test.py:580: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n>   _ = jax.lax.psend(\n        dummy_data,\n        axis_name=\"x\",\n        perm=[(0, 1)],\n    )\nE   jax._src.source_info_util.JaxStackTraceBeforeTransformation: NotImplementedError: psend is currently only implemented on GPUs\nE   \nE   The preceding stack trace is the source of the JAX operation that, once transformed by JAX, triggered the following exception.\nE   \nE   --------------------\n\njax/tests/shard_map_test.py:573: JaxStackTraceBeforeTransformation\n\nThe above exception was the direct cause of the following exception:\n\nself = <tests.shard_map_test.ShardMapTest testMethod=test_psend_precv_reverse_two_gpus>\n\n    @jtu.run_on_devices(\"gpu\")\n    def test_psend_precv_reverse_two_gpus(self):\n      mesh = jtu.create_mesh((2,), 'x')\n      a = jax.device_put(\n          jnp.arange(2 * 2, dtype=jnp.float32).reshape((2, 2)),\n          jax.sharding.NamedSharding(mesh, P('x', None)))\n      @jax.jit\n      @partial(\n          jax.shard_map, mesh=mesh, in_specs=(P('x', None),), out_specs=P('x', None)\n      )\n      def fwd(a):\n        return_dtype_and_shape = jax.ShapeDtypeStruct(a.shape, a.dtype)\n        dummy_data = jax.lax.precv(\n            jax.lax.create_token(),\n            out_shape=return_dtype_and_shape,\n            axis_name=\"x\",\n            perm=[(0, 1)],\n        )\n    \n        _ = jax.lax.psend(\n            dummy_data,\n            axis_name=\"x\",\n            perm=[(0, 1)],\n        )\n        return dummy_data\n    \n>     c = fwd(a)\n          ^^^^^^\n\njax/tests/shard_map_test.py:580: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py:263: in cache_miss\n    executable, pgle_profiler, const_args) = _python_pjit_helper(\n/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py:146: in _python_pjit_helper\n    out_flat, compiled, profiler, const_args = _pjit_call_impl_python(\n/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py:1590: in _pjit_call_impl_python\n    computation = _resolve_and_lower(\n/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py:1554: in _resolve_and_lower\n    return _pjit_lower(\n/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py:1696: in _pjit_lower\n    return pxla.lower_sharding_computation(\n/usr/local/lib/python3.12/dist-packages/jax/_src/profiler.py:359: in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py:2411: in lower_sharding_computation\n    nreps, tuple_args, shape_poly_state) = _cached_lowering_to_hlo(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py:2007: in _cached_lowering_to_hlo\n    lowering_result = mlir.lower_jaxpr_to_module(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:1322: in lower_jaxpr_to_module\n    lower_jaxpr_to_fun(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:1900: in lower_jaxpr_to_fun\n    out_vals, tokens_out = jaxpr_subcomp(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2080: in jaxpr_subcomp\n    out_nodes, tokens_out = _cached_lowering(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2143: in _cached_lowering\n    cache_entry = _emit_lowering_rule_as_fun(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2222: in _emit_lowering_rule_as_fun\n    outs, inline = lowering_rule(sub_ctx, *unflattened_args, **params)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2273: in _uncached_lowering\n    ans = lower_per_platform(ctx, str(primitive), platform_rules, default_rule,\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2388: in lower_per_platform\n    output = kept_rules[0](ctx, *rule_args, **rule_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n/usr/local/lib/python3.12/dist-packages/jax/_src/shard_map.py:922: in _shard_map_lowering\n    return _shard_map_lowering_shardy(\n/usr/local/lib/python3.12/dist-packages/jax/_src/shard_map.py:902: in _shard_map_lowering_shardy\n    out_nodes_, tokens_out = mlir.jaxpr_subcomp(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2080: in jaxpr_subcomp\n    out_nodes, tokens_out = _cached_lowering(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2143: in _cached_lowering\n    cache_entry = _emit_lowering_rule_as_fun(\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2222: in _emit_lowering_rule_as_fun\n    outs, inline = lowering_rule(sub_ctx, *unflattened_args, **params)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2273: in _uncached_lowering\n    ans = lower_per_platform(ctx, str(primitive), platform_rules, default_rule,\n/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/mlir.py:2388: in lower_per_platform\n    output = kept_rules[0](ctx, *rule_args, **rule_kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nctx = LoweringRuleContext(module_context=ModuleContext(context=<jax._src.interpreters.mlir.JaxIrContext object at 0x7ee2ec53...Mesh('x': 2, axis_types=(Manual,), device_kind=AMD Instinct MI300X, num_cores=304), xla_metadata=None), platforms=None)\nx = <jaxlib.mlir._mlir_libs._mlir.ir.BlockArgument object at 0x7ee1e01c3df0>\n\n    def _psend_lowering_gpu(ctx, x, *, axis_name, perm):\n      if (\"cuda\" not in ctx.module_context.platforms):\n>       raise NotImplementedError(\"psend is currently only implemented on GPUs\")\nE       NotImplementedError: psend is currently only implemented on GPUs\n\n/usr/local/lib/python3.12/dist-packages/jax/_src/lax/parallel.py:1195: NotImplementedError"}, "teardown": {"duration": 0.00021278392523527145, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_psum_not_under_shmap_error", "lineno": 2629, "outcome": "passed", "keywords": ["test_psum_not_under_shmap_error", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00020667538046836853, "outcome": "passed"}, "call": {"duration": 0.001524561084806919, "outcome": "passed"}, "teardown": {"duration": 7.999874651432037e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_psum_transpose_non_zero_cts", "lineno": 1371, "outcome": "passed", "keywords": ["test_psum_transpose_non_zero_cts", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00014344137161970139, "outcome": "passed"}, "call": {"duration": 1.1001509856432676, "outcome": "passed"}, "teardown": {"duration": 0.0001269681379199028, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_psum_with_implicit_fanout_self_transposes", "lineno": 2154, "outcome": "passed", "keywords": ["test_psum_with_implicit_fanout_self_transposes", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018733739852905273, "outcome": "passed"}, "call": {"duration": 0.179434965364635, "outcome": "passed"}, "teardown": {"duration": 0.00011894572526216507, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_pure_callback_return_multiple_arrays", "lineno": 1539, "outcome": "passed", "keywords": ["test_pure_callback_return_multiple_arrays", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00017564930021762848, "outcome": "passed"}, "call": {"duration": 0.8266881313174963, "outcome": "passed"}, "teardown": {"duration": 0.0001224307343363762, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_pvary", "lineno": 2216, "outcome": "passed", "keywords": ["test_pvary", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001847716048359871, "outcome": "passed"}, "call": {"duration": 0.630276020616293, "outcome": "passed"}, "teardown": {"duration": 0.00012738816440105438, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_pvary_in_shmap_of_grad", "lineno": 3824, "outcome": "passed", "keywords": ["test_pvary_in_shmap_of_grad", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019004009664058685, "outcome": "passed"}, "call": {"duration": 1.5027727046981454, "outcome": "passed"}, "teardown": {"duration": 0.00012771878391504288, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_random_beta_vma", "lineno": 4139, "outcome": "passed", "keywords": ["test_random_beta_vma", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019564852118492126, "outcome": "passed"}, "call": {"duration": 12.716939934529364, "outcome": "passed"}, "teardown": {"duration": 0.0002505006268620491, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_random_choice_pvary", "lineno": 1539, "outcome": "passed", "keywords": ["test_random_choice_pvary", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00042236410081386566, "outcome": "passed"}, "call": {"duration": 4.561226847581565, "outcome": "passed"}, "teardown": {"duration": 0.0002142367884516716, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_random_normal_rules", "lineno": 2387, "outcome": "passed", "keywords": ["test_random_normal_rules", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00034258607774972916, "outcome": "passed"}, "call": {"duration": 0.5171666778624058, "outcome": "passed"}, "teardown": {"duration": 0.00020547397434711456, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_rank_errors", "lineno": 915, "outcome": "passed", "keywords": ["test_rank_errors", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00033203139901161194, "outcome": "passed"}, "call": {"duration": 0.06621453072875738, "outcome": "passed"}, "teardown": {"duration": 0.00011898577213287354, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_reduce_scatter_with_axis_index_groups", "lineno": 246, "outcome": "passed", "keywords": ["test_reduce_scatter_with_axis_index_groups", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.000177823007106781, "outcome": "passed"}, "call": {"duration": 2.596134817227721, "outcome": "passed"}, "teardown": {"duration": 0.0001271478831768036, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_remat_basic", "lineno": 1004, "outcome": "passed", "keywords": ["test_remat_basic", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001933462917804718, "outcome": "passed"}, "call": {"duration": 2.4366254890337586, "outcome": "passed"}, "teardown": {"duration": 0.0001418590545654297, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_remat_scalar_residuals", "lineno": 1046, "outcome": "passed", "keywords": ["test_remat_scalar_residuals", "__wrapped__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018238835036754608, "outcome": "passed"}, "call": {"duration": 16.093821009621024, "outcome": "passed"}, "teardown": {"duration": 0.000132695771753788, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_rep_none_canonicalization", "lineno": 3595, "outcome": "skipped", "keywords": ["test_rep_none_canonicalization", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001956988126039505, "outcome": "passed"}, "call": {"duration": 0.00041648559272289276, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/shard_map_test.py', 3596, 'Skipped: complex values fail under shardy')"}, "teardown": {"duration": 8.174031972885132e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_rep_none_canonicalization_again", "lineno": 3619, "outcome": "passed", "keywords": ["test_rep_none_canonicalization_again", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00014695711433887482, "outcome": "passed"}, "call": {"duration": 12.032419618219137, "outcome": "passed"}, "teardown": {"duration": 0.00025771092623472214, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_repeated_psum_allowed", "lineno": 2433, "outcome": "passed", "keywords": ["test_repeated_psum_allowed", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004135100170969963, "outcome": "passed"}, "call": {"duration": 0.6239476697519422, "outcome": "passed"}, "teardown": {"duration": 0.0002366797998547554, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_replication_checker_eager", "lineno": 806, "outcome": "passed", "keywords": ["test_replication_checker_eager", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00040711089968681335, "outcome": "passed"}, "call": {"duration": 0.39141421392560005, "outcome": "passed"}, "teardown": {"duration": 0.00012414250522851944, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_replication_checker_jit", "lineno": 824, "outcome": "passed", "keywords": ["test_replication_checker_jit", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018926989287137985, "outcome": "passed"}, "call": {"duration": 0.03392352070659399, "outcome": "passed"}, "teardown": {"duration": 0.00011309701949357986, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_res_forwarding_optimization0", "lineno": 2299, "outcome": "passed", "keywords": ["test_res_forwarding_optimization0", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001785634085536003, "outcome": "passed"}, "call": {"duration": 0.022486810572445393, "outcome": "passed"}, "teardown": {"duration": 9.665358811616898e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_res_forwarding_optimization1", "lineno": 2299, "outcome": "passed", "keywords": ["test_res_forwarding_optimization1", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001585446298122406, "outcome": "passed"}, "call": {"duration": 0.012223772704601288, "outcome": "passed"}, "teardown": {"duration": 8.786004036664963e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_res_forwarding_optimization2", "lineno": 2299, "outcome": "passed", "keywords": ["test_res_forwarding_optimization2", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00014854874461889267, "outcome": "passed"}, "call": {"duration": 0.015635652467608452, "outcome": "passed"}, "teardown": {"duration": 8.9242123067379e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_res_forwarding_optimization3", "lineno": 2299, "outcome": "passed", "keywords": ["test_res_forwarding_optimization3", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00015007145702838898, "outcome": "passed"}, "call": {"duration": 0.006798730231821537, "outcome": "passed"}, "teardown": {"duration": 8.624698966741562e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_res_forwarding_optimization_complex0", "lineno": 2321, "outcome": "passed", "keywords": ["test_res_forwarding_optimization_complex0", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00014858879148960114, "outcome": "passed"}, "call": {"duration": 0.04485529661178589, "outcome": "passed"}, "teardown": {"duration": 0.00010281149297952652, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_res_forwarding_optimization_complex1", "lineno": 2321, "outcome": "passed", "keywords": ["test_res_forwarding_optimization_complex1", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00016498472541570663, "outcome": "passed"}, "call": {"duration": 0.026013027876615524, "outcome": "passed"}, "teardown": {"duration": 9.62521880865097e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_res_forwarding_optimization_complex2", "lineno": 2321, "outcome": "passed", "keywords": ["test_res_forwarding_optimization_complex2", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001569623127579689, "outcome": "passed"}, "call": {"duration": 0.033663226291537285, "outcome": "passed"}, "teardown": {"duration": 0.00010017864406108856, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_res_forwarding_optimization_complex3", "lineno": 2321, "outcome": "passed", "keywords": ["test_res_forwarding_optimization_complex3", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00015715230256319046, "outcome": "passed"}, "call": {"duration": 0.01605894695967436, "outcome": "passed"}, "teardown": {"duration": 9.021349251270294e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_returned_out_sharding", "lineno": 1845, "outcome": "passed", "keywords": ["test_returned_out_sharding", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00015225447714328766, "outcome": "passed"}, "call": {"duration": 0.677478308789432, "outcome": "passed"}, "teardown": {"duration": 0.00027648918330669403, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_reverse_mode_ad", "lineno": 936, "outcome": "passed", "keywords": ["test_reverse_mode_ad", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00040544942021369934, "outcome": "passed"}, "call": {"duration": 4.208407639525831, "outcome": "passed"}, "teardown": {"duration": 0.00012869015336036682, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_rewrite_binops", "lineno": 2228, "outcome": "passed", "keywords": ["test_rewrite_binops", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001928946003317833, "outcome": "passed"}, "call": {"duration": 0.0027719540521502495, "outcome": "passed"}, "teardown": {"duration": 8.033867925405502e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_rewrite_custom_vjp_call_jaxpr0", "lineno": 2072, "outcome": "passed", "keywords": ["test_rewrite_custom_vjp_call_jaxpr0", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001467270776629448, "outcome": "passed"}, "call": {"duration": 0.8356985105201602, "outcome": "passed"}, "teardown": {"duration": 0.0001279488205909729, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_rewrite_custom_vjp_call_jaxpr1", "lineno": 2072, "outcome": "passed", "keywords": ["test_rewrite_custom_vjp_call_jaxpr1", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019145291298627853, "outcome": "passed"}, "call": {"duration": 1.1596650332212448, "outcome": "passed"}, "teardown": {"duration": 0.00015060137957334518, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_rewrite_post_process_call", "lineno": 1958, "outcome": "passed", "keywords": ["test_rewrite_post_process_call", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00020058546215295792, "outcome": "passed"}, "call": {"duration": 0.04124946054071188, "outcome": "passed"}, "teardown": {"duration": 0.00011968705803155899, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_rewrite_process_call", "lineno": 1944, "outcome": "passed", "keywords": ["test_rewrite_process_call", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018983986228704453, "outcome": "passed"}, "call": {"duration": 0.0460926229134202, "outcome": "passed"}, "teardown": {"duration": 0.00011979695409536362, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_rewrite_process_custom_jvp_call0", "lineno": 1975, "outcome": "passed", "keywords": ["test_rewrite_process_custom_jvp_call0", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018404144793748856, "outcome": "passed"}, "call": {"duration": 0.44737936835736036, "outcome": "passed"}, "teardown": {"duration": 0.0002441992983222008, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_rewrite_process_custom_jvp_call1", "lineno": 1975, "outcome": "passed", "keywords": ["test_rewrite_process_custom_jvp_call1", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00038864370435476303, "outcome": "passed"}, "call": {"duration": 0.6597201712429523, "outcome": "passed"}, "teardown": {"duration": 0.00012692809104919434, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_rewrite_process_custom_vjp_call0", "lineno": 2000, "outcome": "passed", "keywords": ["test_rewrite_process_custom_vjp_call0", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019233394414186478, "outcome": "passed"}, "call": {"duration": 0.4390538716688752, "outcome": "passed"}, "teardown": {"duration": 0.0001356499269604683, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_rewrite_process_custom_vjp_call1", "lineno": 2000, "outcome": "passed", "keywords": ["test_rewrite_process_custom_vjp_call1", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001884792000055313, "outcome": "passed"}, "call": {"duration": 1.0171656776219606, "outcome": "passed"}, "teardown": {"duration": 0.0001290617510676384, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_rewrite_process_custom_vjp_call_match_more_replicated0", "lineno": 2028, "outcome": "passed", "keywords": ["test_rewrite_process_custom_vjp_call_match_more_replicated0", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019374582916498184, "outcome": "passed"}, "call": {"duration": 0.29889248963445425, "outcome": "passed"}, "teardown": {"duration": 0.00020099710673093796, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_rewrite_process_custom_vjp_call_match_more_replicated1", "lineno": 2028, "outcome": "passed", "keywords": ["test_rewrite_process_custom_vjp_call_match_more_replicated1", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00032404903322458267, "outcome": "passed"}, "call": {"duration": 1.1367120742797852, "outcome": "passed"}, "teardown": {"duration": 0.00012815836817026138, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_rewrite_scan", "lineno": 2241, "outcome": "passed", "keywords": ["test_rewrite_scan", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019487738609313965, "outcome": "passed"}, "call": {"duration": 0.0020984793081879616, "outcome": "passed"}, "teardown": {"duration": 8.400436490774155e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_same_pspec_eager_shard_map", "lineno": 2056, "outcome": "passed", "keywords": ["test_same_pspec_eager_shard_map", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00015338696539402008, "outcome": "passed"}, "call": {"duration": 1.1663190890103579, "outcome": "passed"}, "teardown": {"duration": 0.00024331919848918915, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_scan_pvary_errors", "lineno": 3680, "outcome": "passed", "keywords": ["test_scan_pvary_errors", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003978470340371132, "outcome": "passed"}, "call": {"duration": 0.9925863854587078, "outcome": "passed"}, "teardown": {"duration": 0.00012189988046884537, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_scan_pvary_errors2", "lineno": 3710, "outcome": "passed", "keywords": ["test_scan_pvary_errors2", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018625520169734955, "outcome": "passed"}, "call": {"duration": 0.3705120338127017, "outcome": "passed"}, "teardown": {"duration": 0.0001262761652469635, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_scan_rep_rule", "lineno": 1516, "outcome": "passed", "keywords": ["test_scan_rep_rule", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018960051238536835, "outcome": "passed"}, "call": {"duration": 3.5671067843213677, "outcome": "passed"}, "teardown": {"duration": 0.00012622680515050888, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_shard_map_abstract_mesh", "lineno": 1242, "outcome": "passed", "keywords": ["test_shard_map_abstract_mesh", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001940866932272911, "outcome": "passed"}, "call": {"duration": 0.9114137329161167, "outcome": "passed"}, "teardown": {"duration": 0.0001261672005057335, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_sharded_prng_with_abstract_mesh", "lineno": 2891, "outcome": "passed", "keywords": ["test_sharded_prng_with_abstract_mesh", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001834305003285408, "outcome": "passed"}, "call": {"duration": 0.3764794571325183, "outcome": "passed"}, "teardown": {"duration": 0.0003784783184528351, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_sharded_random_bits0", "lineno": 1467, "outcome": "passed", "keywords": ["test_sharded_random_bits0", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00039890874177217484, "outcome": "passed"}, "call": {"duration": 0.5825535245239735, "outcome": "passed"}, "teardown": {"duration": 0.00020830798894166946, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_sharded_random_bits1", "lineno": 1467, "outcome": "passed", "keywords": ["test_sharded_random_bits1", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00033103860914707184, "outcome": "passed"}, "call": {"duration": 2.0856942888349295, "outcome": "passed"}, "teardown": {"duration": 0.00020583439618349075, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_sharded_random_bits2", "lineno": 1467, "outcome": "passed", "keywords": ["test_sharded_random_bits2", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00031993258744478226, "outcome": "passed"}, "call": {"duration": 0.69055709335953, "outcome": "passed"}, "teardown": {"duration": 0.00012472551316022873, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_sharding_metadata_in_hlo_attrs", "lineno": 1911, "outcome": "passed", "keywords": ["test_sharding_metadata_in_hlo_attrs", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018694624304771423, "outcome": "passed"}, "call": {"duration": 0.012817028909921646, "outcome": "passed"}, "teardown": {"duration": 9.487941861152649e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_shmap_abstract_mesh_errors", "lineno": 1296, "outcome": "passed", "keywords": ["test_shmap_abstract_mesh_errors", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00016482453793287277, "outcome": "passed"}, "call": {"duration": 0.0024996809661388397, "outcome": "passed"}, "teardown": {"duration": 8.09691846370697e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_shmap_auto_unreduced_error", "lineno": 2645, "outcome": "passed", "keywords": ["test_shmap_auto_unreduced_error", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00015815440565347672, "outcome": "passed"}, "call": {"duration": 0.000765790231525898, "outcome": "passed"}, "teardown": {"duration": 7.486063987016678e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_shmap_close_over_unused_params", "lineno": 2825, "outcome": "passed", "keywords": ["test_shmap_close_over_unused_params", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00014343205839395523, "outcome": "passed"}, "call": {"duration": 0.3580811256542802, "outcome": "passed"}, "teardown": {"duration": 0.00012871995568275452, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_shmap_close_over_unused_params_vmap", "lineno": 2873, "outcome": "passed", "keywords": ["test_shmap_close_over_unused_params_vmap", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018726754933595657, "outcome": "passed"}, "call": {"duration": 0.23325242660939693, "outcome": "passed"}, "teardown": {"duration": 0.00013226550072431564, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_shmap_full_manual_context_auto", "lineno": 1539, "outcome": "passed", "keywords": ["test_shmap_full_manual_context_auto", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019428599625825882, "outcome": "passed"}, "call": {"duration": 0.6387452324852347, "outcome": "passed"}, "teardown": {"duration": 0.00012914929538965225, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_shmap_full_manual_context_explicit", "lineno": 1539, "outcome": "passed", "keywords": ["test_shmap_full_manual_context_explicit", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018885917961597443, "outcome": "passed"}, "call": {"duration": 0.30690343119204044, "outcome": "passed"}, "teardown": {"duration": 0.0001325765624642372, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_shmap_linearize_and_linearize_transpose_error", "lineno": 3850, "outcome": "passed", "keywords": ["test_shmap_linearize_and_linearize_transpose_error", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019043125212192535, "outcome": "passed"}, "call": {"duration": 0.6584370536729693, "outcome": "passed"}, "teardown": {"duration": 0.00012674834579229355, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_shmap_of_remat_basic", "lineno": 1033, "outcome": "passed", "keywords": ["test_shmap_of_remat_basic", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019115209579467773, "outcome": "passed"}, "call": {"duration": 0.6221583159640431, "outcome": "passed"}, "teardown": {"duration": 0.00012411363422870636, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_shmap_partial_manual_auto", "lineno": 1539, "outcome": "passed", "keywords": ["test_shmap_partial_manual_auto", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001914631575345993, "outcome": "passed"}, "call": {"duration": 0.17672515287995338, "outcome": "passed"}, "teardown": {"duration": 0.00013056304305791855, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_shmap_partial_manual_explicit", "lineno": 1539, "outcome": "passed", "keywords": ["test_shmap_partial_manual_explicit", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018974952399730682, "outcome": "passed"}, "call": {"duration": 0.04377349838614464, "outcome": "passed"}, "teardown": {"duration": 0.00011298712342977524, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_shmap_unreduced_custom_vjp_bwd", "lineno": 1539, "outcome": "passed", "keywords": ["test_shmap_unreduced_custom_vjp_bwd", "__wrapped__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00017737224698066711, "outcome": "passed"}, "call": {"duration": 1.3008595379069448, "outcome": "passed"}, "teardown": {"duration": 0.0002444703131914139, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap0", "lineno": 3887, "outcome": "passed", "keywords": ["test_smap0", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019281450659036636, "outcome": "passed"}, "call": {"duration": 3.5462580174207687, "outcome": "passed"}, "teardown": {"duration": 0.0002583712339401245, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap1", "lineno": 3887, "outcome": "passed", "keywords": ["test_smap1", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.000399639829993248, "outcome": "passed"}, "call": {"duration": 0.2067179586738348, "outcome": "passed"}, "teardown": {"duration": 0.0002489173784852028, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_auto_error0", "lineno": 1539, "outcome": "passed", "keywords": ["test_smap_auto_error0", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003875214606523514, "outcome": "passed"}, "call": {"duration": 0.001534055918455124, "outcome": "passed"}, "teardown": {"duration": 0.00018341094255447388, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_auto_error1", "lineno": 1539, "outcome": "passed", "keywords": ["test_smap_auto_error1", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00033921096473932266, "outcome": "passed"}, "call": {"duration": 0.0011697066947817802, "outcome": "passed"}, "teardown": {"duration": 0.00017554033547639847, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_auto_explicit0", "lineno": 1539, "outcome": "passed", "keywords": ["test_smap_auto_explicit0", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00032849516719579697, "outcome": "passed"}, "call": {"duration": 0.7656053900718689, "outcome": "passed"}, "teardown": {"duration": 0.00012710783630609512, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_auto_explicit1", "lineno": 1539, "outcome": "passed", "keywords": ["test_smap_auto_explicit1", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019130297005176544, "outcome": "passed"}, "call": {"duration": 0.38226296845823526, "outcome": "passed"}, "teardown": {"duration": 0.00019844342023134232, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_auto_explicit_nest0", "lineno": 1539, "outcome": "passed", "keywords": ["test_smap_auto_explicit_nest0", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004026433452963829, "outcome": "passed"}, "call": {"duration": 1.2506786258891225, "outcome": "passed"}, "teardown": {"duration": 0.00024684425443410873, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_auto_explicit_nest1", "lineno": 1539, "outcome": "passed", "keywords": ["test_smap_auto_explicit_nest1", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004058200865983963, "outcome": "passed"}, "call": {"duration": 0.2424280783161521, "outcome": "passed"}, "teardown": {"duration": 0.0001253252848982811, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_auto_explicit_nest_inner_none0", "lineno": 1539, "outcome": "passed", "keywords": ["test_smap_auto_explicit_nest_inner_none0", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001979731023311615, "outcome": "passed"}, "call": {"duration": 0.8939809454604983, "outcome": "passed"}, "teardown": {"duration": 0.00012831948697566986, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_auto_explicit_nest_inner_none1", "lineno": 1539, "outcome": "passed", "keywords": ["test_smap_auto_explicit_nest_inner_none1", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019513815641403198, "outcome": "passed"}, "call": {"duration": 0.20088350120931864, "outcome": "passed"}, "teardown": {"duration": 0.0001261252909898758, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_auto_explicit_nest_mesh_call_time0", "lineno": 1539, "outcome": "passed", "keywords": ["test_smap_auto_explicit_nest_mesh_call_time0", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019154325127601624, "outcome": "passed"}, "call": {"duration": 0.25337505526840687, "outcome": "passed"}, "teardown": {"duration": 0.00013682153075933456, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_auto_explicit_nest_mesh_call_time1", "lineno": 1539, "outcome": "passed", "keywords": ["test_smap_auto_explicit_nest_mesh_call_time1", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018733739852905273, "outcome": "passed"}, "call": {"duration": 0.0480017326772213, "outcome": "passed"}, "teardown": {"duration": 0.00011889543384313583, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_explicit0", "lineno": 1539, "outcome": "passed", "keywords": ["test_smap_explicit0", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018607452511787415, "outcome": "passed"}, "call": {"duration": 0.6812042593955994, "outcome": "passed"}, "teardown": {"duration": 0.00020226836204528809, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_explicit1", "lineno": 1539, "outcome": "passed", "keywords": ["test_smap_explicit1", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003273244947195053, "outcome": "passed"}, "call": {"duration": 0.1929026236757636, "outcome": "passed"}, "teardown": {"duration": 0.0001272084191441536, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_nested_psum0", "lineno": 1539, "outcome": "passed", "keywords": ["test_smap_nested_psum0", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001885993406176567, "outcome": "passed"}, "call": {"duration": 0.7994442246854305, "outcome": "passed"}, "teardown": {"duration": 0.00012367311865091324, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_nested_psum1", "lineno": 1539, "outcome": "passed", "keywords": ["test_smap_nested_psum1", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018744636327028275, "outcome": "passed"}, "call": {"duration": 0.19774334225803614, "outcome": "passed"}, "teardown": {"duration": 0.00012611597776412964, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_replicated0", "lineno": 1539, "outcome": "passed", "keywords": ["test_smap_replicated0", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001914631575345993, "outcome": "passed"}, "call": {"duration": 0.2658200850710273, "outcome": "passed"}, "teardown": {"duration": 0.00012436416000127792, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_replicated1", "lineno": 1539, "outcome": "passed", "keywords": ["test_smap_replicated1", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018741749227046967, "outcome": "passed"}, "call": {"duration": 0.10548479948192835, "outcome": "passed"}, "teardown": {"duration": 0.00012447312474250793, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_replicated_sharded0", "lineno": 1539, "outcome": "passed", "keywords": ["test_smap_replicated_sharded0", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019499752670526505, "outcome": "passed"}, "call": {"duration": 0.6238498231396079, "outcome": "passed"}, "teardown": {"duration": 0.00020825862884521484, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_smap_replicated_sharded1", "lineno": 1539, "outcome": "passed", "keywords": ["test_smap_replicated_sharded1", "__wrapped__", "__x_params_repr__", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003243694081902504, "outcome": "passed"}, "call": {"duration": 0.32273159734904766, "outcome": "passed"}, "teardown": {"duration": 0.00012404285371303558, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_switch_rep_rule", "lineno": 1673, "outcome": "passed", "keywords": ["test_switch_rep_rule", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018977932631969452, "outcome": "passed"}, "call": {"duration": 0.643673368729651, "outcome": "passed"}, "teardown": {"duration": 0.00020643509924411774, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_temporary_error_suppression_flag", "lineno": 3482, "outcome": "passed", "keywords": ["test_temporary_error_suppression_flag", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003276737406849861, "outcome": "passed"}, "call": {"duration": 1.313251175917685, "outcome": "passed"}, "teardown": {"duration": 0.00024555251002311707, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_transpose_float0", "lineno": 2167, "outcome": "passed", "keywords": ["test_transpose_float0", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003971662372350693, "outcome": "passed"}, "call": {"duration": 0.31228368636220694, "outcome": "passed"}, "teardown": {"duration": 0.00012969225645065308, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_transpose_identity", "lineno": 2104, "outcome": "passed", "keywords": ["test_transpose_identity", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001908615231513977, "outcome": "passed"}, "call": {"duration": 0.29160647839307785, "outcome": "passed"}, "teardown": {"duration": 0.00012327171862125397, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_tree_prefix_error", "lineno": 904, "outcome": "passed", "keywords": ["test_tree_prefix_error", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018429197371006012, "outcome": "passed"}, "call": {"duration": 0.002103656530380249, "outcome": "passed"}, "teardown": {"duration": 8.513592183589935e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_vma_out_specs_error_check", "lineno": 1482, "outcome": "passed", "keywords": ["test_vma_out_specs_error_check", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001512039452791214, "outcome": "passed"}, "call": {"duration": 0.42861283104866743, "outcome": "passed"}, "teardown": {"duration": 0.0001270575448870659, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_vmap_basic", "lineno": 874, "outcome": "passed", "keywords": ["test_vmap_basic", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019077211618423462, "outcome": "passed"}, "call": {"duration": 0.7524734046310186, "outcome": "passed"}, "teardown": {"duration": 0.0002523530274629593, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_vmap_basic_axis_name", "lineno": 884, "outcome": "passed", "keywords": ["test_vmap_basic_axis_name", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004067812114953995, "outcome": "passed"}, "call": {"duration": 0.18306424468755722, "outcome": "passed"}, "teardown": {"duration": 0.00012420397251844406, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_vmap_basic_axis_name_reuse_mesh_name", "lineno": 894, "outcome": "passed", "keywords": ["test_vmap_basic_axis_name_reuse_mesh_name", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019848346710205078, "outcome": "passed"}, "call": {"duration": 0.14972828049212694, "outcome": "passed"}, "teardown": {"duration": 0.00012566614896059036, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_vmap_explicit_mesh_axis", "lineno": 1125, "outcome": "passed", "keywords": ["test_vmap_explicit_mesh_axis", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001877080649137497, "outcome": "passed"}, "call": {"duration": 0.34741911571472883, "outcome": "passed"}, "teardown": {"duration": 0.00024535227566957474, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_vmap_explicit_mesh_axis_error", "lineno": 1152, "outcome": "passed", "keywords": ["test_vmap_explicit_mesh_axis_error", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004026247188448906, "outcome": "passed"}, "call": {"duration": 0.006420552730560303, "outcome": "passed"}, "teardown": {"duration": 0.00019460730254650116, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_vmap_explicit_mesh_axis_single_axis", "lineno": 1539, "outcome": "passed", "keywords": ["test_vmap_explicit_mesh_axis_single_axis", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00036921538412570953, "outcome": "passed"}, "call": {"duration": 0.40528592839837074, "outcome": "passed"}, "teardown": {"duration": 0.0002447711303830147, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_vmap_grad_remat_shmap_spmd_axis_name_residuals", "lineno": 3283, "outcome": "passed", "keywords": ["test_vmap_grad_remat_shmap_spmd_axis_name_residuals", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004024738445878029, "outcome": "passed"}, "call": {"duration": 2.1895746113732457, "outcome": "passed"}, "teardown": {"duration": 0.00013223476707935333, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_vmap_grad_shmap_spmd_axis_name_residuals", "lineno": 3271, "outcome": "passed", "keywords": ["test_vmap_grad_shmap_spmd_axis_name_residuals", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001906324177980423, "outcome": "passed"}, "call": {"duration": 0.8685013027861714, "outcome": "passed"}, "teardown": {"duration": 0.00012749899178743362, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_vmap_of_grad_spmd_axis_name", "lineno": 1176, "outcome": "passed", "keywords": ["test_vmap_of_grad_spmd_axis_name", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019592978060245514, "outcome": "passed"}, "call": {"duration": 3.9588684355840087, "outcome": "passed"}, "teardown": {"duration": 0.00013237539678812027, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_vmap_spmd_axis_name", "lineno": 1110, "outcome": "passed", "keywords": ["test_vmap_spmd_axis_name", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019538961350917816, "outcome": "passed"}, "call": {"duration": 0.0018821395933628082, "outcome": "passed"}, "teardown": {"duration": 8.069910109043121e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_vmap_spmd_axis_name_error", "lineno": 3349, "outcome": "passed", "keywords": ["test_vmap_spmd_axis_name_error", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00014726724475622177, "outcome": "passed"}, "call": {"duration": 0.10488455183804035, "outcome": "passed"}, "teardown": {"duration": 0.00012590549886226654, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_vmap_spmd_axis_name_pair", "lineno": 1196, "outcome": "passed", "keywords": ["test_vmap_spmd_axis_name_pair", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018897932022809982, "outcome": "passed"}, "call": {"duration": 0.0017771748825907707, "outcome": "passed"}, "teardown": {"duration": 8.197128772735596e-05, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_while_rep_rule", "lineno": 1561, "outcome": "passed", "keywords": ["test_while_rep_rule", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00015252456068992615, "outcome": "passed"}, "call": {"duration": 3.144340915605426, "outcome": "passed"}, "teardown": {"duration": 0.00012661702930927277, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapTest::test_with_static_arg", "lineno": 191, "outcome": "passed", "keywords": ["test_with_static_arg", "ShardMapTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019518937915563583, "outcome": "passed"}, "call": {"duration": 0.3901946600526571, "outcome": "passed"}, "teardown": {"duration": 0.00016013719141483307, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_eager_against_ref0", "lineno": 4437, "outcome": "passed", "keywords": ["test_eager_against_ref0", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00023403484374284744, "outcome": "passed"}, "call": {"duration": 2.0508261639624834, "outcome": "passed"}, "teardown": {"duration": 0.0002535032108426094, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_eager_against_ref1", "lineno": 4437, "outcome": "passed", "keywords": ["test_eager_against_ref1", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004031965509057045, "outcome": "passed"}, "call": {"duration": 2.5925492346286774, "outcome": "passed"}, "teardown": {"duration": 0.00024894624948501587, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_eager_against_ref2", "lineno": 4437, "outcome": "passed", "keywords": ["test_eager_against_ref2", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004090042784810066, "outcome": "passed"}, "call": {"duration": 1.243702138774097, "outcome": "passed"}, "teardown": {"duration": 0.0002321125939488411, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_eager_against_ref3", "lineno": 4437, "outcome": "passed", "keywords": ["test_eager_against_ref3", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00038682110607624054, "outcome": "passed"}, "call": {"duration": 1.9882048796862364, "outcome": "passed"}, "teardown": {"duration": 0.0002459632232785225, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_eager_against_ref4", "lineno": 4437, "outcome": "passed", "keywords": ["test_eager_against_ref4", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003947624936699867, "outcome": "passed"}, "call": {"duration": 2.510154575109482, "outcome": "passed"}, "teardown": {"duration": 0.00014492403715848923, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_eager_against_ref5", "lineno": 4437, "outcome": "passed", "keywords": ["test_eager_against_ref5", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019252486526966095, "outcome": "passed"}, "call": {"duration": 0.9029630469158292, "outcome": "passed"}, "teardown": {"duration": 0.00025260262191295624, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_eager_against_ref6", "lineno": 4437, "outcome": "passed", "keywords": ["test_eager_against_ref6", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00040093157440423965, "outcome": "passed"}, "call": {"duration": 1.3559470595791936, "outcome": "passed"}, "teardown": {"duration": 0.00024160649627447128, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_eager_against_ref7", "lineno": 4437, "outcome": "passed", "keywords": ["test_eager_against_ref7", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004135407507419586, "outcome": "passed"}, "call": {"duration": 0.5720370002090931, "outcome": "passed"}, "teardown": {"duration": 0.00024618394672870636, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_eager_against_ref8", "lineno": 4437, "outcome": "passed", "keywords": ["test_eager_against_ref8", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004040570929646492, "outcome": "passed"}, "call": {"duration": 1.1035219682380557, "outcome": "passed"}, "teardown": {"duration": 0.00024378951638936996, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_eager_against_ref9", "lineno": 4437, "outcome": "passed", "keywords": ["test_eager_against_ref9", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004184488207101822, "outcome": "passed"}, "call": {"duration": 0.09895223006606102, "outcome": "passed"}, "teardown": {"duration": 0.00012361258268356323, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads0", "lineno": 4457, "outcome": "passed", "keywords": ["test_grads0", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018262024968862534, "outcome": "passed"}, "call": {"duration": 22.93454597890377, "outcome": "passed"}, "teardown": {"duration": 0.00012740865349769592, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads1", "lineno": 4457, "outcome": "passed", "keywords": ["test_grads1", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0002947654575109482, "outcome": "passed"}, "call": {"duration": 17.61402569618076, "outcome": "passed"}, "teardown": {"duration": 0.00012664776295423508, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads10", "lineno": 4457, "outcome": "passed", "keywords": ["test_grads10", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019368622452020645, "outcome": "passed"}, "call": {"duration": 2.9811747493222356, "outcome": "passed"}, "teardown": {"duration": 0.00012420397251844406, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads11", "lineno": 4457, "outcome": "passed", "keywords": ["test_grads11", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.000192984938621521, "outcome": "passed"}, "call": {"duration": 2.0759168174117804, "outcome": "passed"}, "teardown": {"duration": 0.0001250840723514557, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads12", "lineno": 4457, "outcome": "passed", "keywords": ["test_grads12", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019321590662002563, "outcome": "passed"}, "call": {"duration": 1.9177808398380876, "outcome": "passed"}, "teardown": {"duration": 0.00012816023081541061, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads13", "lineno": 4457, "outcome": "passed", "keywords": ["test_grads13", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001911921426653862, "outcome": "passed"}, "call": {"duration": 0.4786805808544159, "outcome": "passed"}, "teardown": {"duration": 0.00012993160635232925, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads14", "lineno": 4457, "outcome": "passed", "keywords": ["test_grads14", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019226409494876862, "outcome": "passed"}, "call": {"duration": 1.2589735751971602, "outcome": "passed"}, "teardown": {"duration": 0.00012247171252965927, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads15", "lineno": 4457, "outcome": "passed", "keywords": ["test_grads15", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018851738423109055, "outcome": "passed"}, "call": {"duration": 0.23410786781460047, "outcome": "passed"}, "teardown": {"duration": 0.00012327264994382858, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads16", "lineno": 4457, "outcome": "passed", "keywords": ["test_grads16", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001879679039120674, "outcome": "passed"}, "call": {"duration": 13.116073579527438, "outcome": "passed"}, "teardown": {"duration": 0.00012910086661577225, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads17", "lineno": 4457, "outcome": "passed", "keywords": ["test_grads17", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019506923854351044, "outcome": "passed"}, "call": {"duration": 7.823910130187869, "outcome": "passed"}, "teardown": {"duration": 0.00012213923037052155, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads18", "lineno": 4457, "outcome": "passed", "keywords": ["test_grads18", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019335467368364334, "outcome": "passed"}, "call": {"duration": 3.643970124423504, "outcome": "passed"}, "teardown": {"duration": 0.00012427382171154022, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads19", "lineno": 4457, "outcome": "passed", "keywords": ["test_grads19", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019705109298229218, "outcome": "passed"}, "call": {"duration": 3.471836633980274, "outcome": "passed"}, "teardown": {"duration": 0.00012336205691099167, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads2", "lineno": 4457, "outcome": "passed", "keywords": ["test_grads2", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019831303507089615, "outcome": "passed"}, "call": {"duration": 4.407279530540109, "outcome": "passed"}, "teardown": {"duration": 0.0001349886879324913, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads3", "lineno": 4457, "outcome": "passed", "keywords": ["test_grads3", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019231438636779785, "outcome": "passed"}, "call": {"duration": 2.996958007104695, "outcome": "passed"}, "teardown": {"duration": 0.00033592619001865387, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads4", "lineno": 4457, "outcome": "passed", "keywords": ["test_grads4", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019052159041166306, "outcome": "passed"}, "call": {"duration": 3.587974269874394, "outcome": "passed"}, "teardown": {"duration": 0.00012817978858947754, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads5", "lineno": 4457, "outcome": "passed", "keywords": ["test_grads5", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001972215250134468, "outcome": "passed"}, "call": {"duration": 2.970789118669927, "outcome": "passed"}, "teardown": {"duration": 0.00012612715363502502, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads6", "lineno": 4457, "outcome": "passed", "keywords": ["test_grads6", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019589904695749283, "outcome": "passed"}, "call": {"duration": 20.667973583564162, "outcome": "passed"}, "teardown": {"duration": 0.0001279488205909729, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads7", "lineno": 4457, "outcome": "passed", "keywords": ["test_grads7", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019642990082502365, "outcome": "passed"}, "call": {"duration": 14.225724168121815, "outcome": "passed"}, "teardown": {"duration": 0.00012563634663820267, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads8", "lineno": 4457, "outcome": "passed", "keywords": ["test_grads8", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019730255007743835, "outcome": "passed"}, "call": {"duration": 20.76485682465136, "outcome": "passed"}, "teardown": {"duration": 0.00012557487934827805, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads9", "lineno": 4457, "outcome": "passed", "keywords": ["test_grads9", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019389577209949493, "outcome": "passed"}, "call": {"duration": 13.68362617213279, "outcome": "passed"}, "teardown": {"duration": 0.00012306217104196548, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads_closure0", "lineno": 4473, "outcome": "passed", "keywords": ["test_grads_closure0", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019506830722093582, "outcome": "passed"}, "call": {"duration": 38.02891547884792, "outcome": "passed"}, "teardown": {"duration": 0.00012588687241077423, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads_closure1", "lineno": 4473, "outcome": "passed", "keywords": ["test_grads_closure1", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019300449639558792, "outcome": "passed"}, "call": {"duration": 5.575843480415642, "outcome": "passed"}, "teardown": {"duration": 0.0002448810264468193, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads_closure2", "lineno": 4473, "outcome": "passed", "keywords": ["test_grads_closure2", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00040236394852399826, "outcome": "passed"}, "call": {"duration": 7.563696006312966, "outcome": "passed"}, "teardown": {"duration": 0.00012778770178556442, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads_closure3", "lineno": 4473, "outcome": "passed", "keywords": ["test_grads_closure3", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001945970579981804, "outcome": "passed"}, "call": {"duration": 20.85452503338456, "outcome": "passed"}, "teardown": {"duration": 0.0001233220100402832, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads_closure4", "lineno": 4473, "outcome": "passed", "keywords": ["test_grads_closure4", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019363593310117722, "outcome": "passed"}, "call": {"duration": 24.333960947580636, "outcome": "passed"}, "teardown": {"duration": 0.00012277159839868546, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads_closure5", "lineno": 4473, "outcome": "passed", "keywords": ["test_grads_closure5", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019275397062301636, "outcome": "passed"}, "call": {"duration": 7.1783177917823195, "outcome": "passed"}, "teardown": {"duration": 0.00012497417628765106, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads_closure6", "lineno": 4473, "outcome": "passed", "keywords": ["test_grads_closure6", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00020145811140537262, "outcome": "passed"}, "call": {"duration": 3.4276369344443083, "outcome": "passed"}, "teardown": {"duration": 0.00013024266809225082, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads_closure7", "lineno": 4473, "outcome": "passed", "keywords": ["test_grads_closure7", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019989535212516785, "outcome": "passed"}, "call": {"duration": 2.8261459786444902, "outcome": "passed"}, "teardown": {"duration": 0.00012122932821512222, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads_closure8", "lineno": 4473, "outcome": "passed", "keywords": ["test_grads_closure8", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018913857638835907, "outcome": "passed"}, "call": {"duration": 12.382385886274278, "outcome": "passed"}, "teardown": {"duration": 0.0001263059675693512, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_grads_closure9", "lineno": 4473, "outcome": "passed", "keywords": ["test_grads_closure9", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019424688071012497, "outcome": "passed"}, "call": {"duration": 10.992592915892601, "outcome": "passed"}, "teardown": {"duration": 0.00012486334890127182, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_jit_against_ref0", "lineno": 4447, "outcome": "passed", "keywords": ["test_jit_against_ref0", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019508786499500275, "outcome": "passed"}, "call": {"duration": 0.18423254415392876, "outcome": "passed"}, "teardown": {"duration": 0.00012703705579042435, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_jit_against_ref1", "lineno": 4447, "outcome": "passed", "keywords": ["test_jit_against_ref1", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019171275198459625, "outcome": "passed"}, "call": {"duration": 0.06106983218342066, "outcome": "passed"}, "teardown": {"duration": 0.00012436416000127792, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_jit_against_ref2", "lineno": 4447, "outcome": "passed", "keywords": ["test_jit_against_ref2", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018571410328149796, "outcome": "passed"}, "call": {"duration": 0.02261699177324772, "outcome": "passed"}, "teardown": {"duration": 0.00011753477156162262, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_jit_against_ref3", "lineno": 4447, "outcome": "passed", "keywords": ["test_jit_against_ref3", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018855929374694824, "outcome": "passed"}, "call": {"duration": 0.2130451463162899, "outcome": "passed"}, "teardown": {"duration": 0.00023736059665679932, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_jit_against_ref4", "lineno": 4447, "outcome": "passed", "keywords": ["test_jit_against_ref4", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018963031470775604, "outcome": "passed"}, "call": {"duration": 0.21821017377078533, "outcome": "passed"}, "teardown": {"duration": 0.00020455196499824524, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_jit_against_ref5", "lineno": 4447, "outcome": "passed", "keywords": ["test_jit_against_ref5", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00039024557918310165, "outcome": "passed"}, "call": {"duration": 0.03505459148436785, "outcome": "passed"}, "teardown": {"duration": 0.00022125709801912308, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_jit_against_ref6", "lineno": 4447, "outcome": "passed", "keywords": ["test_jit_against_ref6", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003697555512189865, "outcome": "passed"}, "call": {"duration": 0.07734527811408043, "outcome": "passed"}, "teardown": {"duration": 0.00012366194278001785, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_jit_against_ref7", "lineno": 4447, "outcome": "passed", "keywords": ["test_jit_against_ref7", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001811385154724121, "outcome": "passed"}, "call": {"duration": 0.017735411413013935, "outcome": "passed"}, "teardown": {"duration": 0.00010632723569869995, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_jit_against_ref8", "lineno": 4447, "outcome": "passed", "keywords": ["test_jit_against_ref8", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001788642257452011, "outcome": "passed"}, "call": {"duration": 0.025407484732568264, "outcome": "passed"}, "teardown": {"duration": 0.00011712312698364258, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_jit_against_ref9", "lineno": 4447, "outcome": "passed", "keywords": ["test_jit_against_ref9", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018398184329271317, "outcome": "passed"}, "call": {"duration": 0.17105679586529732, "outcome": "passed"}, "teardown": {"duration": 0.00012379325926303864, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap0", "lineno": 4493, "outcome": "passed", "keywords": ["test_vmap0", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001836409792304039, "outcome": "passed"}, "call": {"duration": 2.8830357305705547, "outcome": "passed"}, "teardown": {"duration": 0.0001305835321545601, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap1", "lineno": 4493, "outcome": "passed", "keywords": ["test_vmap1", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.000195198692381382, "outcome": "passed"}, "call": {"duration": 1.0111862635239959, "outcome": "passed"}, "teardown": {"duration": 0.0002104705199599266, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap2", "lineno": 4493, "outcome": "passed", "keywords": ["test_vmap2", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00032778363674879074, "outcome": "passed"}, "call": {"duration": 1.3424659855663776, "outcome": "passed"}, "teardown": {"duration": 0.00025005917996168137, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap3", "lineno": 4493, "outcome": "passed", "keywords": ["test_vmap3", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004154229536652565, "outcome": "passed"}, "call": {"duration": 1.5686222659423947, "outcome": "passed"}, "teardown": {"duration": 0.00012923125177621841, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap4", "lineno": 4493, "outcome": "passed", "keywords": ["test_vmap4", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018773693591356277, "outcome": "passed"}, "call": {"duration": 1.8828951800242066, "outcome": "passed"}, "teardown": {"duration": 0.0001304931938648224, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap5", "lineno": 4493, "outcome": "passed", "keywords": ["test_vmap5", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.000189279206097126, "outcome": "passed"}, "call": {"duration": 1.4258619891479611, "outcome": "passed"}, "teardown": {"duration": 0.0001358911395072937, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap6", "lineno": 4493, "outcome": "passed", "keywords": ["test_vmap6", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018604472279548645, "outcome": "passed"}, "call": {"duration": 1.0063433703035116, "outcome": "passed"}, "teardown": {"duration": 0.00024749618023633957, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap7", "lineno": 4493, "outcome": "passed", "keywords": ["test_vmap7", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00040139351040124893, "outcome": "passed"}, "call": {"duration": 1.4002042952924967, "outcome": "passed"}, "teardown": {"duration": 0.00021177250891923904, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap8", "lineno": 4493, "outcome": "passed", "keywords": ["test_vmap8", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00032632146030664444, "outcome": "passed"}, "call": {"duration": 1.153012851253152, "outcome": "passed"}, "teardown": {"duration": 0.0002505499869585037, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap9", "lineno": 4493, "outcome": "passed", "keywords": ["test_vmap9", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00040186289697885513, "outcome": "passed"}, "call": {"duration": 2.5230439538136125, "outcome": "passed"}, "teardown": {"duration": 0.0002050129696726799, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap_closure0", "lineno": 4516, "outcome": "passed", "keywords": ["test_vmap_closure0", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00032537057995796204, "outcome": "passed"}, "call": {"duration": 4.149270520545542, "outcome": "passed"}, "teardown": {"duration": 0.00021017156541347504, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap_closure1", "lineno": 4516, "outcome": "passed", "keywords": ["test_vmap_closure1", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003314288333058357, "outcome": "passed"}, "call": {"duration": 1.6169771058484912, "outcome": "passed"}, "teardown": {"duration": 0.0001356992870569229, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap_closure2", "lineno": 4516, "outcome": "passed", "keywords": ["test_vmap_closure2", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003269631415605545, "outcome": "passed"}, "call": {"duration": 1.6068327650427818, "outcome": "passed"}, "teardown": {"duration": 0.00021051056683063507, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap_closure3", "lineno": 4516, "outcome": "passed", "keywords": ["test_vmap_closure3", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004356829449534416, "outcome": "passed"}, "call": {"duration": 1.9317322531715035, "outcome": "passed"}, "teardown": {"duration": 0.00025325454771518707, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap_closure4", "lineno": 4516, "outcome": "passed", "keywords": ["test_vmap_closure4", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.000420580618083477, "outcome": "passed"}, "call": {"duration": 1.5757310511544347, "outcome": "passed"}, "teardown": {"duration": 0.0001344885677099228, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap_closure5", "lineno": 4516, "outcome": "passed", "keywords": ["test_vmap_closure5", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019208434969186783, "outcome": "passed"}, "call": {"duration": 1.4666582066565752, "outcome": "passed"}, "teardown": {"duration": 0.0001292908564209938, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap_closure6", "lineno": 4516, "outcome": "passed", "keywords": ["test_vmap_closure6", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019428692758083344, "outcome": "passed"}, "call": {"duration": 1.4888260252773762, "outcome": "passed"}, "teardown": {"duration": 0.00014446303248405457, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap_closure7", "lineno": 4516, "outcome": "passed", "keywords": ["test_vmap_closure7", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004216935485601425, "outcome": "passed"}, "call": {"duration": 2.360542922280729, "outcome": "passed"}, "teardown": {"duration": 0.00020954012870788574, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap_closure8", "lineno": 4516, "outcome": "passed", "keywords": ["test_vmap_closure8", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003295978531241417, "outcome": "passed"}, "call": {"duration": 1.4686458418145776, "outcome": "passed"}, "teardown": {"duration": 0.00013013184070587158, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::ShardMapSystematicTest::test_vmap_closure9", "lineno": 4516, "outcome": "passed", "keywords": ["test_vmap_closure9", "__wrapped__", "__x_params_repr__", "ShardMapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001918841153383255, "outcome": "passed"}, "call": {"duration": 0.6806867131963372, "outcome": "passed"}, "teardown": {"duration": 0.0001611979678273201, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::CustomPartitionerTest::test_custom_partitioning", "lineno": 4562, "outcome": "passed", "keywords": ["test_custom_partitioning", "CustomPartitionerTest", "multiaccelerator", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0002256929874420166, "outcome": "passed"}, "call": {"duration": 0.044804018922150135, "outcome": "passed"}, "teardown": {"duration": 0.00011870451271533966, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::CustomPartitionerTest::test_partially_sharded_dim_with_auto", "lineno": 4609, "outcome": "passed", "keywords": ["test_partially_sharded_dim_with_auto", "CustomPartitionerTest", "multiaccelerator", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019668135792016983, "outcome": "passed"}, "call": {"duration": 0.22598386369645596, "outcome": "passed"}, "teardown": {"duration": 0.0001518242061138153, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::SmapSystematicTest::test_against_ref0", "lineno": 4696, "outcome": "passed", "keywords": ["test_against_ref0", "__wrapped__", "__x_params_repr__", "SmapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00022759567946195602, "outcome": "passed"}, "call": {"duration": 1.3744391119107604, "outcome": "passed"}, "teardown": {"duration": 0.00012863054871559143, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::SmapSystematicTest::test_against_ref1", "lineno": 4696, "outcome": "passed", "keywords": ["test_against_ref1", "__wrapped__", "__x_params_repr__", "SmapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001861443743109703, "outcome": "passed"}, "call": {"duration": 0.039233230985701084, "outcome": "passed"}, "teardown": {"duration": 0.00011956598609685898, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::SmapSystematicTest::test_against_ref2", "lineno": 4696, "outcome": "passed", "keywords": ["test_against_ref2", "__wrapped__", "__x_params_repr__", "SmapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.000185403972864151, "outcome": "passed"}, "call": {"duration": 1.5395319992676377, "outcome": "passed"}, "teardown": {"duration": 0.00024731457233428955, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::SmapSystematicTest::test_against_ref3", "lineno": 4696, "outcome": "passed", "keywords": ["test_against_ref3", "__wrapped__", "__x_params_repr__", "SmapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003987690433859825, "outcome": "passed"}, "call": {"duration": 0.03867524769157171, "outcome": "passed"}, "teardown": {"duration": 0.0001132674515247345, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::SmapSystematicTest::test_against_ref4", "lineno": 4696, "outcome": "passed", "keywords": ["test_against_ref4", "__wrapped__", "__x_params_repr__", "SmapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00017872359603643417, "outcome": "passed"}, "call": {"duration": 1.041903886012733, "outcome": "passed"}, "teardown": {"duration": 0.0002412162721157074, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::SmapSystematicTest::test_against_ref5", "lineno": 4696, "outcome": "passed", "keywords": ["test_against_ref5", "__wrapped__", "__x_params_repr__", "SmapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003899950534105301, "outcome": "passed"}, "call": {"duration": 0.9175733290612698, "outcome": "passed"}, "teardown": {"duration": 0.00026511121541261673, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::SmapSystematicTest::test_against_ref6", "lineno": 4696, "outcome": "passed", "keywords": ["test_against_ref6", "__wrapped__", "__x_params_repr__", "SmapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00043208803981542587, "outcome": "passed"}, "call": {"duration": 0.6824125023558736, "outcome": "passed"}, "teardown": {"duration": 0.00026544276624917984, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::SmapSystematicTest::test_against_ref7", "lineno": 4696, "outcome": "passed", "keywords": ["test_against_ref7", "__wrapped__", "__x_params_repr__", "SmapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004338817670941353, "outcome": "passed"}, "call": {"duration": 0.6154250903055072, "outcome": "passed"}, "teardown": {"duration": 0.00024300813674926758, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::SmapSystematicTest::test_against_ref8", "lineno": 4696, "outcome": "passed", "keywords": ["test_against_ref8", "__wrapped__", "__x_params_repr__", "SmapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00038897525519132614, "outcome": "passed"}, "call": {"duration": 0.05415627174079418, "outcome": "passed"}, "teardown": {"duration": 0.0001955190673470497, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::SmapSystematicTest::test_against_ref9", "lineno": 4696, "outcome": "passed", "keywords": ["test_against_ref9", "__wrapped__", "__x_params_repr__", "SmapSystematicTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00031286198645830154, "outcome": "passed"}, "call": {"duration": 0.7443469688296318, "outcome": "passed"}, "teardown": {"duration": 0.0002875039353966713, "outcome": "passed"}}, {"nodeid": "tests/shard_map_test.py::SdyIntegrationTest::test_shardy_collective_permute", "lineno": 4718, "outcome": "passed", "keywords": ["test_shardy_collective_permute", "SdyIntegrationTest", "shard_map_test.py", "tests", "jax", ""], "setup": {"duration": 0.00047451071441173553, "outcome": "passed"}, "call": {"duration": 0.21055160369724035, "outcome": "passed"}, "teardown": {"duration": 0.0032959170639514923, "outcome": "passed"}}]}