{"created": 1763601587.6332576, "duration": 151.610191822052, "exitcode": 0, "root": "/dockerx/rocm/rocm-jax/jax", "environment": {}, "summary": {"passed": 177, "skipped": 4, "total": 181, "collected": 181}, "collectors": [{"nodeid": "", "outcome": "passed", "result": [{"nodeid": "tests/python_callback_test.py", "type": "Module"}]}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest", "outcome": "passed", "result": [{"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_cond_io_ordered", "type": "TestCaseFunction", "lineno": 447}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_cond_io_unordered", "type": "TestCaseFunction", "lineno": 447}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_cond_of_scalars_io_ordered", "type": "TestCaseFunction", "lineno": 420}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_cond_of_scalars_io_unordered", "type": "TestCaseFunction", "lineno": 420}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_cond_of_scalars_pure", "type": "TestCaseFunction", "lineno": 420}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_cond_pure", "type": "TestCaseFunction", "lineno": 447}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_pmap_io_ordered", "type": "TestCaseFunction", "lineno": 529}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_pmap_io_unordered", "type": "TestCaseFunction", "lineno": 529}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_pmap_of_scalars_io_ordered", "type": "TestCaseFunction", "lineno": 512}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_pmap_of_scalars_io_unordered", "type": "TestCaseFunction", "lineno": 512}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_pmap_of_scalars_pure", "type": "TestCaseFunction", "lineno": 512}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_pmap_pure", "type": "TestCaseFunction", "lineno": 529}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_scan_io_ordered", "type": "TestCaseFunction", "lineno": 493}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_scan_io_unordered", "type": "TestCaseFunction", "lineno": 493}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_scan_of_scalars_io_ordered", "type": "TestCaseFunction", "lineno": 474}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_scan_of_scalars_io_unordered", "type": "TestCaseFunction", "lineno": 474}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_scan_of_scalars_pure", "type": "TestCaseFunction", "lineno": 474}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_scan_pure", "type": "TestCaseFunction", "lineno": 493}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_while_loop_io_ordered", "type": "TestCaseFunction", "lineno": 399}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_while_loop_io_unordered", "type": "TestCaseFunction", "lineno": 399}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_while_loop_of_scalars_io_ordered", "type": "TestCaseFunction", "lineno": 381}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_while_loop_of_scalars_io_unordered", "type": "TestCaseFunction", "lineno": 381}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_while_loop_of_scalars_pure", "type": "TestCaseFunction", "lineno": 381}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_while_loop_pure", "type": "TestCaseFunction", "lineno": 399}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_returning_custom_array_io_ordered", "type": "TestCaseFunction", "lineno": 109}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_returning_custom_array_io_unordered", "type": "TestCaseFunction", "lineno": 109}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_returning_custom_array_pure", "type": "TestCaseFunction", "lineno": 109}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_returning_python_literal_io_ordered_expect_dtype_<class 'numpy.float32'>", "type": "TestCaseFunction", "lineno": 75}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_returning_python_literal_io_ordered_expect_dtype_<class 'numpy.float64'>", "type": "TestCaseFunction", "lineno": 75}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_returning_python_literal_io_ordered_expect_dtype_<class 'numpy.int32'>", "type": "TestCaseFunction", "lineno": 75}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_returning_python_literal_io_ordered_expect_dtype_<class 'numpy.int64'>", "type": "TestCaseFunction", "lineno": 75}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_returning_python_literal_io_unordered_expect_dtype_<class 'numpy.float32'>", "type": "TestCaseFunction", "lineno": 75}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_returning_python_literal_io_unordered_expect_dtype_<class 'numpy.float64'>", "type": "TestCaseFunction", "lineno": 75}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_returning_python_literal_io_unordered_expect_dtype_<class 'numpy.int32'>", "type": "TestCaseFunction", "lineno": 75}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_returning_python_literal_io_unordered_expect_dtype_<class 'numpy.int64'>", "type": "TestCaseFunction", "lineno": 75}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_returning_python_literal_pure_expect_dtype_<class 'numpy.float32'>", "type": "TestCaseFunction", "lineno": 75}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_returning_python_literal_pure_expect_dtype_<class 'numpy.float64'>", "type": "TestCaseFunction", "lineno": 75}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_returning_python_literal_pure_expect_dtype_<class 'numpy.int32'>", "type": "TestCaseFunction", "lineno": 75}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_returning_python_literal_pure_expect_dtype_<class 'numpy.int64'>", "type": "TestCaseFunction", "lineno": 75}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_multiple_arguments_and_return_values_io_ordered", "type": "TestCaseFunction", "lineno": 286}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_multiple_arguments_and_return_values_io_unordered", "type": "TestCaseFunction", "lineno": 286}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_multiple_arguments_and_return_values_pure", "type": "TestCaseFunction", "lineno": 286}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_multiple_return_values_io_ordered", "type": "TestCaseFunction", "lineno": 272}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_multiple_return_values_io_unordered", "type": "TestCaseFunction", "lineno": 272}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_multiple_return_values_pure", "type": "TestCaseFunction", "lineno": 272}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_pytree_arguments_and_return_values_io_ordered", "type": "TestCaseFunction", "lineno": 366}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_pytree_arguments_and_return_values_io_unordered", "type": "TestCaseFunction", "lineno": 366}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_pytree_arguments_and_return_values_pure", "type": "TestCaseFunction", "lineno": 366}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_scalar_values_io_ordered", "type": "TestCaseFunction", "lineno": 66}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_scalar_values_io_unordered", "type": "TestCaseFunction", "lineno": 66}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_scalar_values_pure", "type": "TestCaseFunction", "lineno": 66}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_single_return_value_io_ordered", "type": "TestCaseFunction", "lineno": 260}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_single_return_value_io_unordered", "type": "TestCaseFunction", "lineno": 260}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_single_return_value_pure", "type": "TestCaseFunction", "lineno": 260}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_wrong_dtype_outputs_io_ordered", "type": "TestCaseFunction", "lineno": 226}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_wrong_dtype_outputs_io_unordered", "type": "TestCaseFunction", "lineno": 226}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_wrong_dtype_outputs_pure", "type": "TestCaseFunction", "lineno": 226}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_wrong_number_of_args_io_ordered", "type": "TestCaseFunction", "lineno": 177}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_wrong_number_of_args_io_unordered", "type": "TestCaseFunction", "lineno": 177}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_wrong_number_of_args_pure", "type": "TestCaseFunction", "lineno": 177}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_wrong_number_of_returned_values_io_ordered", "type": "TestCaseFunction", "lineno": 190}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_wrong_number_of_returned_values_io_unordered", "type": "TestCaseFunction", "lineno": 190}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_wrong_number_of_returned_values_pure", "type": "TestCaseFunction", "lineno": 190}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_wrong_shape_outputs_io_ordered", "type": "TestCaseFunction", "lineno": 213}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_wrong_shape_outputs_io_unordered", "type": "TestCaseFunction", "lineno": 213}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_wrong_shape_outputs_pure", "type": "TestCaseFunction", "lineno": 213}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_wrongly_specified_64_bit_dtype_io_ordered", "type": "TestCaseFunction", "lineno": 246}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_wrongly_specified_64_bit_dtype_io_unordered", "type": "TestCaseFunction", "lineno": 246}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_wrongly_specified_64_bit_dtype_pure", "type": "TestCaseFunction", "lineno": 246}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_ordered_<class 'ml_dtypes.bfloat16'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_ordered_<class 'numpy.bool'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_ordered_<class 'numpy.complex64'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_ordered_<class 'numpy.float16'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_ordered_<class 'numpy.float32'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_ordered_<class 'numpy.int16'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_ordered_<class 'numpy.int32'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_ordered_<class 'numpy.int8'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_ordered_<class 'numpy.uint16'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_ordered_<class 'numpy.uint32'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_ordered_<class 'numpy.uint8'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_unordered_<class 'ml_dtypes.bfloat16'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_unordered_<class 'numpy.bool'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_unordered_<class 'numpy.complex64'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_unordered_<class 'numpy.float16'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_unordered_<class 'numpy.float32'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_unordered_<class 'numpy.int16'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_unordered_<class 'numpy.int32'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_unordered_<class 'numpy.int8'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_unordered_<class 'numpy.uint16'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_unordered_<class 'numpy.uint32'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_unordered_<class 'numpy.uint8'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_pure_<class 'ml_dtypes.bfloat16'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_pure_<class 'numpy.bool'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_pure_<class 'numpy.complex64'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_pure_<class 'numpy.float16'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_pure_<class 'numpy.float32'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_pure_<class 'numpy.int16'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_pure_<class 'numpy.int32'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_pure_<class 'numpy.int8'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_pure_<class 'numpy.uint16'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_pure_<class 'numpy.uint32'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_pure_<class 'numpy.uint8'>", "type": "TestCaseFunction", "lineno": 142}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_compilation_caching_io_ordered", "type": "TestCaseFunction", "lineno": 572}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_compilation_caching_io_unordered", "type": "TestCaseFunction", "lineno": 572}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_compilation_caching_pure", "type": "TestCaseFunction", "lineno": 572}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_exception_in_callback_io_ordered", "type": "TestCaseFunction", "lineno": 549}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_exception_in_callback_io_unordered", "type": "TestCaseFunction", "lineno": 549}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_exception_in_callback_pure", "type": "TestCaseFunction", "lineno": 549}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_non_default_stride", "type": "TestCaseFunction", "lineno": 656}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_non_default_stride_subbyte_results0", "type": "TestCaseFunction", "lineno": 636}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_non_default_stride_subbyte_results1", "type": "TestCaseFunction", "lineno": 636}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_non_default_stride_subbyte_results2", "type": "TestCaseFunction", "lineno": 636}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_non_default_stride_subbyte_results3", "type": "TestCaseFunction", "lineno": 636}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_non_default_stride_subbyte_results4", "type": "TestCaseFunction", "lineno": 636}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_pure_callback_sequential_vmap_method_eval_jaxpr", "type": "TestCaseFunction", "lineno": 606}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_recv_zero_dim_and_non_zero_dim_arrays_io_ordered", "type": "TestCaseFunction", "lineno": 345}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_recv_zero_dim_and_non_zero_dim_arrays_io_unordered", "type": "TestCaseFunction", "lineno": 345}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_recv_zero_dim_and_non_zero_dim_arrays_pure", "type": "TestCaseFunction", "lineno": 345}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_recv_zero_dim_arrays_io_ordered", "type": "TestCaseFunction", "lineno": 331}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_recv_zero_dim_arrays_io_unordered", "type": "TestCaseFunction", "lineno": 331}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_recv_zero_dim_arrays_pure", "type": "TestCaseFunction", "lineno": 331}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_send_zero_dim_and_non_zero_dim_arrays_io_ordered", "type": "TestCaseFunction", "lineno": 316}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_send_zero_dim_and_non_zero_dim_arrays_io_unordered", "type": "TestCaseFunction", "lineno": 316}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_send_zero_dim_and_non_zero_dim_arrays_pure", "type": "TestCaseFunction", "lineno": 316}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_send_zero_dim_arrays_io_ordered", "type": "TestCaseFunction", "lineno": 302}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_send_zero_dim_arrays_io_unordered", "type": "TestCaseFunction", "lineno": 302}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_send_zero_dim_arrays_pure", "type": "TestCaseFunction", "lineno": 302}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_subbyte_operands0", "type": "TestCaseFunction", "lineno": 587}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_subbyte_operands1", "type": "TestCaseFunction", "lineno": 587}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_subbyte_operands2", "type": "TestCaseFunction", "lineno": 587}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_subbyte_operands3", "type": "TestCaseFunction", "lineno": 587}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_subbyte_operands4", "type": "TestCaseFunction", "lineno": 587}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_subbyte_results0", "type": "TestCaseFunction", "lineno": 617}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_subbyte_results1", "type": "TestCaseFunction", "lineno": 617}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_subbyte_results2", "type": "TestCaseFunction", "lineno": 617}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_subbyte_results3", "type": "TestCaseFunction", "lineno": 617}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_subbyte_results4", "type": "TestCaseFunction", "lineno": 617}]}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest", "outcome": "passed", "result": [{"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_array_layout_is_preserved", "type": "TestCaseFunction", "lineno": 973}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_async_deadlock", "type": "TestCaseFunction", "lineno": 1103}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_callback_inside_of_cond", "type": "TestCaseFunction", "lineno": 874}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_callback_inside_of_pmap", "type": "TestCaseFunction", "lineno": 938}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_callback_inside_of_scan", "type": "TestCaseFunction", "lineno": 898}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_callback_inside_of_while_loop", "type": "TestCaseFunction", "lineno": 915}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_callback_with_immediate_executable_destruction", "type": "TestCaseFunction", "lineno": 954}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_can_dce_pure_callback", "type": "TestCaseFunction", "lineno": 692}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_can_pmap_pure_callback", "type": "TestCaseFunction", "lineno": 811}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_can_shard_pure_callback_manually", "type": "TestCaseFunction", "lineno": 1038}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_can_shard_pure_callback_maximally", "type": "TestCaseFunction", "lineno": 981}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_can_shard_pure_callback_maximally_with_sharding", "type": "TestCaseFunction", "lineno": 1000}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_can_take_grad_of_pure_callback_with_custom_jvp", "type": "TestCaseFunction", "lineno": 856}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_can_vmap_pure_callback", "type": "TestCaseFunction", "lineno": 710}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_cant_take_grad_of_pure_callback", "type": "TestCaseFunction", "lineno": 819}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_does_not_deadlock", "type": "TestCaseFunction", "lineno": 1060}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_error_propagation", "type": "TestCaseFunction", "lineno": 832}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_pure_callback_fastpath", "type": "TestCaseFunction", "lineno": 1127}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_pure_callback_passes_jax_arrays_without_jit", "type": "TestCaseFunction", "lineno": 682}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_reentrant_error_propagation", "type": "TestCaseFunction", "lineno": 843}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_vmap_method_broadcast_all", "type": "TestCaseFunction", "lineno": 1091}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_vmap_method_expand_dims", "type": "TestCaseFunction", "lineno": 1080}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_vmap_method_raise", "type": "TestCaseFunction", "lineno": 1072}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_vmap_vectorized_callback", "type": "TestCaseFunction", "lineno": 756}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_vmap_vectorized_callback_errors_if_returns_wrong_shape", "type": "TestCaseFunction", "lineno": 796}]}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest", "outcome": "passed", "result": [{"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_batching_with_side_effects", "type": "TestCaseFunction", "lineno": 1426}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_batching_with_side_effects_while_loop", "type": "TestCaseFunction", "lineno": 1442}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_can_shard_io_callback_manually_multi_device", "type": "TestCaseFunction", "lineno": 1387}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_can_shard_io_callback_manually_single_device", "type": "TestCaseFunction", "lineno": 1387}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_can_use_io_callback_in_pjit_ordered=False_with_sharding=False", "type": "TestCaseFunction", "lineno": 1262}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_can_use_io_callback_in_pjit_ordered=False_with_sharding=True", "type": "TestCaseFunction", "lineno": 1262}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_can_use_io_callback_in_pjit_ordered=True_with_sharding=False", "type": "TestCaseFunction", "lineno": 1262}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_can_use_io_callback_in_pjit_ordered=True_with_sharding=True", "type": "TestCaseFunction", "lineno": 1262}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_cannot_call_ordered_io_in_pmap", "type": "TestCaseFunction", "lineno": 1184}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_cannot_call_ordered_io_in_vmap", "type": "TestCaseFunction", "lineno": 1194}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_cannot_use_io_callback_in_checkpoint", "type": "TestCaseFunction", "lineno": 1251}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_cannot_use_io_callback_in_jvp", "type": "TestCaseFunction", "lineno": 1202}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_cannot_use_io_callback_in_linearize", "type": "TestCaseFunction", "lineno": 1209}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_cannot_use_io_callback_in_transpose", "type": "TestCaseFunction", "lineno": 1216}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_cannot_vmap_of_cond_io_callback", "type": "TestCaseFunction", "lineno": 1225}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_cannot_vmap_of_while_io_callback", "type": "TestCaseFunction", "lineno": 1236}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_io_callback_can_be_batched_if_unordered", "type": "TestCaseFunction", "lineno": 1167}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_io_callback_can_mutate_state", "type": "TestCaseFunction", "lineno": 1151}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_sequence_pjit_io_callback_ordered", "type": "TestCaseFunction", "lineno": 1333}]}, {"nodeid": "tests/python_callback_test.py", "outcome": "passed", "result": [{"nodeid": "tests/python_callback_test.py::PythonCallbackTest", "type": "UnitTestCase"}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest", "type": "UnitTestCase"}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest", "type": "UnitTestCase"}]}], "tests": [{"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_cond_io_ordered", "lineno": 447, "outcome": "passed", "keywords": ["test_callback_inside_of_cond_io_ordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003354456275701523, "outcome": "passed"}, "call": {"duration": 1.9011689312756062, "outcome": "passed"}, "teardown": {"duration": 0.00027080997824668884, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_cond_io_unordered", "lineno": 447, "outcome": "passed", "keywords": ["test_callback_inside_of_cond_io_unordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00042762234807014465, "outcome": "passed"}, "call": {"duration": 0.15668830648064613, "outcome": "passed"}, "teardown": {"duration": 0.00014358200132846832, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_cond_of_scalars_io_ordered", "lineno": 420, "outcome": "passed", "keywords": ["test_callback_inside_of_cond_of_scalars_io_ordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.000194416381418705, "outcome": "passed"}, "call": {"duration": 0.3124320534989238, "outcome": "passed"}, "teardown": {"duration": 0.0002355482429265976, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_cond_of_scalars_io_unordered", "lineno": 420, "outcome": "passed", "keywords": ["test_callback_inside_of_cond_of_scalars_io_unordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003952542319893837, "outcome": "passed"}, "call": {"duration": 0.1552469963207841, "outcome": "passed"}, "teardown": {"duration": 0.00012088846415281296, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_cond_of_scalars_pure", "lineno": 420, "outcome": "passed", "keywords": ["test_callback_inside_of_cond_of_scalars_pure", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019094161689281464, "outcome": "passed"}, "call": {"duration": 0.026327021420001984, "outcome": "passed"}, "teardown": {"duration": 0.00011064298450946808, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_cond_pure", "lineno": 447, "outcome": "passed", "keywords": ["test_callback_inside_of_cond_pure", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001826900988817215, "outcome": "passed"}, "call": {"duration": 0.02679124753922224, "outcome": "passed"}, "teardown": {"duration": 0.00011350680142641068, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_pmap_io_ordered", "lineno": 529, "outcome": "skipped", "keywords": ["test_callback_inside_of_pmap_io_ordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00017729122191667557, "outcome": "passed"}, "call": {"duration": 0.0004129800945520401, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py', 530, 'Skipped: N/A')"}, "teardown": {"duration": 8.904095739126205e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_pmap_io_unordered", "lineno": 529, "outcome": "passed", "keywords": ["test_callback_inside_of_pmap_io_unordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001462157815694809, "outcome": "passed"}, "call": {"duration": 8.72703192383051, "outcome": "passed"}, "teardown": {"duration": 0.00024541281163692474, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_pmap_of_scalars_io_ordered", "lineno": 512, "outcome": "skipped", "keywords": ["test_callback_inside_of_pmap_of_scalars_io_ordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004003923386335373, "outcome": "passed"}, "call": {"duration": 0.0008730906993150711, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py', 513, 'Skipped: N/A')"}, "teardown": {"duration": 0.0001867758110165596, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_pmap_of_scalars_io_unordered", "lineno": 512, "outcome": "passed", "keywords": ["test_callback_inside_of_pmap_of_scalars_io_unordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003339843824505806, "outcome": "passed"}, "call": {"duration": 0.3214285233989358, "outcome": "passed"}, "teardown": {"duration": 0.00012457463890314102, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_pmap_of_scalars_pure", "lineno": 512, "outcome": "passed", "keywords": ["test_callback_inside_of_pmap_of_scalars_pure", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019859429448843002, "outcome": "passed"}, "call": {"duration": 0.08691162802278996, "outcome": "passed"}, "teardown": {"duration": 0.00019653048366308212, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_pmap_pure", "lineno": 529, "outcome": "passed", "keywords": ["test_callback_inside_of_pmap_pure", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003240387886762619, "outcome": "passed"}, "call": {"duration": 0.04982300940901041, "outcome": "passed"}, "teardown": {"duration": 0.0001829005777835846, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_scan_io_ordered", "lineno": 493, "outcome": "passed", "keywords": ["test_callback_inside_of_scan_io_ordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00033111870288848877, "outcome": "passed"}, "call": {"duration": 0.4048219723626971, "outcome": "passed"}, "teardown": {"duration": 0.00023764092475175858, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_scan_io_unordered", "lineno": 493, "outcome": "passed", "keywords": ["test_callback_inside_of_scan_io_unordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00039306003600358963, "outcome": "passed"}, "call": {"duration": 0.1731869662180543, "outcome": "passed"}, "teardown": {"duration": 0.00012271199375391006, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_scan_of_scalars_io_ordered", "lineno": 474, "outcome": "passed", "keywords": ["test_callback_inside_of_scan_of_scalars_io_ordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019180215895175934, "outcome": "passed"}, "call": {"duration": 0.14206369034945965, "outcome": "passed"}, "teardown": {"duration": 0.00012436416000127792, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_scan_of_scalars_io_unordered", "lineno": 474, "outcome": "passed", "keywords": ["test_callback_inside_of_scan_of_scalars_io_unordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019324477761983871, "outcome": "passed"}, "call": {"duration": 0.14721548091620207, "outcome": "passed"}, "teardown": {"duration": 0.0001287302002310753, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_scan_of_scalars_pure", "lineno": 474, "outcome": "passed", "keywords": ["test_callback_inside_of_scan_of_scalars_pure", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019079260528087616, "outcome": "passed"}, "call": {"duration": 0.03398312069475651, "outcome": "passed"}, "teardown": {"duration": 0.00010991189628839493, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_scan_pure", "lineno": 493, "outcome": "passed", "keywords": ["test_callback_inside_of_scan_pure", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00022889859974384308, "outcome": "passed"}, "call": {"duration": 0.033230328001081944, "outcome": "passed"}, "teardown": {"duration": 0.00011276639997959137, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_while_loop_io_ordered", "lineno": 399, "outcome": "passed", "keywords": ["test_callback_inside_of_while_loop_io_ordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018040649592876434, "outcome": "passed"}, "call": {"duration": 0.4072936540469527, "outcome": "passed"}, "teardown": {"duration": 0.00023403577506542206, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_while_loop_io_unordered", "lineno": 399, "outcome": "passed", "keywords": ["test_callback_inside_of_while_loop_io_unordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003995494917035103, "outcome": "passed"}, "call": {"duration": 0.16669707838445902, "outcome": "passed"}, "teardown": {"duration": 0.00019849278032779694, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_while_loop_of_scalars_io_ordered", "lineno": 381, "outcome": "passed", "keywords": ["test_callback_inside_of_while_loop_of_scalars_io_ordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00033393409103155136, "outcome": "passed"}, "call": {"duration": 0.15367853827774525, "outcome": "passed"}, "teardown": {"duration": 0.0001947479322552681, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_while_loop_of_scalars_io_unordered", "lineno": 381, "outcome": "passed", "keywords": ["test_callback_inside_of_while_loop_of_scalars_io_unordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003230879083275795, "outcome": "passed"}, "call": {"duration": 0.15199644211679697, "outcome": "passed"}, "teardown": {"duration": 0.00013000145554542542, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_while_loop_of_scalars_pure", "lineno": 381, "outcome": "passed", "keywords": ["test_callback_inside_of_while_loop_of_scalars_pure", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019021052867174149, "outcome": "passed"}, "call": {"duration": 0.025968712754547596, "outcome": "passed"}, "teardown": {"duration": 0.00010982155799865723, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_inside_of_while_loop_pure", "lineno": 399, "outcome": "passed", "keywords": ["test_callback_inside_of_while_loop_pure", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00017980672419071198, "outcome": "passed"}, "call": {"duration": 0.028505198657512665, "outcome": "passed"}, "teardown": {"duration": 0.00011234637349843979, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_returning_custom_array_io_ordered", "lineno": 109, "outcome": "passed", "keywords": ["test_callback_returning_custom_array_io_ordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001832917332649231, "outcome": "passed"}, "call": {"duration": 0.12265004217624664, "outcome": "passed"}, "teardown": {"duration": 0.00012125913053750992, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_returning_custom_array_io_unordered", "lineno": 109, "outcome": "passed", "keywords": ["test_callback_returning_custom_array_io_unordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018935836851596832, "outcome": "passed"}, "call": {"duration": 0.015346010215580463, "outcome": "passed"}, "teardown": {"duration": 9.884685277938843e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_returning_custom_array_pure", "lineno": 109, "outcome": "passed", "keywords": ["test_callback_returning_custom_array_pure", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00016867928206920624, "outcome": "passed"}, "call": {"duration": 0.01393882092088461, "outcome": "passed"}, "teardown": {"duration": 9.840447455644608e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_returning_python_literal_io_ordered_expect_dtype_<class 'numpy.float32'>", "lineno": 75, "outcome": "passed", "keywords": ["test_callback_returning_python_literal_io_ordered_expect_dtype_<class 'numpy.float32'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00016801711171865463, "outcome": "passed"}, "call": {"duration": 0.01406177133321762, "outcome": "passed"}, "teardown": {"duration": 9.757466614246368e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_returning_python_literal_io_ordered_expect_dtype_<class 'numpy.float64'>", "lineno": 75, "outcome": "passed", "keywords": ["test_callback_returning_python_literal_io_ordered_expect_dtype_<class 'numpy.float64'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00016456376761198044, "outcome": "passed"}, "call": {"duration": 0.001680753193795681, "outcome": "passed"}, "teardown": {"duration": 8.137989789247513e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_returning_python_literal_io_ordered_expect_dtype_<class 'numpy.int32'>", "lineno": 75, "outcome": "passed", "keywords": ["test_callback_returning_python_literal_io_ordered_expect_dtype_<class 'numpy.int32'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00014283135533332825, "outcome": "passed"}, "call": {"duration": 0.24996035639196634, "outcome": "passed"}, "teardown": {"duration": 0.00021263398230075836, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_returning_python_literal_io_ordered_expect_dtype_<class 'numpy.int64'>", "lineno": 75, "outcome": "passed", "keywords": ["test_callback_returning_python_literal_io_ordered_expect_dtype_<class 'numpy.int64'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00038881413638591766, "outcome": "passed"}, "call": {"duration": 0.001893085427582264, "outcome": "passed"}, "teardown": {"duration": 0.0002029305323958397, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_returning_python_literal_io_unordered_expect_dtype_<class 'numpy.float32'>", "lineno": 75, "outcome": "passed", "keywords": ["test_callback_returning_python_literal_io_unordered_expect_dtype_<class 'numpy.float32'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003309287130832672, "outcome": "passed"}, "call": {"duration": 0.027581614442169666, "outcome": "passed"}, "teardown": {"duration": 0.0002112528309226036, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_returning_python_literal_io_unordered_expect_dtype_<class 'numpy.float64'>", "lineno": 75, "outcome": "passed", "keywords": ["test_callback_returning_python_literal_io_unordered_expect_dtype_<class 'numpy.float64'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003656800836324692, "outcome": "passed"}, "call": {"duration": 0.0017283335328102112, "outcome": "passed"}, "teardown": {"duration": 0.00017847400158643723, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_returning_python_literal_io_unordered_expect_dtype_<class 'numpy.int32'>", "lineno": 75, "outcome": "passed", "keywords": ["test_callback_returning_python_literal_io_unordered_expect_dtype_<class 'numpy.int32'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00032978784292936325, "outcome": "passed"}, "call": {"duration": 0.12826579716056585, "outcome": "passed"}, "teardown": {"duration": 0.00011999718844890594, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_returning_python_literal_io_unordered_expect_dtype_<class 'numpy.int64'>", "lineno": 75, "outcome": "passed", "keywords": ["test_callback_returning_python_literal_io_unordered_expect_dtype_<class 'numpy.int64'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00020212959498167038, "outcome": "passed"}, "call": {"duration": 0.0013078516349196434, "outcome": "passed"}, "teardown": {"duration": 0.0001848926767706871, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_returning_python_literal_pure_expect_dtype_<class 'numpy.float32'>", "lineno": 75, "outcome": "passed", "keywords": ["test_callback_returning_python_literal_pure_expect_dtype_<class 'numpy.float32'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00033404305577278137, "outcome": "passed"}, "call": {"duration": 0.02713286131620407, "outcome": "passed"}, "teardown": {"duration": 0.00017175450921058655, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_returning_python_literal_pure_expect_dtype_<class 'numpy.float64'>", "lineno": 75, "outcome": "passed", "keywords": ["test_callback_returning_python_literal_pure_expect_dtype_<class 'numpy.float64'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00031191110610961914, "outcome": "passed"}, "call": {"duration": 0.0014165621250867844, "outcome": "passed"}, "teardown": {"duration": 0.0001468360424041748, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_returning_python_literal_pure_expect_dtype_<class 'numpy.int32'>", "lineno": 75, "outcome": "passed", "keywords": ["test_callback_returning_python_literal_pure_expect_dtype_<class 'numpy.int32'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00026549212634563446, "outcome": "passed"}, "call": {"duration": 0.02030947059392929, "outcome": "passed"}, "teardown": {"duration": 9.72328707575798e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_returning_python_literal_pure_expect_dtype_<class 'numpy.int64'>", "lineno": 75, "outcome": "passed", "keywords": ["test_callback_returning_python_literal_pure_expect_dtype_<class 'numpy.int64'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00017030071467161179, "outcome": "passed"}, "call": {"duration": 0.0007910784333944321, "outcome": "passed"}, "teardown": {"duration": 7.489975541830063e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_multiple_arguments_and_return_values_io_ordered", "lineno": 286, "outcome": "passed", "keywords": ["test_callback_with_multiple_arguments_and_return_values_io_ordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013641081750392914, "outcome": "passed"}, "call": {"duration": 0.5682038934901357, "outcome": "passed"}, "teardown": {"duration": 0.0002316618338227272, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_multiple_arguments_and_return_values_io_unordered", "lineno": 286, "outcome": "passed", "keywords": ["test_callback_with_multiple_arguments_and_return_values_io_unordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004037367179989815, "outcome": "passed"}, "call": {"duration": 0.1372213764116168, "outcome": "passed"}, "teardown": {"duration": 0.00023698993027210236, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_multiple_arguments_and_return_values_pure", "lineno": 286, "outcome": "passed", "keywords": ["test_callback_with_multiple_arguments_and_return_values_pure", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003792606294155121, "outcome": "passed"}, "call": {"duration": 0.031051170080900192, "outcome": "passed"}, "teardown": {"duration": 0.00021626055240631104, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_multiple_return_values_io_ordered", "lineno": 272, "outcome": "passed", "keywords": ["test_callback_with_multiple_return_values_io_ordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00037458352744579315, "outcome": "passed"}, "call": {"duration": 0.1313060885295272, "outcome": "passed"}, "teardown": {"duration": 0.0001991642639040947, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_multiple_return_values_io_unordered", "lineno": 272, "outcome": "passed", "keywords": ["test_callback_with_multiple_return_values_io_unordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003849472850561142, "outcome": "passed"}, "call": {"duration": 0.13301383145153522, "outcome": "passed"}, "teardown": {"duration": 0.00012327264994382858, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_multiple_return_values_pure", "lineno": 272, "outcome": "passed", "keywords": ["test_callback_with_multiple_return_values_pure", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00020579341799020767, "outcome": "passed"}, "call": {"duration": 0.015160314738750458, "outcome": "passed"}, "teardown": {"duration": 9.879656136035919e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_pytree_arguments_and_return_values_io_ordered", "lineno": 366, "outcome": "passed", "keywords": ["test_callback_with_pytree_arguments_and_return_values_io_ordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00016685668379068375, "outcome": "passed"}, "call": {"duration": 0.014682660810649395, "outcome": "passed"}, "teardown": {"duration": 9.776372462511063e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_pytree_arguments_and_return_values_io_unordered", "lineno": 366, "outcome": "passed", "keywords": ["test_callback_with_pytree_arguments_and_return_values_io_unordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00016267038881778717, "outcome": "passed"}, "call": {"duration": 0.013743972405791283, "outcome": "passed"}, "teardown": {"duration": 9.862519800662994e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_pytree_arguments_and_return_values_pure", "lineno": 366, "outcome": "passed", "keywords": ["test_callback_with_pytree_arguments_and_return_values_pure", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001640617847442627, "outcome": "passed"}, "call": {"duration": 0.013576505705714226, "outcome": "passed"}, "teardown": {"duration": 9.80747863650322e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_scalar_values_io_ordered", "lineno": 66, "outcome": "passed", "keywords": ["test_callback_with_scalar_values_io_ordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00016128923743963242, "outcome": "passed"}, "call": {"duration": 0.01377855334430933, "outcome": "passed"}, "teardown": {"duration": 9.885523468255997e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_scalar_values_io_unordered", "lineno": 66, "outcome": "passed", "keywords": ["test_callback_with_scalar_values_io_unordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00016708672046661377, "outcome": "passed"}, "call": {"duration": 0.013433843851089478, "outcome": "passed"}, "teardown": {"duration": 9.85860824584961e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_scalar_values_pure", "lineno": 66, "outcome": "passed", "keywords": ["test_callback_with_scalar_values_pure", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00016806833446025848, "outcome": "passed"}, "call": {"duration": 0.01341350469738245, "outcome": "passed"}, "teardown": {"duration": 9.560119360685349e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_single_return_value_io_ordered", "lineno": 260, "outcome": "passed", "keywords": ["test_callback_with_single_return_value_io_ordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00017201434820890427, "outcome": "passed"}, "call": {"duration": 0.12398627679795027, "outcome": "passed"}, "teardown": {"duration": 0.00016678683459758759, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_single_return_value_io_unordered", "lineno": 260, "outcome": "passed", "keywords": ["test_callback_with_single_return_value_io_unordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018730759620666504, "outcome": "passed"}, "call": {"duration": 0.12167096510529518, "outcome": "passed"}, "teardown": {"duration": 0.0001231720671057701, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_single_return_value_pure", "lineno": 260, "outcome": "passed", "keywords": ["test_callback_with_single_return_value_pure", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001893388107419014, "outcome": "passed"}, "call": {"duration": 0.026302915066480637, "outcome": "passed"}, "teardown": {"duration": 0.00021342560648918152, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_wrong_dtype_outputs_io_ordered", "lineno": 226, "outcome": "passed", "keywords": ["test_callback_with_wrong_dtype_outputs_io_ordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003666616976261139, "outcome": "passed"}, "call": {"duration": 0.13205774780362844, "outcome": "passed"}, "teardown": {"duration": 0.00023177266120910645, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_wrong_dtype_outputs_io_unordered", "lineno": 226, "outcome": "passed", "keywords": ["test_callback_with_wrong_dtype_outputs_io_unordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003844285383820534, "outcome": "passed"}, "call": {"duration": 0.13681736961007118, "outcome": "passed"}, "teardown": {"duration": 0.00024102628231048584, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_wrong_dtype_outputs_pure", "lineno": 226, "outcome": "passed", "keywords": ["test_callback_with_wrong_dtype_outputs_pure", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003786291927099228, "outcome": "passed"}, "call": {"duration": 0.026804816909134388, "outcome": "passed"}, "teardown": {"duration": 0.00021432619541883469, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_wrong_number_of_args_io_ordered", "lineno": 177, "outcome": "passed", "keywords": ["test_callback_with_wrong_number_of_args_io_ordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00036157388240098953, "outcome": "passed"}, "call": {"duration": 0.02326769195497036, "outcome": "passed", "stderr": "ERROR:2025-11-20 01:17:45,972:jax._src.callback:441: jax.io_callback failed\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 439, in io_callback_impl\n    return tree_util.tree_map(np.asarray, callback(*args))\n                                          ^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 70, in __call__\n    return tree_util.tree_leaves(self.callback_func(*args, **kwargs))\n                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nTypeError: PythonCallbackTest.test_callback_with_wrong_number_of_args.<locals>.f.<locals>.<lambda>() missing 1 required positional argument: 'x'\nE1120 01:17:45.973222 2657084 pjrt_stream_executor_client.cc:2974] Execution of replica 0 failed: INTERNAL: CpuCallback error calling callback: Traceback (most recent call last):\n  File \"<frozen runpy>\", line 198, in _run_module_as_main\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/usr/local/lib/python3.12/dist-packages/pytest/__main__.py\", line 9, in <module>\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 221, in console_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 197, in main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 365, in pytest_cmdline_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 318, in wrap_session\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 372, in _main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 396, in pytest_runtestloop\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/pytest_rerunfailures.py\", line 593, in pytest_runtest_protocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 137, in runtestprotocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 244, in call_and_report\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 353, in from_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 245, in <lambda>\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 179, in pytest_runtest_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/unittest.py\", line 389, in runtest\n  File \"/usr/lib/python3.12/unittest/case.py\", line 690, in __call__\n  File \"/usr/lib/python3.12/unittest/case.py\", line 634, in run\n  File \"/usr/lib/python3.12/unittest/case.py\", line 589, in _callTestMethod\n  File \"/usr/local/lib/python3.12/dist-packages/absl/testing/parameterized.py\", line 321, in bound_param_test\n  File \"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\", line 188, in test_callback_with_wrong_number_of_args\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/traceback_util.py\", line 180, in reraise_with_filtered_traceback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 263, in cache_miss\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 146, in _python_pjit_helper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 1622, in _pjit_call_impl_python\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/profiler.py\", line 359, in wrapper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py\", line 1371, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 837, in _wrapped_callback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 784, in _wrapped_callback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 496, in _callback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 442, in io_callback_impl\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 70, in __call__\nTypeError: PythonCallbackTest.test_callback_with_wrong_number_of_args.<locals>.f.<locals>.<lambda>() missing 1 required positional argument: 'x'\n", "log": [{"name": "jax._src.callback", "msg": "jax.io_callback failed", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py", "filename": "callback.py", "module": "callback", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 439, in io_callback_impl\n    return tree_util.tree_map(np.asarray, callback(*args))\n                                          ^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 70, in __call__\n    return tree_util.tree_leaves(self.callback_func(*args, **kwargs))\n                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nTypeError: PythonCallbackTest.test_callback_with_wrong_number_of_args.<locals>.f.<locals>.<lambda>() missing 1 required positional argument: 'x'", "stack_info": null, "lineno": 441, "funcName": "io_callback_impl", "created": 1763601465.9722857, "msecs": 972.0, "relativeCreated": 30027.5456905365, "thread": 140447195406656, "threadName": "MainThread", "processName": "MainProcess", "process": 2657084, "taskName": null, "asctime": "2025-11-20 01:17:45,972"}]}, "teardown": {"duration": 0.0025106482207775116, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_wrong_number_of_args_io_unordered", "lineno": 177, "outcome": "passed", "keywords": ["test_callback_with_wrong_number_of_args_io_unordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003144843503832817, "outcome": "passed"}, "call": {"duration": 0.015435992740094662, "outcome": "passed", "stderr": "ERROR:2025-11-20 01:17:45,993:jax._src.callback:441: jax.io_callback failed\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 439, in io_callback_impl\n    return tree_util.tree_map(np.asarray, callback(*args))\n                                          ^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 70, in __call__\n    return tree_util.tree_leaves(self.callback_func(*args, **kwargs))\n                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nTypeError: PythonCallbackTest.test_callback_with_wrong_number_of_args.<locals>.f.<locals>.<lambda>() missing 1 required positional argument: 'x'\nE1120 01:17:45.993687 2657084 pjrt_stream_executor_client.cc:2974] Execution of replica 0 failed: INTERNAL: CpuCallback error calling callback: Traceback (most recent call last):\n  File \"<frozen runpy>\", line 198, in _run_module_as_main\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/usr/local/lib/python3.12/dist-packages/pytest/__main__.py\", line 9, in <module>\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 221, in console_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 197, in main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 365, in pytest_cmdline_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 318, in wrap_session\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 372, in _main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 396, in pytest_runtestloop\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/pytest_rerunfailures.py\", line 593, in pytest_runtest_protocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 137, in runtestprotocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 244, in call_and_report\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 353, in from_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 245, in <lambda>\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 179, in pytest_runtest_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/unittest.py\", line 389, in runtest\n  File \"/usr/lib/python3.12/unittest/case.py\", line 690, in __call__\n  File \"/usr/lib/python3.12/unittest/case.py\", line 634, in run\n  File \"/usr/lib/python3.12/unittest/case.py\", line 589, in _callTestMethod\n  File \"/usr/local/lib/python3.12/dist-packages/absl/testing/parameterized.py\", line 321, in bound_param_test\n  File \"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\", line 188, in test_callback_with_wrong_number_of_args\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/traceback_util.py\", line 180, in reraise_with_filtered_traceback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 263, in cache_miss\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 146, in _python_pjit_helper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 1622, in _pjit_call_impl_python\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/profiler.py\", line 359, in wrapper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py\", line 1371, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 784, in _wrapped_callback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 496, in _callback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 442, in io_callback_impl\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 70, in __call__\nTypeError: PythonCallbackTest.test_callback_with_wrong_number_of_args.<locals>.f.<locals>.<lambda>() missing 1 required positional argument: 'x'\n", "log": [{"name": "jax._src.callback", "msg": "jax.io_callback failed", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py", "filename": "callback.py", "module": "callback", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 439, in io_callback_impl\n    return tree_util.tree_map(np.asarray, callback(*args))\n                                          ^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 70, in __call__\n    return tree_util.tree_leaves(self.callback_func(*args, **kwargs))\n                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nTypeError: PythonCallbackTest.test_callback_with_wrong_number_of_args.<locals>.f.<locals>.<lambda>() missing 1 required positional argument: 'x'", "stack_info": null, "lineno": 441, "funcName": "io_callback_impl", "created": 1763601465.9933767, "msecs": 993.0, "relativeCreated": 30048.63667488098, "thread": 140447195406656, "threadName": "MainThread", "processName": "MainProcess", "process": 2657084, "taskName": null, "asctime": "2025-11-20 01:17:45,993"}]}, "teardown": {"duration": 0.0020046206191182137, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_wrong_number_of_args_pure", "lineno": 177, "outcome": "passed", "keywords": ["test_callback_with_wrong_number_of_args_pure", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00017592869699001312, "outcome": "passed"}, "call": {"duration": 0.010961972177028656, "outcome": "passed", "stderr": "ERROR:2025-11-20 01:17:46,007:jax._src.callback:94: jax.pure_callback failed\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 92, in pure_callback_impl\n    return tree_util.tree_map(np.asarray, callback(*args))\n                                          ^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 70, in __call__\n    return tree_util.tree_leaves(self.callback_func(*args, **kwargs))\n                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nTypeError: PythonCallbackTest.test_callback_with_wrong_number_of_args.<locals>.f.<locals>.<lambda>() missing 1 required positional argument: 'x'\nE1120 01:17:46.007771 2657084 pjrt_stream_executor_client.cc:2974] Execution of replica 0 failed: INTERNAL: CpuCallback error calling callback: Traceback (most recent call last):\n  File \"<frozen runpy>\", line 198, in _run_module_as_main\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/usr/local/lib/python3.12/dist-packages/pytest/__main__.py\", line 9, in <module>\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 221, in console_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 197, in main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 365, in pytest_cmdline_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 318, in wrap_session\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 372, in _main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 396, in pytest_runtestloop\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/pytest_rerunfailures.py\", line 593, in pytest_runtest_protocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 137, in runtestprotocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 244, in call_and_report\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 353, in from_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 245, in <lambda>\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 179, in pytest_runtest_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/unittest.py\", line 389, in runtest\n  File \"/usr/lib/python3.12/unittest/case.py\", line 690, in __call__\n  File \"/usr/lib/python3.12/unittest/case.py\", line 634, in run\n  File \"/usr/lib/python3.12/unittest/case.py\", line 589, in _callTestMethod\n  File \"/usr/local/lib/python3.12/dist-packages/absl/testing/parameterized.py\", line 321, in bound_param_test\n  File \"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\", line 188, in test_callback_with_wrong_number_of_args\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/traceback_util.py\", line 180, in reraise_with_filtered_traceback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 263, in cache_miss\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 146, in _python_pjit_helper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 1622, in _pjit_call_impl_python\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/profiler.py\", line 359, in wrapper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py\", line 1371, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 784, in _wrapped_callback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 223, in _callback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 95, in pure_callback_impl\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 70, in __call__\nTypeError: PythonCallbackTest.test_callback_with_wrong_number_of_args.<locals>.f.<locals>.<lambda>() missing 1 required positional argument: 'x'\n", "log": [{"name": "jax._src.callback", "msg": "jax.pure_callback failed", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py", "filename": "callback.py", "module": "callback", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 92, in pure_callback_impl\n    return tree_util.tree_map(np.asarray, callback(*args))\n                                          ^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 70, in __call__\n    return tree_util.tree_leaves(self.callback_func(*args, **kwargs))\n                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nTypeError: PythonCallbackTest.test_callback_with_wrong_number_of_args.<locals>.f.<locals>.<lambda>() missing 1 required positional argument: 'x'", "stack_info": null, "lineno": 94, "funcName": "pure_callback_impl", "created": 1763601466.007487, "msecs": 7.0, "relativeCreated": 30062.74700164795, "thread": 140447195406656, "threadName": "MainThread", "processName": "MainProcess", "process": 2657084, "taskName": null, "asctime": "2025-11-20 01:17:46,007"}]}, "teardown": {"duration": 0.001966896466910839, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_wrong_number_of_returned_values_io_ordered", "lineno": 190, "outcome": "passed", "keywords": ["test_callback_with_wrong_number_of_returned_values_io_ordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001722145825624466, "outcome": "passed"}, "call": {"duration": 0.18139417842030525, "outcome": "passed", "stderr": "E1120 01:17:46.022859 2657084 pjrt_stream_executor_client.cc:2974] Execution of replica 0 failed: INTERNAL: CpuCallback error calling callback: Traceback (most recent call last):\n  File \"<frozen runpy>\", line 198, in _run_module_as_main\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/usr/local/lib/python3.12/dist-packages/pytest/__main__.py\", line 9, in <module>\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 221, in console_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 197, in main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 365, in pytest_cmdline_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 318, in wrap_session\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 372, in _main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 396, in pytest_runtestloop\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/pytest_rerunfailures.py\", line 593, in pytest_runtest_protocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 137, in runtestprotocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 244, in call_and_report\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 353, in from_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 245, in <lambda>\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 179, in pytest_runtest_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/unittest.py\", line 389, in runtest\n  File \"/usr/lib/python3.12/unittest/case.py\", line 690, in __call__\n  File \"/usr/lib/python3.12/unittest/case.py\", line 634, in run\n  File \"/usr/lib/python3.12/unittest/case.py\", line 589, in _callTestMethod\n  File \"/usr/local/lib/python3.12/dist-packages/absl/testing/parameterized.py\", line 321, in bound_param_test\n  File \"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\", line 200, in test_callback_with_wrong_number_of_returned_values\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/traceback_util.py\", line 180, in reraise_with_filtered_traceback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 263, in cache_miss\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 146, in _python_pjit_helper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 1622, in _pjit_call_impl_python\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/profiler.py\", line 359, in wrapper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py\", line 1371, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 837, in _wrapped_callback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 786, in _wrapped_callback\nRuntimeError: Mismatched number of outputs from callback. Expected: 1, Actual: 2\nE1120 01:17:46.187577 2657084 pjrt_stream_executor_client.cc:2974] Execution of replica 0 failed: INTERNAL: CpuCallback error calling callback: Traceback (most recent call last):\n  File \"<frozen runpy>\", line 198, in _run_module_as_main\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/usr/local/lib/python3.12/dist-packages/pytest/__main__.py\", line 9, in <module>\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 221, in console_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 197, in main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 365, in pytest_cmdline_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 318, in wrap_session\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 372, in _main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 396, in pytest_runtestloop\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/pytest_rerunfailures.py\", line 593, in pytest_runtest_protocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 137, in runtestprotocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 244, in call_and_report\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 353, in from_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 245, in <lambda>\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 179, in pytest_runtest_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/unittest.py\", line 389, in runtest\n  File \"/usr/lib/python3.12/unittest/case.py\", line 690, in __call__\n  File \"/usr/lib/python3.12/unittest/case.py\", line 634, in run\n  File \"/usr/lib/python3.12/unittest/case.py\", line 589, in _callTestMethod\n  File \"/usr/local/lib/python3.12/dist-packages/absl/testing/parameterized.py\", line 321, in bound_param_test\n  File \"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\", line 211, in test_callback_with_wrong_number_of_returned_values\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/traceback_util.py\", line 180, in reraise_with_filtered_traceback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 263, in cache_miss\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 146, in _python_pjit_helper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 1622, in _pjit_call_impl_python\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/profiler.py\", line 359, in wrapper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py\", line 1371, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 786, in _wrapped_callback\nRuntimeError: Mismatched number of outputs from callback. Expected: 2, Actual: 0\n"}, "teardown": {"duration": 0.00012784916907548904, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_wrong_number_of_returned_values_io_unordered", "lineno": 190, "outcome": "passed", "keywords": ["test_callback_with_wrong_number_of_returned_values_io_unordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018776766955852509, "outcome": "passed"}, "call": {"duration": 0.027167953550815582, "outcome": "passed", "stderr": "E1120 01:17:46.206720 2657084 pjrt_stream_executor_client.cc:2974] Execution of replica 0 failed: INTERNAL: CpuCallback error calling callback: Traceback (most recent call last):\n  File \"<frozen runpy>\", line 198, in _run_module_as_main\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/usr/local/lib/python3.12/dist-packages/pytest/__main__.py\", line 9, in <module>\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 221, in console_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 197, in main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 365, in pytest_cmdline_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 318, in wrap_session\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 372, in _main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 396, in pytest_runtestloop\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/pytest_rerunfailures.py\", line 593, in pytest_runtest_protocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 137, in runtestprotocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 244, in call_and_report\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 353, in from_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 245, in <lambda>\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 179, in pytest_runtest_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/unittest.py\", line 389, in runtest\n  File \"/usr/lib/python3.12/unittest/case.py\", line 690, in __call__\n  File \"/usr/lib/python3.12/unittest/case.py\", line 634, in run\n  File \"/usr/lib/python3.12/unittest/case.py\", line 589, in _callTestMethod\n  File \"/usr/local/lib/python3.12/dist-packages/absl/testing/parameterized.py\", line 321, in bound_param_test\n  File \"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\", line 200, in test_callback_with_wrong_number_of_returned_values\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/traceback_util.py\", line 180, in reraise_with_filtered_traceback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 263, in cache_miss\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 146, in _python_pjit_helper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 1622, in _pjit_call_impl_python\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/profiler.py\", line 359, in wrapper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py\", line 1371, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 786, in _wrapped_callback\nRuntimeError: Mismatched number of outputs from callback. Expected: 1, Actual: 2\nE1120 01:17:46.216674 2657084 pjrt_stream_executor_client.cc:2974] Execution of replica 0 failed: INTERNAL: CpuCallback error calling callback: Traceback (most recent call last):\n  File \"<frozen runpy>\", line 198, in _run_module_as_main\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/usr/local/lib/python3.12/dist-packages/pytest/__main__.py\", line 9, in <module>\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 221, in console_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 197, in main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 365, in pytest_cmdline_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 318, in wrap_session\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 372, in _main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 396, in pytest_runtestloop\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/pytest_rerunfailures.py\", line 593, in pytest_runtest_protocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 137, in runtestprotocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 244, in call_and_report\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 353, in from_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 245, in <lambda>\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 179, in pytest_runtest_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/unittest.py\", line 389, in runtest\n  File \"/usr/lib/python3.12/unittest/case.py\", line 690, in __call__\n  File \"/usr/lib/python3.12/unittest/case.py\", line 634, in run\n  File \"/usr/lib/python3.12/unittest/case.py\", line 589, in _callTestMethod\n  File \"/usr/local/lib/python3.12/dist-packages/absl/testing/parameterized.py\", line 321, in bound_param_test\n  File \"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\", line 211, in test_callback_with_wrong_number_of_returned_values\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/traceback_util.py\", line 180, in reraise_with_filtered_traceback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 263, in cache_miss\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 146, in _python_pjit_helper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 1622, in _pjit_call_impl_python\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/profiler.py\", line 359, in wrapper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py\", line 1371, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 786, in _wrapped_callback\nRuntimeError: Mismatched number of outputs from callback. Expected: 2, Actual: 0\n"}, "teardown": {"duration": 0.00011288654059171677, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_wrong_number_of_returned_values_pure", "lineno": 190, "outcome": "passed", "keywords": ["test_callback_with_wrong_number_of_returned_values_pure", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001698806881904602, "outcome": "passed"}, "call": {"duration": 0.02542194351553917, "outcome": "passed", "stderr": "E1120 01:17:46.233188 2657084 pjrt_stream_executor_client.cc:2974] Execution of replica 0 failed: INTERNAL: CpuCallback error calling callback: Traceback (most recent call last):\n  File \"<frozen runpy>\", line 198, in _run_module_as_main\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/usr/local/lib/python3.12/dist-packages/pytest/__main__.py\", line 9, in <module>\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 221, in console_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 197, in main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 365, in pytest_cmdline_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 318, in wrap_session\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 372, in _main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 396, in pytest_runtestloop\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/pytest_rerunfailures.py\", line 593, in pytest_runtest_protocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 137, in runtestprotocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 244, in call_and_report\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 353, in from_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 245, in <lambda>\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 179, in pytest_runtest_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/unittest.py\", line 389, in runtest\n  File \"/usr/lib/python3.12/unittest/case.py\", line 690, in __call__\n  File \"/usr/lib/python3.12/unittest/case.py\", line 634, in run\n  File \"/usr/lib/python3.12/unittest/case.py\", line 589, in _callTestMethod\n  File \"/usr/local/lib/python3.12/dist-packages/absl/testing/parameterized.py\", line 321, in bound_param_test\n  File \"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\", line 200, in test_callback_with_wrong_number_of_returned_values\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/traceback_util.py\", line 180, in reraise_with_filtered_traceback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 263, in cache_miss\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 146, in _python_pjit_helper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 1622, in _pjit_call_impl_python\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/profiler.py\", line 359, in wrapper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py\", line 1371, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 786, in _wrapped_callback\nRuntimeError: Mismatched number of outputs from callback. Expected: 1, Actual: 2\nE1120 01:17:46.243086 2657084 pjrt_stream_executor_client.cc:2974] Execution of replica 0 failed: INTERNAL: CpuCallback error calling callback: Traceback (most recent call last):\n  File \"<frozen runpy>\", line 198, in _run_module_as_main\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/usr/local/lib/python3.12/dist-packages/pytest/__main__.py\", line 9, in <module>\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 221, in console_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 197, in main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 365, in pytest_cmdline_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 318, in wrap_session\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 372, in _main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 396, in pytest_runtestloop\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/pytest_rerunfailures.py\", line 593, in pytest_runtest_protocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 137, in runtestprotocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 244, in call_and_report\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 353, in from_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 245, in <lambda>\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 179, in pytest_runtest_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/unittest.py\", line 389, in runtest\n  File \"/usr/lib/python3.12/unittest/case.py\", line 690, in __call__\n  File \"/usr/lib/python3.12/unittest/case.py\", line 634, in run\n  File \"/usr/lib/python3.12/unittest/case.py\", line 589, in _callTestMethod\n  File \"/usr/local/lib/python3.12/dist-packages/absl/testing/parameterized.py\", line 321, in bound_param_test\n  File \"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\", line 211, in test_callback_with_wrong_number_of_returned_values\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/traceback_util.py\", line 180, in reraise_with_filtered_traceback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 263, in cache_miss\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 146, in _python_pjit_helper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 1622, in _pjit_call_impl_python\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/profiler.py\", line 359, in wrapper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py\", line 1371, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 786, in _wrapped_callback\nRuntimeError: Mismatched number of outputs from callback. Expected: 2, Actual: 0\n"}, "teardown": {"duration": 0.00011079292744398117, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_wrong_shape_outputs_io_ordered", "lineno": 213, "outcome": "passed", "keywords": ["test_callback_with_wrong_shape_outputs_io_ordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00017217453569173813, "outcome": "passed"}, "call": {"duration": 0.013626869767904282, "outcome": "passed", "stderr": "E1120 01:17:46.259679 2657084 pjrt_stream_executor_client.cc:2974] Execution of replica 0 failed: INTERNAL: CpuCallback error calling callback: Traceback (most recent call last):\n  File \"<frozen runpy>\", line 198, in _run_module_as_main\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/usr/local/lib/python3.12/dist-packages/pytest/__main__.py\", line 9, in <module>\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 221, in console_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 197, in main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 365, in pytest_cmdline_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 318, in wrap_session\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 372, in _main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 396, in pytest_runtestloop\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/pytest_rerunfailures.py\", line 593, in pytest_runtest_protocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 137, in runtestprotocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 244, in call_and_report\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 353, in from_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 245, in <lambda>\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 179, in pytest_runtest_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/unittest.py\", line 389, in runtest\n  File \"/usr/lib/python3.12/unittest/case.py\", line 690, in __call__\n  File \"/usr/lib/python3.12/unittest/case.py\", line 634, in run\n  File \"/usr/lib/python3.12/unittest/case.py\", line 589, in _callTestMethod\n  File \"/usr/local/lib/python3.12/dist-packages/absl/testing/parameterized.py\", line 321, in bound_param_test\n  File \"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\", line 224, in test_callback_with_wrong_shape_outputs\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/traceback_util.py\", line 180, in reraise_with_filtered_traceback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 263, in cache_miss\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 146, in _python_pjit_helper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 1622, in _pjit_call_impl_python\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/profiler.py\", line 359, in wrapper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py\", line 1371, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 837, in _wrapped_callback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 793, in _wrapped_callback\nRuntimeError: Incorrect output shape for return value #0: Expected: (1,), Actual: ()\n"}, "teardown": {"duration": 0.00010365340858697891, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_wrong_shape_outputs_io_unordered", "lineno": 213, "outcome": "passed", "keywords": ["test_callback_with_wrong_shape_outputs_io_unordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00016925018280744553, "outcome": "passed"}, "call": {"duration": 0.012882952578365803, "outcome": "passed", "stderr": "E1120 01:17:46.273598 2657084 pjrt_stream_executor_client.cc:2974] Execution of replica 0 failed: INTERNAL: CpuCallback error calling callback: Traceback (most recent call last):\n  File \"<frozen runpy>\", line 198, in _run_module_as_main\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/usr/local/lib/python3.12/dist-packages/pytest/__main__.py\", line 9, in <module>\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 221, in console_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 197, in main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 365, in pytest_cmdline_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 318, in wrap_session\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 372, in _main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 396, in pytest_runtestloop\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/pytest_rerunfailures.py\", line 593, in pytest_runtest_protocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 137, in runtestprotocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 244, in call_and_report\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 353, in from_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 245, in <lambda>\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 179, in pytest_runtest_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/unittest.py\", line 389, in runtest\n  File \"/usr/lib/python3.12/unittest/case.py\", line 690, in __call__\n  File \"/usr/lib/python3.12/unittest/case.py\", line 634, in run\n  File \"/usr/lib/python3.12/unittest/case.py\", line 589, in _callTestMethod\n  File \"/usr/local/lib/python3.12/dist-packages/absl/testing/parameterized.py\", line 321, in bound_param_test\n  File \"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\", line 224, in test_callback_with_wrong_shape_outputs\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/traceback_util.py\", line 180, in reraise_with_filtered_traceback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 263, in cache_miss\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 146, in _python_pjit_helper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 1622, in _pjit_call_impl_python\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/profiler.py\", line 359, in wrapper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py\", line 1371, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 793, in _wrapped_callback\nRuntimeError: Incorrect output shape for return value #0: Expected: (1,), Actual: ()\n"}, "teardown": {"duration": 0.00010346341878175735, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_wrong_shape_outputs_pure", "lineno": 213, "outcome": "passed", "keywords": ["test_callback_with_wrong_shape_outputs_pure", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001643635332584381, "outcome": "passed"}, "call": {"duration": 0.01273652445524931, "outcome": "passed", "stderr": "E1120 01:17:46.287391 2657084 pjrt_stream_executor_client.cc:2974] Execution of replica 0 failed: INTERNAL: CpuCallback error calling callback: Traceback (most recent call last):\n  File \"<frozen runpy>\", line 198, in _run_module_as_main\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/usr/local/lib/python3.12/dist-packages/pytest/__main__.py\", line 9, in <module>\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 221, in console_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 197, in main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 365, in pytest_cmdline_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 318, in wrap_session\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 372, in _main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 396, in pytest_runtestloop\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/pytest_rerunfailures.py\", line 593, in pytest_runtest_protocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 137, in runtestprotocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 244, in call_and_report\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 353, in from_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 245, in <lambda>\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 179, in pytest_runtest_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/unittest.py\", line 389, in runtest\n  File \"/usr/lib/python3.12/unittest/case.py\", line 690, in __call__\n  File \"/usr/lib/python3.12/unittest/case.py\", line 634, in run\n  File \"/usr/lib/python3.12/unittest/case.py\", line 589, in _callTestMethod\n  File \"/usr/local/lib/python3.12/dist-packages/absl/testing/parameterized.py\", line 321, in bound_param_test\n  File \"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\", line 224, in test_callback_with_wrong_shape_outputs\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/traceback_util.py\", line 180, in reraise_with_filtered_traceback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 263, in cache_miss\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 146, in _python_pjit_helper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 1622, in _pjit_call_impl_python\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/profiler.py\", line 359, in wrapper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py\", line 1371, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 793, in _wrapped_callback\nRuntimeError: Incorrect output shape for return value #0: Expected: (1,), Actual: ()\n"}, "teardown": {"duration": 0.00010290183126926422, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_wrongly_specified_64_bit_dtype_io_ordered", "lineno": 246, "outcome": "passed", "keywords": ["test_callback_with_wrongly_specified_64_bit_dtype_io_ordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00016548391431570053, "outcome": "passed"}, "call": {"duration": 0.0007351357489824295, "outcome": "passed"}, "teardown": {"duration": 7.56923109292984e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_wrongly_specified_64_bit_dtype_io_unordered", "lineno": 246, "outcome": "passed", "keywords": ["test_callback_with_wrongly_specified_64_bit_dtype_io_unordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00014226045459508896, "outcome": "passed"}, "call": {"duration": 0.0006402255967259407, "outcome": "passed"}, "teardown": {"duration": 7.169600576162338e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_with_wrongly_specified_64_bit_dtype_pure", "lineno": 246, "outcome": "passed", "keywords": ["test_callback_with_wrongly_specified_64_bit_dtype_pure", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013581011444330215, "outcome": "passed"}, "call": {"duration": 0.0006282776594161987, "outcome": "passed"}, "teardown": {"duration": 7.168669253587723e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_ordered_<class 'ml_dtypes.bfloat16'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_io_ordered_<class 'ml_dtypes.bfloat16'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013417750597000122, "outcome": "passed"}, "call": {"duration": 0.15097354166209698, "outcome": "passed"}, "teardown": {"duration": 0.00019287504255771637, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_ordered_<class 'numpy.bool'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_io_ordered_<class 'numpy.bool'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003116205334663391, "outcome": "passed"}, "call": {"duration": 0.16003335360437632, "outcome": "passed"}, "teardown": {"duration": 0.00023391656577587128, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_ordered_<class 'numpy.complex64'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_io_ordered_<class 'numpy.complex64'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003794915974140167, "outcome": "passed"}, "call": {"duration": 0.1730760708451271, "outcome": "passed"}, "teardown": {"duration": 0.0002267453819513321, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_ordered_<class 'numpy.float16'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_io_ordered_<class 'numpy.float16'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00038529839366674423, "outcome": "passed"}, "call": {"duration": 0.1765977032482624, "outcome": "passed"}, "teardown": {"duration": 0.0002310117706656456, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_ordered_<class 'numpy.float32'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_io_ordered_<class 'numpy.float32'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003993399441242218, "outcome": "passed"}, "call": {"duration": 0.17497478611767292, "outcome": "passed"}, "teardown": {"duration": 0.00022970885038375854, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_ordered_<class 'numpy.int16'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_io_ordered_<class 'numpy.int16'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003861505538225174, "outcome": "passed"}, "call": {"duration": 0.1722221402451396, "outcome": "passed"}, "teardown": {"duration": 0.00023194309324026108, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_ordered_<class 'numpy.int32'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_io_ordered_<class 'numpy.int32'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003846585750579834, "outcome": "passed"}, "call": {"duration": 0.17333034705370665, "outcome": "passed"}, "teardown": {"duration": 0.00022804737091064453, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_ordered_<class 'numpy.int8'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_io_ordered_<class 'numpy.int8'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003862399607896805, "outcome": "passed"}, "call": {"duration": 0.16957658249884844, "outcome": "passed"}, "teardown": {"duration": 0.0002298392355442047, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_ordered_<class 'numpy.uint16'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_io_ordered_<class 'numpy.uint16'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003841472789645195, "outcome": "passed"}, "call": {"duration": 0.17083419021219015, "outcome": "passed"}, "teardown": {"duration": 0.0002339361235499382, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_ordered_<class 'numpy.uint32'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_io_ordered_<class 'numpy.uint32'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003726799041032791, "outcome": "passed"}, "call": {"duration": 0.16829183418303728, "outcome": "passed"}, "teardown": {"duration": 0.00023011025041341782, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_ordered_<class 'numpy.uint8'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_io_ordered_<class 'numpy.uint8'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00038201361894607544, "outcome": "passed"}, "call": {"duration": 0.16328368429094553, "outcome": "passed"}, "teardown": {"duration": 0.00023165158927440643, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_unordered_<class 'ml_dtypes.bfloat16'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_io_unordered_<class 'ml_dtypes.bfloat16'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003800513222813606, "outcome": "passed"}, "call": {"duration": 0.13238725624978542, "outcome": "passed"}, "teardown": {"duration": 0.00012251082807779312, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_unordered_<class 'numpy.bool'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_io_unordered_<class 'numpy.bool'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001899413764476776, "outcome": "passed"}, "call": {"duration": 0.1223621666431427, "outcome": "passed"}, "teardown": {"duration": 0.00013452954590320587, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_unordered_<class 'numpy.complex64'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_io_unordered_<class 'numpy.complex64'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018959958106279373, "outcome": "passed"}, "call": {"duration": 0.12884683534502983, "outcome": "passed"}, "teardown": {"duration": 0.00023673009127378464, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_unordered_<class 'numpy.float16'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_io_unordered_<class 'numpy.float16'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003785397857427597, "outcome": "passed"}, "call": {"duration": 0.1416015261784196, "outcome": "passed"}, "teardown": {"duration": 0.0002332739531993866, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_unordered_<class 'numpy.float32'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_io_unordered_<class 'numpy.float32'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003804117441177368, "outcome": "passed"}, "call": {"duration": 0.13781281001865864, "outcome": "passed"}, "teardown": {"duration": 0.0002345852553844452, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_unordered_<class 'numpy.int16'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_io_unordered_<class 'numpy.int16'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003811633214354515, "outcome": "passed"}, "call": {"duration": 0.13384110294282436, "outcome": "passed"}, "teardown": {"duration": 0.00023600924760103226, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_unordered_<class 'numpy.int32'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_io_unordered_<class 'numpy.int32'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00038162339478731155, "outcome": "passed"}, "call": {"duration": 0.14205218199640512, "outcome": "passed"}, "teardown": {"duration": 0.00023317337036132812, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_unordered_<class 'numpy.int8'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_io_unordered_<class 'numpy.int8'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003867410123348236, "outcome": "passed"}, "call": {"duration": 0.13778295554220676, "outcome": "passed"}, "teardown": {"duration": 0.0002334844321012497, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_unordered_<class 'numpy.uint16'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_io_unordered_<class 'numpy.uint16'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.000384308397769928, "outcome": "passed"}, "call": {"duration": 0.13635893259197474, "outcome": "passed"}, "teardown": {"duration": 0.00023391656577587128, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_unordered_<class 'numpy.uint32'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_io_unordered_<class 'numpy.uint32'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00037718750536441803, "outcome": "passed"}, "call": {"duration": 0.13466220535337925, "outcome": "passed"}, "teardown": {"duration": 0.00023102108389139175, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_io_unordered_<class 'numpy.uint8'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_io_unordered_<class 'numpy.uint8'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003783591091632843, "outcome": "passed"}, "call": {"duration": 0.13658551685512066, "outcome": "passed"}, "teardown": {"duration": 0.00012322142720222473, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_pure_<class 'ml_dtypes.bfloat16'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_pure_<class 'ml_dtypes.bfloat16'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.000183911994099617, "outcome": "passed"}, "call": {"duration": 0.015744018368422985, "outcome": "passed"}, "teardown": {"duration": 0.00010035745799541473, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_pure_<class 'numpy.bool'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_pure_<class 'numpy.bool'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00016398262232542038, "outcome": "passed"}, "call": {"duration": 0.014105407521128654, "outcome": "passed"}, "teardown": {"duration": 9.909551590681076e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_pure_<class 'numpy.complex64'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_pure_<class 'numpy.complex64'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001665763556957245, "outcome": "passed"}, "call": {"duration": 0.014149702154099941, "outcome": "passed"}, "teardown": {"duration": 9.939633309841156e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_pure_<class 'numpy.float16'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_pure_<class 'numpy.float16'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.000164802186191082, "outcome": "passed"}, "call": {"duration": 0.014072428457438946, "outcome": "passed"}, "teardown": {"duration": 9.948667138814926e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_pure_<class 'numpy.float32'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_pure_<class 'numpy.float32'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00016664620488882065, "outcome": "passed"}, "call": {"duration": 0.014270291663706303, "outcome": "passed"}, "teardown": {"duration": 9.791553020477295e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_pure_<class 'numpy.int16'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_pure_<class 'numpy.int16'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001624198630452156, "outcome": "passed"}, "call": {"duration": 0.014019540511071682, "outcome": "passed"}, "teardown": {"duration": 9.870622307062149e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_pure_<class 'numpy.int32'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_pure_<class 'numpy.int32'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001650247722864151, "outcome": "passed"}, "call": {"duration": 0.013961244374513626, "outcome": "passed"}, "teardown": {"duration": 9.781401604413986e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_pure_<class 'numpy.int8'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_pure_<class 'numpy.int8'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00016288086771965027, "outcome": "passed"}, "call": {"duration": 0.014145296066999435, "outcome": "passed"}, "teardown": {"duration": 9.819492697715759e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_pure_<class 'numpy.uint16'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_pure_<class 'numpy.uint16'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00016493257135152817, "outcome": "passed"}, "call": {"duration": 0.014128481037914753, "outcome": "passed"}, "teardown": {"duration": 0.00010012835264205933, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_pure_<class 'numpy.uint32'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_pure_<class 'numpy.uint32'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00016780756413936615, "outcome": "passed"}, "call": {"duration": 0.014130864292383194, "outcome": "passed"}, "teardown": {"duration": 9.939726442098618e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_callback_works_with_all_types_pure_<class 'numpy.uint8'>", "lineno": 142, "outcome": "passed", "keywords": ["test_callback_works_with_all_types_pure_<class 'numpy.uint8'>", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00016876962035894394, "outcome": "passed"}, "call": {"duration": 0.01417526975274086, "outcome": "passed"}, "teardown": {"duration": 9.686220437288284e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_compilation_caching_io_ordered", "lineno": 572, "outcome": "passed", "keywords": ["test_compilation_caching_io_ordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.000170782208442688, "outcome": "passed"}, "call": {"duration": 0.1747520985081792, "outcome": "passed"}, "teardown": {"duration": 0.0001196451485157013, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_compilation_caching_io_unordered", "lineno": 572, "outcome": "passed", "keywords": ["test_compilation_caching_io_unordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001971721649169922, "outcome": "passed"}, "call": {"duration": 0.12364820670336485, "outcome": "passed"}, "teardown": {"duration": 0.00025936309248209, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_compilation_caching_pure", "lineno": 572, "outcome": "passed", "keywords": ["test_compilation_caching_pure", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00038866326212882996, "outcome": "passed"}, "call": {"duration": 0.032971846871078014, "outcome": "passed"}, "teardown": {"duration": 0.00021887291222810745, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_exception_in_callback_io_ordered", "lineno": 549, "outcome": "passed", "keywords": ["test_exception_in_callback_io_ordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003884434700012207, "outcome": "passed"}, "call": {"duration": 0.02284341398626566, "outcome": "passed", "stderr": "ERROR:2025-11-20 01:17:50,202:jax._src.callback:441: jax.io_callback failed\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 439, in io_callback_impl\n    return tree_util.tree_map(np.asarray, callback(*args))\n                                          ^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 70, in __call__\n    return tree_util.tree_leaves(self.callback_func(*args, **kwargs))\n                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\", line 554, in fail\n    raise RuntimeError(\"Ooops\")\nRuntimeError: Ooops\nE1120 01:17:50.203017 2657084 pjrt_stream_executor_client.cc:2974] Execution of replica 0 failed: INTERNAL: CpuCallback error calling callback: Traceback (most recent call last):\n  File \"<frozen runpy>\", line 198, in _run_module_as_main\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/usr/local/lib/python3.12/dist-packages/pytest/__main__.py\", line 9, in <module>\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 221, in console_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 197, in main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 365, in pytest_cmdline_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 318, in wrap_session\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 372, in _main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 396, in pytest_runtestloop\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/pytest_rerunfailures.py\", line 593, in pytest_runtest_protocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 137, in runtestprotocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 244, in call_and_report\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 353, in from_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 245, in <lambda>\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 179, in pytest_runtest_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/unittest.py\", line 389, in runtest\n  File \"/usr/lib/python3.12/unittest/case.py\", line 690, in __call__\n  File \"/usr/lib/python3.12/unittest/case.py\", line 634, in run\n  File \"/usr/lib/python3.12/unittest/case.py\", line 589, in _callTestMethod\n  File \"/usr/local/lib/python3.12/dist-packages/absl/testing/parameterized.py\", line 321, in bound_param_test\n  File \"/usr/lib/python3.12/contextlib.py\", line 81, in inner\n  File \"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\", line 562, in test_exception_in_callback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/traceback_util.py\", line 180, in reraise_with_filtered_traceback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 263, in cache_miss\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 146, in _python_pjit_helper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 1622, in _pjit_call_impl_python\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/profiler.py\", line 359, in wrapper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py\", line 1371, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 837, in _wrapped_callback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 784, in _wrapped_callback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 496, in _callback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 442, in io_callback_impl\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 70, in __call__\n  File \"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\", line 554, in fail\nRuntimeError: Ooops\n"}, "teardown": {"duration": 0.00011088419705629349, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_exception_in_callback_io_unordered", "lineno": 549, "outcome": "passed", "keywords": ["test_exception_in_callback_io_unordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001725153997540474, "outcome": "passed"}, "call": {"duration": 0.015230128541588783, "outcome": "passed", "stderr": "ERROR:2025-11-20 01:17:50,219:jax._src.callback:441: jax.io_callback failed\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 439, in io_callback_impl\n    return tree_util.tree_map(np.asarray, callback(*args))\n                                          ^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 70, in __call__\n    return tree_util.tree_leaves(self.callback_func(*args, **kwargs))\n                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\", line 554, in fail\n    raise RuntimeError(\"Ooops\")\nRuntimeError: Ooops\nE1120 01:17:50.219438 2657084 pjrt_stream_executor_client.cc:2974] Execution of replica 0 failed: INTERNAL: CpuCallback error calling callback: Traceback (most recent call last):\n  File \"<frozen runpy>\", line 198, in _run_module_as_main\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/usr/local/lib/python3.12/dist-packages/pytest/__main__.py\", line 9, in <module>\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 221, in console_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 197, in main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 365, in pytest_cmdline_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 318, in wrap_session\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 372, in _main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 396, in pytest_runtestloop\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/pytest_rerunfailures.py\", line 593, in pytest_runtest_protocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 137, in runtestprotocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 244, in call_and_report\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 353, in from_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 245, in <lambda>\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 179, in pytest_runtest_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/unittest.py\", line 389, in runtest\n  File \"/usr/lib/python3.12/unittest/case.py\", line 690, in __call__\n  File \"/usr/lib/python3.12/unittest/case.py\", line 634, in run\n  File \"/usr/lib/python3.12/unittest/case.py\", line 589, in _callTestMethod\n  File \"/usr/local/lib/python3.12/dist-packages/absl/testing/parameterized.py\", line 321, in bound_param_test\n  File \"/usr/lib/python3.12/contextlib.py\", line 81, in inner\n  File \"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\", line 562, in test_exception_in_callback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/traceback_util.py\", line 180, in reraise_with_filtered_traceback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 263, in cache_miss\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 146, in _python_pjit_helper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 1622, in _pjit_call_impl_python\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/profiler.py\", line 359, in wrapper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py\", line 1371, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 784, in _wrapped_callback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 496, in _callback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 442, in io_callback_impl\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 70, in __call__\n  File \"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\", line 554, in fail\nRuntimeError: Ooops\n"}, "teardown": {"duration": 0.00010199099779129028, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_exception_in_callback_pure", "lineno": 549, "outcome": "passed", "keywords": ["test_exception_in_callback_pure", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00017168372869491577, "outcome": "passed"}, "call": {"duration": 0.0121286166831851, "outcome": "passed", "stderr": "ERROR:2025-11-20 01:17:50,232:jax._src.callback:94: jax.pure_callback failed\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 92, in pure_callback_impl\n    return tree_util.tree_map(np.asarray, callback(*args))\n                                          ^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 70, in __call__\n    return tree_util.tree_leaves(self.callback_func(*args, **kwargs))\n                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\", line 554, in fail\n    raise RuntimeError(\"Ooops\")\nRuntimeError: Ooops\nE1120 01:17:50.232649 2657084 pjrt_stream_executor_client.cc:2974] Execution of replica 0 failed: INTERNAL: CpuCallback error calling callback: Traceback (most recent call last):\n  File \"<frozen runpy>\", line 198, in _run_module_as_main\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/usr/local/lib/python3.12/dist-packages/pytest/__main__.py\", line 9, in <module>\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 221, in console_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 197, in main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 365, in pytest_cmdline_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 318, in wrap_session\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 372, in _main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 396, in pytest_runtestloop\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/pytest_rerunfailures.py\", line 593, in pytest_runtest_protocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 137, in runtestprotocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 244, in call_and_report\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 353, in from_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 245, in <lambda>\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 179, in pytest_runtest_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/unittest.py\", line 389, in runtest\n  File \"/usr/lib/python3.12/unittest/case.py\", line 690, in __call__\n  File \"/usr/lib/python3.12/unittest/case.py\", line 634, in run\n  File \"/usr/lib/python3.12/unittest/case.py\", line 589, in _callTestMethod\n  File \"/usr/local/lib/python3.12/dist-packages/absl/testing/parameterized.py\", line 321, in bound_param_test\n  File \"/usr/lib/python3.12/contextlib.py\", line 81, in inner\n  File \"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\", line 562, in test_exception_in_callback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/traceback_util.py\", line 180, in reraise_with_filtered_traceback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 263, in cache_miss\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 146, in _python_pjit_helper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 1622, in _pjit_call_impl_python\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/profiler.py\", line 359, in wrapper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py\", line 1371, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 784, in _wrapped_callback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 223, in _callback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 95, in pure_callback_impl\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 70, in __call__\n  File \"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\", line 554, in fail\nRuntimeError: Ooops\n"}, "teardown": {"duration": 9.6101313829422e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_non_default_stride", "lineno": 656, "outcome": "passed", "keywords": ["test_non_default_stride", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00016416329890489578, "outcome": "passed"}, "call": {"duration": 0.3667910797521472, "outcome": "passed"}, "teardown": {"duration": 0.0002351868897676468, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_non_default_stride_subbyte_results0", "lineno": 636, "outcome": "passed", "keywords": ["test_non_default_stride_subbyte_results0", "__wrapped__", "__x_params_repr__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003818739205598831, "outcome": "passed"}, "call": {"duration": 0.4129338227212429, "outcome": "passed"}, "teardown": {"duration": 0.00012276135385036469, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_non_default_stride_subbyte_results1", "lineno": 636, "outcome": "passed", "keywords": ["test_non_default_stride_subbyte_results1", "__wrapped__", "__x_params_repr__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00038592051714658737, "outcome": "passed"}, "call": {"duration": 0.4099414926022291, "outcome": "passed"}, "teardown": {"duration": 0.0002543255686759949, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_non_default_stride_subbyte_results2", "lineno": 636, "outcome": "passed", "keywords": ["test_non_default_stride_subbyte_results2", "__wrapped__", "__x_params_repr__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00038958434015512466, "outcome": "passed"}, "call": {"duration": 0.3995541175827384, "outcome": "passed"}, "teardown": {"duration": 0.00023553799837827682, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_non_default_stride_subbyte_results3", "lineno": 636, "outcome": "passed", "keywords": ["test_non_default_stride_subbyte_results3", "__wrapped__", "__x_params_repr__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003815237432718277, "outcome": "passed"}, "call": {"duration": 0.4059172682464123, "outcome": "passed"}, "teardown": {"duration": 0.00024210847914218903, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_non_default_stride_subbyte_results4", "lineno": 636, "outcome": "passed", "keywords": ["test_non_default_stride_subbyte_results4", "__wrapped__", "__x_params_repr__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00038598012179136276, "outcome": "passed"}, "call": {"duration": 0.42152311094105244, "outcome": "passed"}, "teardown": {"duration": 0.00023504719138145447, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_pure_callback_sequential_vmap_method_eval_jaxpr", "lineno": 606, "outcome": "passed", "keywords": ["test_pure_callback_sequential_vmap_method_eval_jaxpr", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003892751410603523, "outcome": "passed"}, "call": {"duration": 0.4853723496198654, "outcome": "passed"}, "teardown": {"duration": 0.0001292005181312561, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_recv_zero_dim_and_non_zero_dim_arrays_io_ordered", "lineno": 345, "outcome": "passed", "keywords": ["test_recv_zero_dim_and_non_zero_dim_arrays_io_ordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019219331443309784, "outcome": "passed"}, "call": {"duration": 0.12888365797698498, "outcome": "passed"}, "teardown": {"duration": 0.00023762043565511703, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_recv_zero_dim_and_non_zero_dim_arrays_io_unordered", "lineno": 345, "outcome": "passed", "keywords": ["test_recv_zero_dim_and_non_zero_dim_arrays_io_unordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003915587440133095, "outcome": "passed"}, "call": {"duration": 0.14192976150661707, "outcome": "passed"}, "teardown": {"duration": 0.0002328045666217804, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_recv_zero_dim_and_non_zero_dim_arrays_pure", "lineno": 345, "outcome": "passed", "keywords": ["test_recv_zero_dim_and_non_zero_dim_arrays_pure", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003880234435200691, "outcome": "passed"}, "call": {"duration": 0.032503063790500164, "outcome": "passed"}, "teardown": {"duration": 0.00021763145923614502, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_recv_zero_dim_arrays_io_ordered", "lineno": 331, "outcome": "passed", "keywords": ["test_recv_zero_dim_arrays_io_ordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00036759302020072937, "outcome": "passed"}, "call": {"duration": 0.1337801618501544, "outcome": "passed"}, "teardown": {"duration": 0.00023194216191768646, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_recv_zero_dim_arrays_io_unordered", "lineno": 331, "outcome": "passed", "keywords": ["test_recv_zero_dim_arrays_io_unordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00038374774158000946, "outcome": "passed"}, "call": {"duration": 0.1362900696694851, "outcome": "passed"}, "teardown": {"duration": 0.00012519489973783493, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_recv_zero_dim_arrays_pure", "lineno": 331, "outcome": "passed", "keywords": ["test_recv_zero_dim_arrays_pure", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018753670156002045, "outcome": "passed"}, "call": {"duration": 0.12390641681849957, "outcome": "passed"}, "teardown": {"duration": 0.00023882277309894562, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_send_zero_dim_and_non_zero_dim_arrays_io_ordered", "lineno": 316, "outcome": "passed", "keywords": ["test_send_zero_dim_and_non_zero_dim_arrays_io_ordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003844974562525749, "outcome": "passed"}, "call": {"duration": 0.12703454867005348, "outcome": "passed"}, "teardown": {"duration": 0.00023641902953386307, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_send_zero_dim_and_non_zero_dim_arrays_io_unordered", "lineno": 316, "outcome": "passed", "keywords": ["test_send_zero_dim_and_non_zero_dim_arrays_io_unordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00040037091821432114, "outcome": "passed"}, "call": {"duration": 0.1416181204840541, "outcome": "passed"}, "teardown": {"duration": 0.00023336522281169891, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_send_zero_dim_and_non_zero_dim_arrays_pure", "lineno": 316, "outcome": "passed", "keywords": ["test_send_zero_dim_and_non_zero_dim_arrays_pure", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00039836764335632324, "outcome": "passed"}, "call": {"duration": 0.029674826189875603, "outcome": "passed"}, "teardown": {"duration": 0.000215848907828331, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_send_zero_dim_arrays_io_ordered", "lineno": 302, "outcome": "passed", "keywords": ["test_send_zero_dim_arrays_io_ordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003697676584124565, "outcome": "passed"}, "call": {"duration": 0.1332375006750226, "outcome": "passed"}, "teardown": {"duration": 0.00019705109298229218, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_send_zero_dim_arrays_io_unordered", "lineno": 302, "outcome": "passed", "keywords": ["test_send_zero_dim_arrays_io_unordered", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00031477492302656174, "outcome": "passed"}, "call": {"duration": 0.13058716524392366, "outcome": "passed"}, "teardown": {"duration": 0.00022826716303825378, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_send_zero_dim_arrays_pure", "lineno": 302, "outcome": "passed", "keywords": ["test_send_zero_dim_arrays_pure", "__wrapped__", "__x_use_name__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003803027793765068, "outcome": "passed"}, "call": {"duration": 0.02878816518932581, "outcome": "passed"}, "teardown": {"duration": 0.00021376553922891617, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_subbyte_operands0", "lineno": 587, "outcome": "passed", "keywords": ["test_subbyte_operands0", "__wrapped__", "__x_params_repr__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003632158041000366, "outcome": "passed"}, "call": {"duration": 0.13798685558140278, "outcome": "passed"}, "teardown": {"duration": 0.0002312818542122841, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_subbyte_operands1", "lineno": 587, "outcome": "passed", "keywords": ["test_subbyte_operands1", "__wrapped__", "__x_params_repr__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003850385546684265, "outcome": "passed"}, "call": {"duration": 0.13882987201213837, "outcome": "passed"}, "teardown": {"duration": 0.00022923853248357773, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_subbyte_operands2", "lineno": 587, "outcome": "passed", "keywords": ["test_subbyte_operands2", "__wrapped__", "__x_params_repr__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00038153398782014847, "outcome": "passed"}, "call": {"duration": 0.13734587002545595, "outcome": "passed"}, "teardown": {"duration": 0.00022980943322181702, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_subbyte_operands3", "lineno": 587, "outcome": "passed", "keywords": ["test_subbyte_operands3", "__wrapped__", "__x_params_repr__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00037786923348903656, "outcome": "passed"}, "call": {"duration": 0.1344887875020504, "outcome": "passed"}, "teardown": {"duration": 0.00023270398378372192, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_subbyte_operands4", "lineno": 587, "outcome": "passed", "keywords": ["test_subbyte_operands4", "__wrapped__", "__x_params_repr__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00038072187453508377, "outcome": "passed"}, "call": {"duration": 0.13740575779229403, "outcome": "passed"}, "teardown": {"duration": 0.00023221317678689957, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_subbyte_results0", "lineno": 617, "outcome": "passed", "keywords": ["test_subbyte_results0", "__wrapped__", "__x_params_repr__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003821849822998047, "outcome": "passed"}, "call": {"duration": 0.13234720472246408, "outcome": "passed"}, "teardown": {"duration": 0.00012157950550317764, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_subbyte_results1", "lineno": 617, "outcome": "passed", "keywords": ["test_subbyte_results1", "__wrapped__", "__x_params_repr__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018999073654413223, "outcome": "passed"}, "call": {"duration": 0.12385680247098207, "outcome": "passed"}, "teardown": {"duration": 0.0002332739531993866, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_subbyte_results2", "lineno": 617, "outcome": "passed", "keywords": ["test_subbyte_results2", "__wrapped__", "__x_params_repr__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00038443785160779953, "outcome": "passed"}, "call": {"duration": 0.13385022524744272, "outcome": "passed"}, "teardown": {"duration": 0.0002302303910255432, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_subbyte_results3", "lineno": 617, "outcome": "passed", "keywords": ["test_subbyte_results3", "__wrapped__", "__x_params_repr__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003856290131807327, "outcome": "passed"}, "call": {"duration": 0.1382029950618744, "outcome": "passed"}, "teardown": {"duration": 0.00023460574448108673, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PythonCallbackTest::test_subbyte_results4", "lineno": 617, "outcome": "passed", "keywords": ["test_subbyte_results4", "__wrapped__", "__x_params_repr__", "PythonCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00038263481110334396, "outcome": "passed"}, "call": {"duration": 0.13771585654467344, "outcome": "passed"}, "teardown": {"duration": 0.00028456002473831177, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_array_layout_is_preserved", "lineno": 973, "outcome": "passed", "keywords": ["test_array_layout_is_preserved", "PureCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004791179671883583, "outcome": "passed"}, "call": {"duration": 0.13020339887589216, "outcome": "passed"}, "teardown": {"duration": 0.00023819133639335632, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_async_deadlock", "lineno": 1103, "outcome": "skipped", "keywords": ["test_async_deadlock", "__wrapped__", "PureCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003860611468553543, "outcome": "passed"}, "call": {"duration": 0.0008659781888127327, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py', 1104, \"Skipped: test_async_deadlock not supported on device with tags {'rocm', 'gpu'}.\")"}, "teardown": {"duration": 0.00019781198352575302, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_callback_inside_of_cond", "lineno": 874, "outcome": "passed", "keywords": ["test_callback_inside_of_cond", "PureCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003370577469468117, "outcome": "passed"}, "call": {"duration": 0.08453707955777645, "outcome": "passed"}, "teardown": {"duration": 0.00011957529932260513, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_callback_inside_of_pmap", "lineno": 938, "outcome": "passed", "keywords": ["test_callback_inside_of_pmap", "PureCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018459279090166092, "outcome": "passed"}, "call": {"duration": 0.05683257430791855, "outcome": "passed"}, "teardown": {"duration": 0.00011756271123886108, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_callback_inside_of_scan", "lineno": 898, "outcome": "passed", "keywords": ["test_callback_inside_of_scan", "PureCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00017987657338380814, "outcome": "passed"}, "call": {"duration": 0.04659639298915863, "outcome": "passed"}, "teardown": {"duration": 0.00011523999273777008, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_callback_inside_of_while_loop", "lineno": 915, "outcome": "passed", "keywords": ["test_callback_inside_of_while_loop", "PureCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001800553873181343, "outcome": "passed"}, "call": {"duration": 0.09903159085661173, "outcome": "passed"}, "teardown": {"duration": 0.00012114923447370529, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_callback_with_immediate_executable_destruction", "lineno": 954, "outcome": "passed", "keywords": ["test_callback_with_immediate_executable_destruction", "PureCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001866556704044342, "outcome": "passed"}, "call": {"duration": 0.2223893664777279, "outcome": "passed"}, "teardown": {"duration": 0.00012948084622621536, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_can_dce_pure_callback", "lineno": 692, "outcome": "passed", "keywords": ["test_can_dce_pure_callback", "PureCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019314512610435486, "outcome": "passed"}, "call": {"duration": 0.13170597702264786, "outcome": "passed"}, "teardown": {"duration": 0.00012551527470350266, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_can_pmap_pure_callback", "lineno": 811, "outcome": "passed", "keywords": ["test_can_pmap_pure_callback", "PureCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019014161080121994, "outcome": "passed"}, "call": {"duration": 0.07371163740754128, "outcome": "passed"}, "teardown": {"duration": 0.00019559822976589203, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_can_shard_pure_callback_manually", "lineno": 1038, "outcome": "passed", "keywords": ["test_can_shard_pure_callback_manually", "PureCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00032220594584941864, "outcome": "passed"}, "call": {"duration": 0.3270085724070668, "outcome": "passed"}, "teardown": {"duration": 0.0001285197213292122, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_can_shard_pure_callback_maximally", "lineno": 981, "outcome": "passed", "keywords": ["test_can_shard_pure_callback_maximally", "PureCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019102171063423157, "outcome": "passed"}, "call": {"duration": 84.92519763857126, "outcome": "passed", "stderr": "W1120 01:17:57.034262 2657084 spmd_partitioner.cc:654] [SPMD] Involuntary full rematerialization. The compiler cannot go from sharding {devices=[8]<=[8]} to {maximal device=0} efficiently for HLO operation %param = f32[1]{0} parameter(0), sharding={devices=[8]<=[8]}, metadata={op_name=\"x\"}. As the last resort, SPMD will replicate the tensor and then partition it to obtain the target sharding, which is inefficient. This issue will be fixed by Shardy partitioner in the future, which is tracked in b/433785288. Contact Shardy or XLA team for help.\nW1120 01:17:57.034353 2657084 spmd_partitioner.cc:654] [SPMD] Involuntary full rematerialization. The compiler cannot go from sharding {maximal device=0} to {devices=[8]<=[8]} efficiently for HLO operation %get-tuple-element = f32[8]{0} get-tuple-element(%conditional), index=0, sharding={maximal device=0}. As the last resort, SPMD will replicate the tensor and then partition it to obtain the target sharding, which is inefficient. This issue will be fixed by Shardy partitioner in the future, which is tracked in b/433785288. Contact Shardy or XLA team for help.\nE1120 01:18:07.175278 2657807 rendezvous.cc:92] [id=2] This thread has been waiting for `initialize clique for rank 2; clique=devices=[0,1,2,3,4,5,6,7]; is_p2p=0; groups=[[0,1,2,3,4,5,6,7]]; root_device=-1; num_local_participants=8; incarnations=[]; run_id=231479449` for 10 seconds and may be stuck. All 8 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:18:07.175295 2657804 rendezvous.cc:92] [id=5] This thread has been waiting for `initialize clique for rank 1; clique=devices=[0,1,2,3,4,5,6,7]; is_p2p=0; groups=[[0,1,2,3,4,5,6,7]]; root_device=-1; num_local_participants=8; incarnations=[]; run_id=231479449` for 10 seconds and may be stuck. All 8 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:18:07.175300 2657810 rendezvous.cc:92] [id=4] This thread has been waiting for `initialize clique for rank 3; clique=devices=[0,1,2,3,4,5,6,7]; is_p2p=0; groups=[[0,1,2,3,4,5,6,7]]; root_device=-1; num_local_participants=8; incarnations=[]; run_id=231479449` for 10 seconds and may be stuck. All 8 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:18:07.175316 2657822 rendezvous.cc:92] [id=1] This thread has been waiting for `initialize clique for rank 7; clique=devices=[0,1,2,3,4,5,6,7]; is_p2p=0; groups=[[0,1,2,3,4,5,6,7]]; root_device=-1; num_local_participants=8; incarnations=[]; run_id=231479449` for 10 seconds and may be stuck. All 8 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:18:07.175288 2657816 rendezvous.cc:92] [id=0] This thread has been waiting for `initialize clique for rank 5; clique=devices=[0,1,2,3,4,5,6,7]; is_p2p=0; groups=[[0,1,2,3,4,5,6,7]]; root_device=-1; num_local_participants=8; incarnations=[]; run_id=231479449` for 10 seconds and may be stuck. All 8 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:18:07.175320 2657819 rendezvous.cc:92] [id=6] This thread has been waiting for `initialize clique for rank 6; clique=devices=[0,1,2,3,4,5,6,7]; is_p2p=0; groups=[[0,1,2,3,4,5,6,7]]; root_device=-1; num_local_participants=8; incarnations=[]; run_id=231479449` for 10 seconds and may be stuck. All 8 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:18:07.175279 2657813 rendezvous.cc:92] [id=3] This thread has been waiting for `initialize clique for rank 4; clique=devices=[0,1,2,3,4,5,6,7]; is_p2p=0; groups=[[0,1,2,3,4,5,6,7]]; root_device=-1; num_local_participants=8; incarnations=[]; run_id=231479449` for 10 seconds and may be stuck. All 8 threads joined the rendezvous, however the leader has not marked the rendezvous as completed. Leader can be deadlocked inside the rendezvous callback.\nE1120 01:19:03.231955 2657810 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:19:03.231959 2657816 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:19:03.231956 2657822 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:19:03.231969 2657819 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:19:03.231966 2657804 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:19:03.231966 2657807 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\nE1120 01:19:03.231967 2657813 rendezvous.cc:110] Thread is unstuck! Warning above was a false-positive. Perhaps the timeout is too short.\n"}, "teardown": {"duration": 0.00020652543753385544, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_can_shard_pure_callback_maximally_with_sharding", "lineno": 1000, "outcome": "passed", "keywords": ["test_can_shard_pure_callback_maximally_with_sharding", "PureCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00032591260969638824, "outcome": "passed"}, "call": {"duration": 0.23788509238511324, "outcome": "passed", "stderr": "W1120 01:19:21.970195 2657084 spmd_partitioner.cc:654] [SPMD] Involuntary full rematerialization. The compiler cannot go from sharding {devices=[8]<=[8]} to {maximal device=7} efficiently for HLO operation %param = f32[1]{0} parameter(0), sharding={devices=[8]<=[8]}, metadata={op_name=\"x\"}. As the last resort, SPMD will replicate the tensor and then partition it to obtain the target sharding, which is inefficient. This issue will be fixed by Shardy partitioner in the future, which is tracked in b/433785288. Contact Shardy or XLA team for help.\nW1120 01:19:21.970280 2657084 spmd_partitioner.cc:654] [SPMD] Involuntary full rematerialization. The compiler cannot go from sharding {maximal device=7} to {devices=[8]<=[8]} efficiently for HLO operation %get-tuple-element = f32[8]{0} get-tuple-element(%conditional), index=0, sharding={maximal device=7}. As the last resort, SPMD will replicate the tensor and then partition it to obtain the target sharding, which is inefficient. This issue will be fixed by Shardy partitioner in the future, which is tracked in b/433785288. Contact Shardy or XLA team for help.\n"}, "teardown": {"duration": 0.00012867990881204605, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_can_take_grad_of_pure_callback_with_custom_jvp", "lineno": 856, "outcome": "passed", "keywords": ["test_can_take_grad_of_pure_callback_with_custom_jvp", "PureCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001900307834148407, "outcome": "passed"}, "call": {"duration": 0.1725592976436019, "outcome": "passed"}, "teardown": {"duration": 0.00012665800750255585, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_can_vmap_pure_callback", "lineno": 710, "outcome": "passed", "keywords": ["test_can_vmap_pure_callback", "PureCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001908615231513977, "outcome": "passed"}, "call": {"duration": 1.3940087435767055, "outcome": "passed"}, "teardown": {"duration": 0.00012072920799255371, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_cant_take_grad_of_pure_callback", "lineno": 819, "outcome": "passed", "keywords": ["test_cant_take_grad_of_pure_callback", "PureCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018739700317382812, "outcome": "passed"}, "call": {"duration": 0.00246328953653574, "outcome": "passed"}, "teardown": {"duration": 7.9338438808918e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_does_not_deadlock", "lineno": 1060, "outcome": "passed", "keywords": ["test_does_not_deadlock", "PureCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001500314101576805, "outcome": "passed"}, "call": {"duration": 0.5458432640880346, "outcome": "passed"}, "teardown": {"duration": 0.0002450719475746155, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_error_propagation", "lineno": 832, "outcome": "passed", "keywords": ["test_error_propagation", "PureCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003982996568083763, "outcome": "passed"}, "call": {"duration": 0.025527297519147396, "outcome": "passed", "stderr": "ERROR:2025-11-20 01:19:24,332:jax._src.callback:94: jax.pure_callback failed\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 92, in pure_callback_impl\n    return tree_util.tree_map(np.asarray, callback(*args))\n                                          ^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 70, in __call__\n    return tree_util.tree_leaves(self.callback_func(*args, **kwargs))\n                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\", line 835, in throws_error_fn\n    raise RuntimeError(\"Errors should propagate.\")\nRuntimeError: Errors should propagate.\nE1120 01:19:24.333211 2657084 pjrt_stream_executor_client.cc:2974] Execution of replica 0 failed: INTERNAL: CpuCallback error calling callback: Traceback (most recent call last):\n  File \"<frozen runpy>\", line 198, in _run_module_as_main\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/usr/local/lib/python3.12/dist-packages/pytest/__main__.py\", line 9, in <module>\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 221, in console_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 197, in main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 365, in pytest_cmdline_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 318, in wrap_session\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 372, in _main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 396, in pytest_runtestloop\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/pytest_rerunfailures.py\", line 593, in pytest_runtest_protocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 137, in runtestprotocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 244, in call_and_report\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 353, in from_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 245, in <lambda>\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 179, in pytest_runtest_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/unittest.py\", line 389, in runtest\n  File \"/usr/lib/python3.12/unittest/case.py\", line 690, in __call__\n  File \"/usr/lib/python3.12/unittest/case.py\", line 634, in run\n  File \"/usr/lib/python3.12/unittest/case.py\", line 589, in _callTestMethod\n  File \"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\", line 842, in test_error_propagation\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/traceback_util.py\", line 180, in reraise_with_filtered_traceback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 263, in cache_miss\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 146, in _python_pjit_helper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 1622, in _pjit_call_impl_python\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/profiler.py\", line 359, in wrapper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py\", line 1371, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 784, in _wrapped_callback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 223, in _callback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 95, in pure_callback_impl\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 70, in __call__\n  File \"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\", line 835, in throws_error_fn\nRuntimeError: Errors should propagate.\n", "log": [{"name": "jax._src.callback", "msg": "jax.pure_callback failed", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py", "filename": "callback.py", "module": "callback", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 92, in pure_callback_impl\n    return tree_util.tree_map(np.asarray, callback(*args))\n                                          ^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 70, in __call__\n    return tree_util.tree_leaves(self.callback_func(*args, **kwargs))\n                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\", line 835, in throws_error_fn\n    raise RuntimeError(\"Errors should propagate.\")\nRuntimeError: Errors should propagate.", "stack_info": null, "lineno": 94, "funcName": "pure_callback_impl", "created": 1763601564.3324609, "msecs": 332.0, "relativeCreated": 128387.72082328796, "thread": 140447195406656, "threadName": "MainThread", "processName": "MainProcess", "process": 2657084, "taskName": null, "asctime": "2025-11-20 01:19:24,332"}]}, "teardown": {"duration": 0.003097115084528923, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_pure_callback_fastpath", "lineno": 1127, "outcome": "passed", "keywords": ["test_pure_callback_fastpath", "PureCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00038552843034267426, "outcome": "passed"}, "call": {"duration": 0.025003003887832165, "outcome": "passed"}, "teardown": {"duration": 0.00017419736832380295, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_pure_callback_passes_jax_arrays_without_jit", "lineno": 682, "outcome": "passed", "keywords": ["test_pure_callback_passes_jax_arrays_without_jit", "PureCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0002993922680616379, "outcome": "passed"}, "call": {"duration": 0.0276222825050354, "outcome": "passed"}, "teardown": {"duration": 9.633228182792664e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_reentrant_error_propagation", "lineno": 843, "outcome": "passed", "keywords": ["test_reentrant_error_propagation", "PureCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00017138291150331497, "outcome": "passed"}, "call": {"duration": 0.15494171250611544, "outcome": "passed", "stderr": "ERROR:2025-11-20 01:19:24,547:jax._src.callback:94: jax.pure_callback failed\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 92, in pure_callback_impl\n    return tree_util.tree_map(np.asarray, callback(*args))\n                                          ^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 70, in __call__\n    return tree_util.tree_leaves(self.callback_func(*args, **kwargs))\n                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/stages.py\", line 849, in __call__\n    return self._call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py\", line 3277, in aot_cache_miss\n    outs, out_flat, args_flat = stages.Compiled.call(params, *args, **kwargs)\n                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/stages.py\", line 826, in call\n    lo_outs = params.executable.call(*params.const_args, *args_flat)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py\", line 3257, in call\n    check_array_xla_sharding_layout_match(\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py\", line 3415, in check_array_xla_sharding_layout_match\n    raise ValueError(\nValueError: Computation was compiled for input shardings that disagree with the shardings of arguments passed to it. Here are the 1 mismatches:\nArgument x with shape float32[]:\n  Passed sharding: SingleDeviceSharding(device=CpuDevice(id=0), memory_kind=device)\n  Required sharding: SingleDeviceSharding(device=RocmDevice(id=0), memory_kind=device)\nE1120 01:19:24.549060 2657084 pjrt_stream_executor_client.cc:2974] Execution of replica 0 failed: INTERNAL: CpuCallback error calling callback: Traceback (most recent call last):\n  File \"<frozen runpy>\", line 198, in _run_module_as_main\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/usr/local/lib/python3.12/dist-packages/pytest/__main__.py\", line 9, in <module>\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 221, in console_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 197, in main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 365, in pytest_cmdline_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 318, in wrap_session\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 372, in _main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 396, in pytest_runtestloop\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/pytest_rerunfailures.py\", line 593, in pytest_runtest_protocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 137, in runtestprotocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 244, in call_and_report\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 353, in from_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 245, in <lambda>\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 179, in pytest_runtest_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/unittest.py\", line 389, in runtest\n  File \"/usr/lib/python3.12/unittest/case.py\", line 690, in __call__\n  File \"/usr/lib/python3.12/unittest/case.py\", line 634, in run\n  File \"/usr/lib/python3.12/unittest/case.py\", line 589, in _callTestMethod\n  File \"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\", line 852, in test_reentrant_error_propagation\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/traceback_util.py\", line 180, in reraise_with_filtered_traceback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 263, in cache_miss\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 146, in _python_pjit_helper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 1622, in _pjit_call_impl_python\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/profiler.py\", line 359, in wrapper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py\", line 1371, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 784, in _wrapped_callback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 223, in _callback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 95, in pure_callback_impl\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 70, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/stages.py\", line 849, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py\", line 3277, in aot_cache_miss\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/stages.py\", line 826, in call\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py\", line 3257, in call\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py\", line 3415, in check_array_xla_sharding_layout_match\nValueError: Computation was compiled for input shardings that disagree with the shardings of arguments passed to it. Here are the 1 mismatches:\nArgument x with shape float32[]:\n  Passed sharding: SingleDeviceSharding(device=CpuDevice(id=0), memory_kind=device)\n  Required sharding: SingleDeviceSharding(device=RocmDevice(id=0), memory_kind=device)\n", "log": [{"name": "jax._src.callback", "msg": "jax.pure_callback failed", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py", "filename": "callback.py", "module": "callback", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 92, in pure_callback_impl\n    return tree_util.tree_map(np.asarray, callback(*args))\n                                          ^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 70, in __call__\n    return tree_util.tree_leaves(self.callback_func(*args, **kwargs))\n                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/stages.py\", line 849, in __call__\n    return self._call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py\", line 3277, in aot_cache_miss\n    outs, out_flat, args_flat = stages.Compiled.call(params, *args, **kwargs)\n                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/stages.py\", line 826, in call\n    lo_outs = params.executable.call(*params.const_args, *args_flat)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py\", line 3257, in call\n    check_array_xla_sharding_layout_match(\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py\", line 3415, in check_array_xla_sharding_layout_match\n    raise ValueError(\nValueError: Computation was compiled for input shardings that disagree with the shardings of arguments passed to it. Here are the 1 mismatches:\nArgument x with shape float32[]:\n  Passed sharding: SingleDeviceSharding(device=CpuDevice(id=0), memory_kind=device)\n  Required sharding: SingleDeviceSharding(device=RocmDevice(id=0), memory_kind=device)", "stack_info": null, "lineno": 94, "funcName": "pure_callback_impl", "created": 1763601564.547949, "msecs": 547.0, "relativeCreated": 128603.20901870728, "thread": 140447195406656, "threadName": "MainThread", "processName": "MainProcess", "process": 2657084, "taskName": null, "asctime": "2025-11-20 01:19:24,547"}]}, "teardown": {"duration": 0.002590877003967762, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_vmap_method_broadcast_all", "lineno": 1091, "outcome": "passed", "keywords": ["test_vmap_method_broadcast_all", "PureCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019818264991044998, "outcome": "passed"}, "call": {"duration": 0.2861930802464485, "outcome": "passed"}, "teardown": {"duration": 0.00019308459013700485, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_vmap_method_expand_dims", "lineno": 1080, "outcome": "passed", "keywords": ["test_vmap_method_expand_dims", "PureCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003209635615348816, "outcome": "passed"}, "call": {"duration": 0.32906205486506224, "outcome": "passed"}, "teardown": {"duration": 0.00022756587713956833, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_vmap_method_raise", "lineno": 1072, "outcome": "passed", "keywords": ["test_vmap_method_raise", "PureCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00038997549563646317, "outcome": "passed"}, "call": {"duration": 0.0022833431139588356, "outcome": "passed"}, "teardown": {"duration": 0.000185464508831501, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_vmap_vectorized_callback", "lineno": 756, "outcome": "passed", "keywords": ["test_vmap_vectorized_callback", "PureCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003344239667057991, "outcome": "passed"}, "call": {"duration": 0.4290072685107589, "outcome": "passed"}, "teardown": {"duration": 0.00022532325237989426, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::PureCallbackTest::test_vmap_vectorized_callback_errors_if_returns_wrong_shape", "lineno": 796, "outcome": "passed", "keywords": ["test_vmap_vectorized_callback_errors_if_returns_wrong_shape", "PureCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.000385308638215065, "outcome": "passed"}, "call": {"duration": 0.025850806385278702, "outcome": "passed", "stderr": "E1120 01:19:25.631015 2657084 pjrt_stream_executor_client.cc:2974] Execution of replica 0 failed: INTERNAL: CpuCallback error calling callback: Traceback (most recent call last):\n  File \"<frozen runpy>\", line 198, in _run_module_as_main\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/usr/local/lib/python3.12/dist-packages/pytest/__main__.py\", line 9, in <module>\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 221, in console_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/config/__init__.py\", line 197, in main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 365, in pytest_cmdline_main\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 318, in wrap_session\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 372, in _main\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/main.py\", line 396, in pytest_runtestloop\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/pytest_rerunfailures.py\", line 593, in pytest_runtest_protocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 137, in runtestprotocol\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 244, in call_and_report\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 353, in from_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 245, in <lambda>\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_hooks.py\", line 512, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_manager.py\", line 120, in _hookexec\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 121, in _multicall\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/runner.py\", line 179, in pytest_runtest_call\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/unittest.py\", line 389, in runtest\n  File \"/usr/lib/python3.12/unittest/case.py\", line 690, in __call__\n  File \"/usr/lib/python3.12/unittest/case.py\", line 634, in run\n  File \"/usr/lib/python3.12/unittest/case.py\", line 589, in _callTestMethod\n  File \"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\", line 809, in test_vmap_vectorized_callback_errors_if_returns_wrong_shape\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/traceback_util.py\", line 180, in reraise_with_filtered_traceback\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 263, in cache_miss\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 146, in _python_pjit_helper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/pjit.py\", line 1622, in _pjit_call_impl_python\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/profiler.py\", line 359, in wrapper\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/interpreters/pxla.py\", line 1371, in __call__\n  File \"/usr/local/lib/python3.12/dist-packages/jax/_src/callback.py\", line 793, in _wrapped_callback\nRuntimeError: Incorrect output shape for return value #0: Expected: (4,), Actual: ()\n"}, "teardown": {"duration": 0.00014001689851284027, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_batching_with_side_effects", "lineno": 1426, "outcome": "passed", "keywords": ["test_batching_with_side_effects", "IOCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00020752567797899246, "outcome": "passed"}, "call": {"duration": 0.18816068209707737, "outcome": "passed"}, "teardown": {"duration": 0.00012662820518016815, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_batching_with_side_effects_while_loop", "lineno": 1442, "outcome": "passed", "keywords": ["test_batching_with_side_effects_while_loop", "IOCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019517820328474045, "outcome": "passed"}, "call": {"duration": 0.18529318552464247, "outcome": "passed"}, "teardown": {"duration": 0.00012423284351825714, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_can_shard_io_callback_manually_multi_device", "lineno": 1387, "outcome": "passed", "keywords": ["test_can_shard_io_callback_manually_multi_device", "__wrapped__", "__x_use_name__", "IOCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001873467117547989, "outcome": "passed"}, "call": {"duration": 0.790413249284029, "outcome": "passed"}, "teardown": {"duration": 0.0002442309632897377, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_can_shard_io_callback_manually_single_device", "lineno": 1387, "outcome": "passed", "keywords": ["test_can_shard_io_callback_manually_single_device", "__wrapped__", "__x_use_name__", "IOCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00040588993579149246, "outcome": "passed"}, "call": {"duration": 0.35544279124587774, "outcome": "passed"}, "teardown": {"duration": 0.00022977963089942932, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_can_use_io_callback_in_pjit_ordered=False_with_sharding=False", "lineno": 1262, "outcome": "passed", "keywords": ["test_can_use_io_callback_in_pjit_ordered=False_with_sharding=False", "__wrapped__", "__x_use_name__", "IOCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00039396248757839203, "outcome": "passed"}, "call": {"duration": 0.6289302734658122, "outcome": "passed", "stderr": "W1120 01:19:27.213825 2657084 spmd_partitioner.cc:654] [SPMD] Involuntary full rematerialization. The compiler cannot go from sharding {devices=[8]<=[8]} to {maximal device=0} efficiently for HLO operation %param = s32[1]{0} parameter(0), sharding={devices=[8]<=[8]}, metadata={op_name=\"x\"}. As the last resort, SPMD will replicate the tensor and then partition it to obtain the target sharding, which is inefficient. This issue will be fixed by Shardy partitioner in the future, which is tracked in b/433785288. Contact Shardy or XLA team for help.\nW1120 01:19:27.213922 2657084 spmd_partitioner.cc:654] [SPMD] Involuntary full rematerialization. The compiler cannot go from sharding {devices=[8]<=[8]} to {maximal device=0} efficiently for HLO operation %add.0 = s32[1]{0} add(%param, %broadcast.0), sharding={devices=[8]<=[8]}, metadata={op_name=\"jit(f)/add\" source_file=\"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\" source_line=1295 source_end_line=1295 source_column=29 source_end_column=29}. As the last resort, SPMD will replicate the tensor and then partition it to obtain the target sharding, which is inefficient. This issue will be fixed by Shardy partitioner in the future, which is tracked in b/433785288. Contact Shardy or XLA team for help.\n"}, "teardown": {"duration": 0.00022019539028406143, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_can_use_io_callback_in_pjit_ordered=False_with_sharding=True", "lineno": 1262, "outcome": "passed", "keywords": ["test_can_use_io_callback_in_pjit_ordered=False_with_sharding=True", "__wrapped__", "__x_use_name__", "IOCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.000329076312482357, "outcome": "passed"}, "call": {"duration": 0.23879636730998755, "outcome": "passed", "stderr": "W1120 01:19:27.814247 2657084 spmd_partitioner.cc:654] [SPMD] Involuntary full rematerialization. The compiler cannot go from sharding {devices=[8]<=[8]} to {maximal device=7} efficiently for HLO operation %param = s32[1]{0} parameter(0), sharding={devices=[8]<=[8]}, metadata={op_name=\"x\"}. As the last resort, SPMD will replicate the tensor and then partition it to obtain the target sharding, which is inefficient. This issue will be fixed by Shardy partitioner in the future, which is tracked in b/433785288. Contact Shardy or XLA team for help.\nW1120 01:19:27.814334 2657084 spmd_partitioner.cc:654] [SPMD] Involuntary full rematerialization. The compiler cannot go from sharding {devices=[8]<=[8]} to {maximal device=7} efficiently for HLO operation %add.0 = s32[1]{0} add(%param, %broadcast.0), sharding={devices=[8]<=[8]}, metadata={op_name=\"jit(f)/add\" source_file=\"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\" source_line=1295 source_end_line=1295 source_column=29 source_end_column=29}. As the last resort, SPMD will replicate the tensor and then partition it to obtain the target sharding, which is inefficient. This issue will be fixed by Shardy partitioner in the future, which is tracked in b/433785288. Contact Shardy or XLA team for help.\n"}, "teardown": {"duration": 0.00021783262491226196, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_can_use_io_callback_in_pjit_ordered=True_with_sharding=False", "lineno": 1262, "outcome": "passed", "keywords": ["test_can_use_io_callback_in_pjit_ordered=True_with_sharding=False", "__wrapped__", "__x_use_name__", "IOCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003335028886795044, "outcome": "passed"}, "call": {"duration": 0.24110140278935432, "outcome": "passed", "stderr": "W1120 01:19:28.054630 2657084 spmd_partitioner.cc:654] [SPMD] Involuntary full rematerialization. The compiler cannot go from sharding {devices=[8]<=[8]} to {maximal device=0} efficiently for HLO operation %param = s32[1]{0} parameter(1), sharding={devices=[8]<=[8]}, metadata={op_name=\"x\"}. As the last resort, SPMD will replicate the tensor and then partition it to obtain the target sharding, which is inefficient. This issue will be fixed by Shardy partitioner in the future, which is tracked in b/433785288. Contact Shardy or XLA team for help.\nW1120 01:19:28.054721 2657084 spmd_partitioner.cc:654] [SPMD] Involuntary full rematerialization. The compiler cannot go from sharding {devices=[8]<=[8]} to {maximal device=0} efficiently for HLO operation %add.0 = s32[1]{0} add(%param, %broadcast.0), sharding={devices=[8]<=[8]}, metadata={op_name=\"jit(f)/add\" source_file=\"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\" source_line=1295 source_end_line=1295 source_column=29 source_end_column=29}. As the last resort, SPMD will replicate the tensor and then partition it to obtain the target sharding, which is inefficient. This issue will be fixed by Shardy partitioner in the future, which is tracked in b/433785288. Contact Shardy or XLA team for help.\n"}, "teardown": {"duration": 0.0002163304015994072, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_can_use_io_callback_in_pjit_ordered=True_with_sharding=True", "lineno": 1262, "outcome": "passed", "keywords": ["test_can_use_io_callback_in_pjit_ordered=True_with_sharding=True", "__wrapped__", "__x_use_name__", "IOCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018491316586732864, "outcome": "passed"}, "call": {"duration": 0.2774524185806513, "outcome": "passed", "stderr": "W1120 01:19:28.289201 2657084 spmd_partitioner.cc:654] [SPMD] Involuntary full rematerialization. The compiler cannot go from sharding {devices=[8]<=[8]} to {maximal device=7} efficiently for HLO operation %param = s32[1]{0} parameter(1), sharding={devices=[8]<=[8]}, metadata={op_name=\"x\"}. As the last resort, SPMD will replicate the tensor and then partition it to obtain the target sharding, which is inefficient. This issue will be fixed by Shardy partitioner in the future, which is tracked in b/433785288. Contact Shardy or XLA team for help.\nW1120 01:19:28.289290 2657084 spmd_partitioner.cc:654] [SPMD] Involuntary full rematerialization. The compiler cannot go from sharding {devices=[8]<=[8]} to {maximal device=7} efficiently for HLO operation %add.0 = s32[1]{0} add(%param, %broadcast.0), sharding={devices=[8]<=[8]}, metadata={op_name=\"jit(f)/add\" source_file=\"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\" source_line=1295 source_end_line=1295 source_column=29 source_end_column=29}. As the last resort, SPMD will replicate the tensor and then partition it to obtain the target sharding, which is inefficient. This issue will be fixed by Shardy partitioner in the future, which is tracked in b/433785288. Contact Shardy or XLA team for help.\n"}, "teardown": {"duration": 0.0002147667109966278, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_cannot_call_ordered_io_in_pmap", "lineno": 1184, "outcome": "skipped", "keywords": ["test_cannot_call_ordered_io_in_pmap", "IOCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00032600201666355133, "outcome": "passed"}, "call": {"duration": 0.000712832435965538, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py', 1185, 'Skipped: Test does not raise under pmap_shmap_merge=True')"}, "teardown": {"duration": 0.00015123281627893448, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_cannot_call_ordered_io_in_vmap", "lineno": 1194, "outcome": "passed", "keywords": ["test_cannot_call_ordered_io_in_vmap", "IOCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00027021951973438263, "outcome": "passed"}, "call": {"duration": 0.14940356090664864, "outcome": "passed"}, "teardown": {"duration": 0.00012073758989572525, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_cannot_use_io_callback_in_checkpoint", "lineno": 1251, "outcome": "passed", "keywords": ["test_cannot_use_io_callback_in_checkpoint", "IOCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00017637014389038086, "outcome": "passed"}, "call": {"duration": 0.00227158609777689, "outcome": "passed"}, "teardown": {"duration": 8.290167897939682e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_cannot_use_io_callback_in_jvp", "lineno": 1202, "outcome": "passed", "keywords": ["test_cannot_use_io_callback_in_jvp", "IOCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00014422275125980377, "outcome": "passed"}, "call": {"duration": 0.0006079487502574921, "outcome": "passed"}, "teardown": {"duration": 7.479172199964523e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_cannot_use_io_callback_in_linearize", "lineno": 1209, "outcome": "passed", "keywords": ["test_cannot_use_io_callback_in_linearize", "IOCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013560988008975983, "outcome": "passed"}, "call": {"duration": 0.0005138283595442772, "outcome": "passed"}, "teardown": {"duration": 7.104501128196716e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_cannot_use_io_callback_in_transpose", "lineno": 1216, "outcome": "passed", "keywords": ["test_cannot_use_io_callback_in_transpose", "IOCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00012927129864692688, "outcome": "passed"}, "call": {"duration": 0.010548862628638744, "outcome": "passed"}, "teardown": {"duration": 8.60169529914856e-05, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_cannot_vmap_of_cond_io_callback", "lineno": 1225, "outcome": "passed", "keywords": ["test_cannot_vmap_of_cond_io_callback", "IOCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00015332642942667007, "outcome": "passed"}, "call": {"duration": 0.27304275520145893, "outcome": "passed"}, "teardown": {"duration": 0.00011880602687597275, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_cannot_vmap_of_while_io_callback", "lineno": 1236, "outcome": "passed", "keywords": ["test_cannot_vmap_of_while_io_callback", "IOCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019093137234449387, "outcome": "passed"}, "call": {"duration": 0.1469495166093111, "outcome": "passed"}, "teardown": {"duration": 0.0002257833257317543, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_io_callback_can_be_batched_if_unordered", "lineno": 1167, "outcome": "passed", "keywords": ["test_io_callback_can_be_batched_if_unordered", "IOCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00038001127541065216, "outcome": "passed"}, "call": {"duration": 0.2411532485857606, "outcome": "passed"}, "teardown": {"duration": 0.00012168847024440765, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_io_callback_can_mutate_state", "lineno": 1151, "outcome": "passed", "keywords": ["test_io_callback_can_mutate_state", "IOCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001815175637602806, "outcome": "passed"}, "call": {"duration": 0.13721235282719135, "outcome": "passed"}, "teardown": {"duration": 0.00012235064059495926, "outcome": "passed"}}, {"nodeid": "tests/python_callback_test.py::IOCallbackTest::test_sequence_pjit_io_callback_ordered", "lineno": 1333, "outcome": "passed", "keywords": ["test_sequence_pjit_io_callback_ordered", "__wrapped__", "IOCallbackTest", "python_callback_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019305478781461716, "outcome": "passed"}, "call": {"duration": 18.10350294690579, "outcome": "passed", "stderr": "W1120 01:19:29.548215 2657084 spmd_partitioner.cc:654] [SPMD] Involuntary full rematerialization. The compiler cannot go from sharding {devices=[2]<=[2]} to {maximal device=0} efficiently for HLO operation %param = s32[1]{0} parameter(2), sharding={devices=[2]<=[2]}, metadata={op_name=\"x\"}. As the last resort, SPMD will replicate the tensor and then partition it to obtain the target sharding, which is inefficient. This issue will be fixed by Shardy partitioner in the future, which is tracked in b/433785288. Contact Shardy or XLA team for help.\nW1120 01:19:29.548362 2657084 spmd_partitioner.cc:654] [SPMD] Involuntary full rematerialization. The compiler cannot go from sharding {devices=[2]<=[2]} to {maximal device=0} efficiently for HLO operation %add.0 = s32[1]{0} add(%param, %broadcast.0), sharding={devices=[2]<=[2]}, metadata={op_name=\"jit(f_base)/add\" source_file=\"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\" source_line=1349 source_end_line=1349 source_column=32 source_end_column=32}. As the last resort, SPMD will replicate the tensor and then partition it to obtain the target sharding, which is inefficient. This issue will be fixed by Shardy partitioner in the future, which is tracked in b/433785288. Contact Shardy or XLA team for help.\nW1120 01:19:32.170662 2657084 spmd_partitioner.cc:654] [SPMD] Involuntary full rematerialization. The compiler cannot go from sharding {devices=[2]<=[2]} to {maximal device=0} efficiently for HLO operation %param = s32[1]{0} parameter(2), sharding={devices=[2]<=[2]}, metadata={op_name=\"x\"}. As the last resort, SPMD will replicate the tensor and then partition it to obtain the target sharding, which is inefficient. This issue will be fixed by Shardy partitioner in the future, which is tracked in b/433785288. Contact Shardy or XLA team for help.\nW1120 01:19:32.170834 2657084 spmd_partitioner.cc:654] [SPMD] Involuntary full rematerialization. The compiler cannot go from sharding {devices=[2]<=[2]} to {maximal device=0} efficiently for HLO operation %add.0 = s32[1]{0} add(%param, %broadcast.0), sharding={devices=[2]<=[2]}, metadata={op_name=\"jit(f_base)/add\" source_file=\"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\" source_line=1349 source_end_line=1349 source_column=32 source_end_column=32}. As the last resort, SPMD will replicate the tensor and then partition it to obtain the target sharding, which is inefficient. This issue will be fixed by Shardy partitioner in the future, which is tracked in b/433785288. Contact Shardy or XLA team for help.\nW1120 01:19:34.267743 2657084 spmd_partitioner.cc:654] [SPMD] Involuntary full rematerialization. The compiler cannot go from sharding {devices=[2]<=[2]} to {maximal device=0} efficiently for HLO operation %param = s32[1]{0} parameter(2), sharding={devices=[2]<=[2]}, metadata={op_name=\"x\"}. As the last resort, SPMD will replicate the tensor and then partition it to obtain the target sharding, which is inefficient. This issue will be fixed by Shardy partitioner in the future, which is tracked in b/433785288. Contact Shardy or XLA team for help.\nW1120 01:19:34.267937 2657084 spmd_partitioner.cc:654] [SPMD] Involuntary full rematerialization. The compiler cannot go from sharding {devices=[2]<=[2]} to {maximal device=0} efficiently for HLO operation %add.0 = s32[1]{0} add(%param, %broadcast.0), sharding={devices=[2]<=[2]}, metadata={op_name=\"jit(f_base)/add\" source_file=\"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\" source_line=1349 source_end_line=1349 source_column=32 source_end_column=32}. As the last resort, SPMD will replicate the tensor and then partition it to obtain the target sharding, which is inefficient. This issue will be fixed by Shardy partitioner in the future, which is tracked in b/433785288. Contact Shardy or XLA team for help.\nW1120 01:19:36.404418 2657084 spmd_partitioner.cc:654] [SPMD] Involuntary full rematerialization. The compiler cannot go from sharding {devices=[2]<=[2]} to {maximal device=0} efficiently for HLO operation %param = s32[1]{0} parameter(2), sharding={devices=[2]<=[2]}, metadata={op_name=\"x\"}. As the last resort, SPMD will replicate the tensor and then partition it to obtain the target sharding, which is inefficient. This issue will be fixed by Shardy partitioner in the future, which is tracked in b/433785288. Contact Shardy or XLA team for help.\nW1120 01:19:36.404606 2657084 spmd_partitioner.cc:654] [SPMD] Involuntary full rematerialization. The compiler cannot go from sharding {devices=[2]<=[2]} to {maximal device=0} efficiently for HLO operation %add.0 = s32[1]{0} add(%param, %broadcast.0), sharding={devices=[2]<=[2]}, metadata={op_name=\"jit(f_base)/add\" source_file=\"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\" source_line=1349 source_end_line=1349 source_column=32 source_end_column=32}. As the last resort, SPMD will replicate the tensor and then partition it to obtain the target sharding, which is inefficient. This issue will be fixed by Shardy partitioner in the future, which is tracked in b/433785288. Contact Shardy or XLA team for help.\nW1120 01:19:38.685743 2657084 spmd_partitioner.cc:654] [SPMD] Involuntary full rematerialization. The compiler cannot go from sharding {devices=[2]<=[2]} to {maximal device=0} efficiently for HLO operation %param = s32[1]{0} parameter(2), sharding={devices=[2]<=[2]}, metadata={op_name=\"x\"}. As the last resort, SPMD will replicate the tensor and then partition it to obtain the target sharding, which is inefficient. This issue will be fixed by Shardy partitioner in the future, which is tracked in b/433785288. Contact Shardy or XLA team for help.\nW1120 01:19:38.685916 2657084 spmd_partitioner.cc:654] [SPMD] Involuntary full rematerialization. The compiler cannot go from sharding {devices=[2]<=[2]} to {maximal device=0} efficiently for HLO operation %add.0 = s32[1]{0} add(%param, %broadcast.0), sharding={devices=[2]<=[2]}, metadata={op_name=\"jit(f_base)/add\" source_file=\"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\" source_line=1349 source_end_line=1349 source_column=32 source_end_column=32}. As the last resort, SPMD will replicate the tensor and then partition it to obtain the target sharding, which is inefficient. This issue will be fixed by Shardy partitioner in the future, which is tracked in b/433785288. Contact Shardy or XLA team for help.\nW1120 01:19:41.126268 2657084 spmd_partitioner.cc:654] [SPMD] Involuntary full rematerialization. The compiler cannot go from sharding {devices=[2]<=[2]} to {maximal device=0} efficiently for HLO operation %param = s32[1]{0} parameter(2), sharding={devices=[2]<=[2]}, metadata={op_name=\"x\"}. As the last resort, SPMD will replicate the tensor and then partition it to obtain the target sharding, which is inefficient. This issue will be fixed by Shardy partitioner in the future, which is tracked in b/433785288. Contact Shardy or XLA team for help.\nW1120 01:19:41.126442 2657084 spmd_partitioner.cc:654] [SPMD] Involuntary full rematerialization. The compiler cannot go from sharding {devices=[2]<=[2]} to {maximal device=0} efficiently for HLO operation %add.0 = s32[1]{0} add(%param, %broadcast.0), sharding={devices=[2]<=[2]}, metadata={op_name=\"jit(f_base)/add\" source_file=\"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\" source_line=1349 source_end_line=1349 source_column=32 source_end_column=32}. As the last resort, SPMD will replicate the tensor and then partition it to obtain the target sharding, which is inefficient. This issue will be fixed by Shardy partitioner in the future, which is tracked in b/433785288. Contact Shardy or XLA team for help.\nW1120 01:19:43.243742 2657084 spmd_partitioner.cc:654] [SPMD] Involuntary full rematerialization. The compiler cannot go from sharding {devices=[2]<=[2]} to {maximal device=0} efficiently for HLO operation %param = s32[1]{0} parameter(2), sharding={devices=[2]<=[2]}, metadata={op_name=\"x\"}. As the last resort, SPMD will replicate the tensor and then partition it to obtain the target sharding, which is inefficient. This issue will be fixed by Shardy partitioner in the future, which is tracked in b/433785288. Contact Shardy or XLA team for help.\nW1120 01:19:43.243946 2657084 spmd_partitioner.cc:654] [SPMD] Involuntary full rematerialization. The compiler cannot go from sharding {devices=[2]<=[2]} to {maximal device=0} efficiently for HLO operation %add.0 = s32[1]{0} add(%param, %broadcast.0), sharding={devices=[2]<=[2]}, metadata={op_name=\"jit(f_base)/add\" source_file=\"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\" source_line=1349 source_end_line=1349 source_column=32 source_end_column=32}. As the last resort, SPMD will replicate the tensor and then partition it to obtain the target sharding, which is inefficient. This issue will be fixed by Shardy partitioner in the future, which is tracked in b/433785288. Contact Shardy or XLA team for help.\nW1120 01:19:45.369500 2657084 spmd_partitioner.cc:654] [SPMD] Involuntary full rematerialization. The compiler cannot go from sharding {devices=[2]<=[2]} to {maximal device=0} efficiently for HLO operation %param = s32[1]{0} parameter(2), sharding={devices=[2]<=[2]}, metadata={op_name=\"x\"}. As the last resort, SPMD will replicate the tensor and then partition it to obtain the target sharding, which is inefficient. This issue will be fixed by Shardy partitioner in the future, which is tracked in b/433785288. Contact Shardy or XLA team for help.\nW1120 01:19:45.369671 2657084 spmd_partitioner.cc:654] [SPMD] Involuntary full rematerialization. The compiler cannot go from sharding {devices=[2]<=[2]} to {maximal device=0} efficiently for HLO operation %add.0 = s32[1]{0} add(%param, %broadcast.0), sharding={devices=[2]<=[2]}, metadata={op_name=\"jit(f_base)/add\" source_file=\"/dockerx/rocm/rocm-jax/jax/tests/python_callback_test.py\" source_line=1349 source_end_line=1349 source_column=32 source_end_column=32}. As the last resort, SPMD will replicate the tensor and then partition it to obtain the target sharding, which is inefficient. This issue will be fixed by Shardy partitioner in the future, which is tracked in b/433785288. Contact Shardy or XLA team for help.\n"}, "teardown": {"duration": 0.0008692536503076553, "outcome": "passed"}}]}