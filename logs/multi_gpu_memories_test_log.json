{"created": 1763599988.2399988, "duration": 62.505531787872314, "exitcode": 0, "root": "/dockerx/rocm/rocm-jax/jax", "environment": {}, "summary": {"passed": 87, "skipped": 18, "total": 105, "collected": 105}, "collectors": [{"nodeid": "", "outcome": "passed", "result": [{"nodeid": "tests/memories_test.py", "type": "Module"}]}, {"nodeid": "tests/memories_test.py::ShardingMemoriesTest", "outcome": "passed", "result": [{"nodeid": "tests/memories_test.py::ShardingMemoriesTest::test_canonicalize_memory_kind_gspmd_sharding", "type": "TestCaseFunction", "lineno": 66}, {"nodeid": "tests/memories_test.py::ShardingMemoriesTest::test_canonicalize_memory_kind_named_sharding", "type": "TestCaseFunction", "lineno": 66}, {"nodeid": "tests/memories_test.py::ShardingMemoriesTest::test_canonicalize_memory_kind_single_device_sharding", "type": "TestCaseFunction", "lineno": 66}, {"nodeid": "tests/memories_test.py::ShardingMemoriesTest::test_correct_tpu_memory_kind_gspmd_sharding", "type": "TestCaseFunction", "lineno": 110}, {"nodeid": "tests/memories_test.py::ShardingMemoriesTest::test_correct_tpu_memory_kind_named_sharding", "type": "TestCaseFunction", "lineno": 110}, {"nodeid": "tests/memories_test.py::ShardingMemoriesTest::test_correct_tpu_memory_kind_single_device_sharding", "type": "TestCaseFunction", "lineno": 110}, {"nodeid": "tests/memories_test.py::ShardingMemoriesTest::test_default_memory_kind", "type": "TestCaseFunction", "lineno": 165}, {"nodeid": "tests/memories_test.py::ShardingMemoriesTest::test_sharding_eq_gspmd_sharding", "type": "TestCaseFunction", "lineno": 128}, {"nodeid": "tests/memories_test.py::ShardingMemoriesTest::test_sharding_eq_named_sharding", "type": "TestCaseFunction", "lineno": 128}, {"nodeid": "tests/memories_test.py::ShardingMemoriesTest::test_sharding_eq_single_device_sharding", "type": "TestCaseFunction", "lineno": 128}, {"nodeid": "tests/memories_test.py::ShardingMemoriesTest::test_sharding_equivalent", "type": "TestCaseFunction", "lineno": 148}, {"nodeid": "tests/memories_test.py::ShardingMemoriesTest::test_wrong_memory_kind_gspmd_sharding", "type": "TestCaseFunction", "lineno": 84}, {"nodeid": "tests/memories_test.py::ShardingMemoriesTest::test_wrong_memory_kind_named_sharding", "type": "TestCaseFunction", "lineno": 84}, {"nodeid": "tests/memories_test.py::ShardingMemoriesTest::test_wrong_memory_kind_single_device_sharding", "type": "TestCaseFunction", "lineno": 84}]}, {"nodeid": "tests/memories_test.py::DevicePutTest", "outcome": "passed", "result": [{"nodeid": "tests/memories_test.py::DevicePutTest::test_close_over_host_constant_and_stream", "type": "TestCaseFunction", "lineno": 633}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_deepcopy", "type": "TestCaseFunction", "lineno": 622}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_different_device_and_memory_hbm_to_host0", "type": "TestCaseFunction", "lineno": 244}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_different_device_and_memory_hbm_to_host1", "type": "TestCaseFunction", "lineno": 244}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_different_device_and_memory_host_to_hbm0", "type": "TestCaseFunction", "lineno": 222}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_different_device_and_memory_host_to_hbm1", "type": "TestCaseFunction", "lineno": 222}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_hbm_to_host0", "type": "TestCaseFunction", "lineno": 205}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_hbm_to_host1", "type": "TestCaseFunction", "lineno": 205}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_host_to_hbm0", "type": "TestCaseFunction", "lineno": 189}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_host_to_hbm1", "type": "TestCaseFunction", "lineno": 189}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_inside_jit", "type": "TestCaseFunction", "lineno": 378}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_memory_space", "type": "TestCaseFunction", "lineno": 702}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_numpy_array0", "type": "TestCaseFunction", "lineno": 315}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_numpy_array1", "type": "TestCaseFunction", "lineno": 315}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_numpy_scalar0", "type": "TestCaseFunction", "lineno": 331}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_numpy_scalar1", "type": "TestCaseFunction", "lineno": 331}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_on_different_device_with_the_same_memory_kind0", "type": "TestCaseFunction", "lineno": 266}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_on_different_device_with_the_same_memory_kind1", "type": "TestCaseFunction", "lineno": 266}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_python_int0", "type": "TestCaseFunction", "lineno": 362}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_python_int1", "type": "TestCaseFunction", "lineno": 362}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_python_scalar0", "type": "TestCaseFunction", "lineno": 346}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_python_scalar1", "type": "TestCaseFunction", "lineno": 346}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_diff_mem_space_error", "type": "TestCaseFunction", "lineno": 551}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_disallow_alias_copies_arrays", "type": "TestCaseFunction", "lineno": 689}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_disallow_alias_copies_arrays_with_donated_input", "type": "TestCaseFunction", "lineno": 715}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_host_to_device_transfer", "type": "TestCaseFunction", "lineno": 730}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_identity_jit_host_to_device_and_vice_versa", "type": "TestCaseFunction", "lineno": 511}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_output_streaming", "type": "TestCaseFunction", "lineno": 567}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_output_streaming_inside_scan", "type": "TestCaseFunction", "lineno": 600}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_parameter_and_output_streaming_with_array", "type": "TestCaseFunction", "lineno": 459}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_parameter_and_output_streaming_with_scalar", "type": "TestCaseFunction", "lineno": 484}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_parameter_streaming", "type": "TestCaseFunction", "lineno": 392}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_parameter_streaming_inside_scan", "type": "TestCaseFunction", "lineno": 531}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_parameter_streaming_with_scalar_and_constant", "type": "TestCaseFunction", "lineno": 435}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_ragged_copy_on_host", "type": "TestCaseFunction", "lineno": 648}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_weight_offload_with_dp_on_output", "type": "TestCaseFunction", "lineno": 583}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_zero_size_parameter", "type": "TestCaseFunction", "lineno": 415}]}, {"nodeid": "tests/memories_test.py::ComputeOffload", "outcome": "passed", "result": [{"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_host_loop", "type": "TestCaseFunction", "lineno": 948}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_no_inputs", "type": "TestCaseFunction", "lineno": 764}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_no_inputs_host_replicated", "type": "TestCaseFunction", "lineno": 780}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_offload_inside_shmap", "type": "TestCaseFunction", "lineno": 1459}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_offload_mesh_with_linear_layout", "type": "TestCaseFunction", "lineno": 1631}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_offload_with_donation", "type": "TestCaseFunction", "lineno": 1557}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_offload_with_linear_layout", "type": "TestCaseFunction", "lineno": 1589}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_on_2d", "type": "TestCaseFunction", "lineno": 825}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_on_aot", "type": "TestCaseFunction", "lineno": 1701}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_on_basic", "type": "TestCaseFunction", "lineno": 796}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_on_basic_inline", "type": "TestCaseFunction", "lineno": 892}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_on_cache_miss", "type": "TestCaseFunction", "lineno": 1685}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_on_grad", "type": "TestCaseFunction", "lineno": 983}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_on_host_shared_sharding", "type": "TestCaseFunction", "lineno": 855}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_on_reduction", "type": "TestCaseFunction", "lineno": 915}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_on_remat", "type": "TestCaseFunction", "lineno": 1002}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_per_annotation", "type": "TestCaseFunction", "lineno": 1218}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_copy_offload0", "type": "TestCaseFunction", "lineno": 1167}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_copy_offload1", "type": "TestCaseFunction", "lineno": 1167}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_device_put_different_devices", "type": "TestCaseFunction", "lineno": 1335}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_eager_compute", "type": "TestCaseFunction", "lineno": 1211}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_host_offload_in_custom_vjp", "type": "TestCaseFunction", "lineno": 1075}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_host_offload_in_custom_vjp_sharded", "type": "TestCaseFunction", "lineno": 1105}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_identity_mem_kind_donation0", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_identity_mem_kind_donation1", "type": "TestCaseFunction", "lineno": 1539}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_indexing_on_host", "type": "TestCaseFunction", "lineno": 1672}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_int4_host_compute", "type": "TestCaseFunction", "lineno": 1734}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_jit_cache_hit_with_default_and_specified_mem_kind", "type": "TestCaseFunction", "lineno": 1393}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_jit_compilation_cache_hit", "type": "TestCaseFunction", "lineno": 1362}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_jit_cpp_cache_hit", "type": "TestCaseFunction", "lineno": 1347}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_jit_cpp_cache_output_hit", "type": "TestCaseFunction", "lineno": 1381}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_jit_host_multi_outputs", "type": "TestCaseFunction", "lineno": 1236}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_jit_in_out_shardings", "type": "TestCaseFunction", "lineno": 1309}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_jit_in_shardings", "type": "TestCaseFunction", "lineno": 1279}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_jit_out_shardings_single_output", "type": "TestCaseFunction", "lineno": 1255}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_mem_kind_donation_pinned_host", "type": "TestCaseFunction", "lineno": 1518}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_nested_compute_error", "type": "TestCaseFunction", "lineno": 962}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_nested_no_op_compute", "type": "TestCaseFunction", "lineno": 1029}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_no_donation_across_memory_kinds", "type": "TestCaseFunction", "lineno": 1424}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_offload_take_host", "type": "TestCaseFunction", "lineno": 1717}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_pure_host_data_and_compute", "type": "TestCaseFunction", "lineno": 1189}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_qr_decomposition_offload", "type": "TestCaseFunction", "lineno": 1479}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_scan_offload", "type": "TestCaseFunction", "lineno": 1138}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_sharded_compute_on_host", "type": "TestCaseFunction", "lineno": 1054}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_sharding_devices_indices_map_cache_hit", "type": "TestCaseFunction", "lineno": 1411}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_single_mem_kind_donation_default_mem_kind", "type": "TestCaseFunction", "lineno": 1443}]}, {"nodeid": "tests/memories_test.py::StreamAnnotationTest", "outcome": "passed", "result": [{"nodeid": "tests/memories_test.py::StreamAnnotationTest::test_stream_annotation_inside_shmap", "type": "TestCaseFunction", "lineno": 1824}, {"nodeid": "tests/memories_test.py::StreamAnnotationTest::test_stream_annotation_single_instruction", "type": "TestCaseFunction", "lineno": 1756}, {"nodeid": "tests/memories_test.py::StreamAnnotationTest::test_streamed_gemm_overlap", "type": "TestCaseFunction", "lineno": 1783}]}, {"nodeid": "tests/memories_test.py::ActivationOffloadingTest", "outcome": "passed", "result": [{"nodeid": "tests/memories_test.py::ActivationOffloadingTest::test_primitive_with_multiple_outputs", "type": "TestCaseFunction", "lineno": 2031}, {"nodeid": "tests/memories_test.py::ActivationOffloadingTest::test_remat_checkpoint_dots_with_no_batch_dims", "type": "TestCaseFunction", "lineno": 2000}, {"nodeid": "tests/memories_test.py::ActivationOffloadingTest::test_remat_jaxpr_offloadable", "type": "TestCaseFunction", "lineno": 1866}, {"nodeid": "tests/memories_test.py::ActivationOffloadingTest::test_remat_scan_jaxpr_offloadable", "type": "TestCaseFunction", "lineno": 1907}, {"nodeid": "tests/memories_test.py::ActivationOffloadingTest::test_remat_scan_layout_change_offloadable", "type": "TestCaseFunction", "lineno": 1959}]}, {"nodeid": "tests/memories_test.py", "outcome": "passed", "result": [{"nodeid": "tests/memories_test.py::ShardingMemoriesTest", "type": "UnitTestCase"}, {"nodeid": "tests/memories_test.py::DevicePutTest", "type": "UnitTestCase"}, {"nodeid": "tests/memories_test.py::ComputeOffload", "type": "UnitTestCase"}, {"nodeid": "tests/memories_test.py::StreamAnnotationTest", "type": "UnitTestCase"}, {"nodeid": "tests/memories_test.py::ActivationOffloadingTest", "type": "UnitTestCase"}]}], "tests": [{"nodeid": "tests/memories_test.py::ShardingMemoriesTest::test_canonicalize_memory_kind_gspmd_sharding", "lineno": 66, "outcome": "passed", "keywords": ["test_canonicalize_memory_kind_gspmd_sharding", "__wrapped__", "__x_use_name__", "ShardingMemoriesTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00030629243701696396, "outcome": "passed"}, "call": {"duration": 12.214055622927845, "outcome": "passed"}, "teardown": {"duration": 0.0001400671899318695, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ShardingMemoriesTest::test_canonicalize_memory_kind_named_sharding", "lineno": 66, "outcome": "passed", "keywords": ["test_canonicalize_memory_kind_named_sharding", "__wrapped__", "__x_use_name__", "ShardingMemoriesTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0002062348648905754, "outcome": "passed"}, "call": {"duration": 0.0004954217001795769, "outcome": "passed"}, "teardown": {"duration": 7.904600352048874e-05, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ShardingMemoriesTest::test_canonicalize_memory_kind_single_device_sharding", "lineno": 66, "outcome": "passed", "keywords": ["test_canonicalize_memory_kind_single_device_sharding", "__wrapped__", "__x_use_name__", "ShardingMemoriesTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013960618525743484, "outcome": "passed"}, "call": {"duration": 0.0002949060872197151, "outcome": "passed"}, "teardown": {"duration": 6.971322000026703e-05, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ShardingMemoriesTest::test_correct_tpu_memory_kind_gspmd_sharding", "lineno": 110, "outcome": "skipped", "keywords": ["test_correct_tpu_memory_kind_gspmd_sharding", "__wrapped__", "__x_use_name__", "ShardingMemoriesTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013422872871160507, "outcome": "passed"}, "call": {"duration": 0.00037201959639787674, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/memories_test.py', 111, 'Skipped: TPU memory kind test.')"}, "teardown": {"duration": 8.751917630434036e-05, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ShardingMemoriesTest::test_correct_tpu_memory_kind_named_sharding", "lineno": 110, "outcome": "skipped", "keywords": ["test_correct_tpu_memory_kind_named_sharding", "__wrapped__", "__x_use_name__", "ShardingMemoriesTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001505427062511444, "outcome": "passed"}, "call": {"duration": 0.00032020267099142075, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/memories_test.py', 111, 'Skipped: TPU memory kind test.')"}, "teardown": {"duration": 7.764436304569244e-05, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ShardingMemoriesTest::test_correct_tpu_memory_kind_single_device_sharding", "lineno": 110, "outcome": "skipped", "keywords": ["test_correct_tpu_memory_kind_single_device_sharding", "__wrapped__", "__x_use_name__", "ShardingMemoriesTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.000144212506711483, "outcome": "passed"}, "call": {"duration": 0.00030130520462989807, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/memories_test.py', 111, 'Skipped: TPU memory kind test.')"}, "teardown": {"duration": 7.467996329069138e-05, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ShardingMemoriesTest::test_default_memory_kind", "lineno": 165, "outcome": "passed", "keywords": ["test_default_memory_kind", "ShardingMemoriesTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00015613064169883728, "outcome": "passed"}, "call": {"duration": 0.00029064901173114777, "outcome": "passed"}, "teardown": {"duration": 7.023289799690247e-05, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ShardingMemoriesTest::test_sharding_eq_gspmd_sharding", "lineno": 128, "outcome": "passed", "keywords": ["test_sharding_eq_gspmd_sharding", "__wrapped__", "__x_use_name__", "ShardingMemoriesTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013468880206346512, "outcome": "passed"}, "call": {"duration": 0.0003115301951766014, "outcome": "passed"}, "teardown": {"duration": 6.846152245998383e-05, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ShardingMemoriesTest::test_sharding_eq_named_sharding", "lineno": 128, "outcome": "passed", "keywords": ["test_sharding_eq_named_sharding", "__wrapped__", "__x_use_name__", "ShardingMemoriesTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013139378279447556, "outcome": "passed"}, "call": {"duration": 0.00031454581767320633, "outcome": "passed"}, "teardown": {"duration": 6.773043423891068e-05, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ShardingMemoriesTest::test_sharding_eq_single_device_sharding", "lineno": 128, "outcome": "passed", "keywords": ["test_sharding_eq_single_device_sharding", "__wrapped__", "__x_use_name__", "ShardingMemoriesTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013000331819057465, "outcome": "passed"}, "call": {"duration": 0.00028966832906007767, "outcome": "passed"}, "teardown": {"duration": 6.61676749587059e-05, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ShardingMemoriesTest::test_sharding_equivalent", "lineno": 148, "outcome": "passed", "keywords": ["test_sharding_equivalent", "ShardingMemoriesTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001360410824418068, "outcome": "passed"}, "call": {"duration": 0.00035366229712963104, "outcome": "passed"}, "teardown": {"duration": 6.791949272155762e-05, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ShardingMemoriesTest::test_wrong_memory_kind_gspmd_sharding", "lineno": 84, "outcome": "passed", "keywords": ["test_wrong_memory_kind_gspmd_sharding", "__wrapped__", "__x_use_name__", "ShardingMemoriesTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001290012151002884, "outcome": "passed"}, "call": {"duration": 0.00042052101343870163, "outcome": "passed"}, "teardown": {"duration": 6.787944585084915e-05, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ShardingMemoriesTest::test_wrong_memory_kind_named_sharding", "lineno": 84, "outcome": "passed", "keywords": ["test_wrong_memory_kind_named_sharding", "__wrapped__", "__x_use_name__", "ShardingMemoriesTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001331958919763565, "outcome": "passed"}, "call": {"duration": 0.000337088480591774, "outcome": "passed"}, "teardown": {"duration": 6.593670696020126e-05, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ShardingMemoriesTest::test_wrong_memory_kind_single_device_sharding", "lineno": 84, "outcome": "passed", "keywords": ["test_wrong_memory_kind_single_device_sharding", "__wrapped__", "__x_use_name__", "ShardingMemoriesTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001306626945734024, "outcome": "passed"}, "call": {"duration": 0.00039479322731494904, "outcome": "passed"}, "teardown": {"duration": 8.591637015342712e-05, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_close_over_host_constant_and_stream", "lineno": 633, "outcome": "passed", "keywords": ["test_close_over_host_constant_and_stream", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00016613584011793137, "outcome": "passed"}, "call": {"duration": 3.6264108838513494, "outcome": "passed"}, "teardown": {"duration": 0.00024461187422275543, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_deepcopy", "lineno": 622, "outcome": "passed", "keywords": ["test_deepcopy", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004134010523557663, "outcome": "passed"}, "call": {"duration": 0.8540906459093094, "outcome": "passed"}, "teardown": {"duration": 0.00020307954400777817, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_different_device_and_memory_hbm_to_host0", "lineno": 244, "outcome": "skipped", "keywords": ["test_device_put_different_device_and_memory_hbm_to_host0", "__wrapped__", "__x_params_repr__", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00036570988595485687, "outcome": "passed"}, "call": {"duration": 0.000868762843310833, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/memories_test.py', 245, 'Skipped: unpinned_host does not work on GPU backend.')"}, "teardown": {"duration": 0.00019330531358718872, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_different_device_and_memory_hbm_to_host1", "lineno": 244, "outcome": "passed", "keywords": ["test_device_put_different_device_and_memory_hbm_to_host1", "__wrapped__", "__x_params_repr__", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003515491262078285, "outcome": "passed"}, "call": {"duration": 0.1489100670441985, "outcome": "passed"}, "teardown": {"duration": 0.00024099647998809814, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_different_device_and_memory_host_to_hbm0", "lineno": 222, "outcome": "skipped", "keywords": ["test_device_put_different_device_and_memory_host_to_hbm0", "__wrapped__", "__x_params_repr__", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00041242875158786774, "outcome": "passed"}, "call": {"duration": 0.0009012613445520401, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/memories_test.py', 223, 'Skipped: unpinned_host does not work on GPU backend.')"}, "teardown": {"duration": 0.000187787227332592, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_different_device_and_memory_host_to_hbm1", "lineno": 222, "outcome": "passed", "keywords": ["test_device_put_different_device_and_memory_host_to_hbm1", "__wrapped__", "__x_params_repr__", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0007151253521442413, "outcome": "passed"}, "call": {"duration": 0.0017577670514583588, "outcome": "passed"}, "teardown": {"duration": 0.00018990132957696915, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_hbm_to_host0", "lineno": 205, "outcome": "skipped", "keywords": ["test_device_put_hbm_to_host0", "__wrapped__", "__x_params_repr__", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003391709178686142, "outcome": "passed"}, "call": {"duration": 0.0007734633982181549, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/memories_test.py', 206, 'Skipped: unpinned_host does not work on GPU backend.')"}, "teardown": {"duration": 0.00018132757395505905, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_hbm_to_host1", "lineno": 205, "outcome": "passed", "keywords": ["test_device_put_hbm_to_host1", "__wrapped__", "__x_params_repr__", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00033999234437942505, "outcome": "passed"}, "call": {"duration": 7.308481481857598, "outcome": "passed"}, "teardown": {"duration": 0.0002487683668732643, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_host_to_hbm0", "lineno": 189, "outcome": "skipped", "keywords": ["test_device_put_host_to_hbm0", "__wrapped__", "__x_params_repr__", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004227347671985626, "outcome": "passed"}, "call": {"duration": 0.0008713575080037117, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/memories_test.py', 190, 'Skipped: unpinned_host does not work on GPU backend.')"}, "teardown": {"duration": 0.0001962697133421898, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_host_to_hbm1", "lineno": 189, "outcome": "passed", "keywords": ["test_device_put_host_to_hbm1", "__wrapped__", "__x_params_repr__", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00033854972571134567, "outcome": "passed"}, "call": {"duration": 0.007428492419421673, "outcome": "passed"}, "teardown": {"duration": 0.00020410027354955673, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_inside_jit", "lineno": 378, "outcome": "passed", "keywords": ["test_device_put_inside_jit", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003667417913675308, "outcome": "passed"}, "call": {"duration": 0.29257905296981335, "outcome": "passed"}, "teardown": {"duration": 0.00023332424461841583, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_memory_space", "lineno": 702, "outcome": "passed", "keywords": ["test_device_put_memory_space", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00039102695882320404, "outcome": "passed"}, "call": {"duration": 0.17990284506231546, "outcome": "passed"}, "teardown": {"duration": 0.00023556780070066452, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_numpy_array0", "lineno": 315, "outcome": "skipped", "keywords": ["test_device_put_numpy_array0", "__wrapped__", "__x_params_repr__", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003849482163786888, "outcome": "passed"}, "call": {"duration": 0.0008454388007521629, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/memories_test.py', 316, 'Skipped: unpinned_host does not work on GPU backend.')"}, "teardown": {"duration": 0.0001830095425248146, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_numpy_array1", "lineno": 315, "outcome": "passed", "keywords": ["test_device_put_numpy_array1", "__wrapped__", "__x_params_repr__", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003322111442685127, "outcome": "passed"}, "call": {"duration": 0.02358474675565958, "outcome": "passed"}, "teardown": {"duration": 0.00020556338131427765, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_numpy_scalar0", "lineno": 331, "outcome": "skipped", "keywords": ["test_device_put_numpy_scalar0", "__wrapped__", "__x_params_repr__", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003558853641152382, "outcome": "passed"}, "call": {"duration": 0.0007923003286123276, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/memories_test.py', 332, 'Skipped: unpinned_host does not work on GPU backend.')"}, "teardown": {"duration": 0.00018484331667423248, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_numpy_scalar1", "lineno": 331, "outcome": "passed", "keywords": ["test_device_put_numpy_scalar1", "__wrapped__", "__x_params_repr__", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00033473409712314606, "outcome": "passed"}, "call": {"duration": 0.0026351017877459526, "outcome": "passed"}, "teardown": {"duration": 0.0002014869824051857, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_on_different_device_with_the_same_memory_kind0", "lineno": 266, "outcome": "skipped", "keywords": ["test_device_put_on_different_device_with_the_same_memory_kind0", "__wrapped__", "__x_params_repr__", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003395015373826027, "outcome": "passed"}, "call": {"duration": 0.0007454808801412582, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/memories_test.py', 267, 'Skipped: unpinned_host does not work on GPU backend.')"}, "teardown": {"duration": 0.00017881393432617188, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_on_different_device_with_the_same_memory_kind1", "lineno": 266, "outcome": "passed", "keywords": ["test_device_put_on_different_device_with_the_same_memory_kind1", "__wrapped__", "__x_params_repr__", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.000344960018992424, "outcome": "passed"}, "call": {"duration": 0.0029543843120336533, "outcome": "passed"}, "teardown": {"duration": 0.0001939656212925911, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_python_int0", "lineno": 362, "outcome": "skipped", "keywords": ["test_device_put_python_int0", "__wrapped__", "__x_params_repr__", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003338325768709183, "outcome": "passed"}, "call": {"duration": 0.0007419763132929802, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/memories_test.py', 363, 'Skipped: unpinned_host does not work on GPU backend.')"}, "teardown": {"duration": 0.00017819274216890335, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_python_int1", "lineno": 362, "outcome": "passed", "keywords": ["test_device_put_python_int1", "__wrapped__", "__x_params_repr__", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003292560577392578, "outcome": "passed"}, "call": {"duration": 0.0026403898373246193, "outcome": "passed"}, "teardown": {"duration": 0.00019568856805562973, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_python_scalar0", "lineno": 346, "outcome": "skipped", "keywords": ["test_device_put_python_scalar0", "__wrapped__", "__x_params_repr__", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00034903455525636673, "outcome": "passed"}, "call": {"duration": 0.000771339051425457, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/memories_test.py', 347, 'Skipped: unpinned_host does not work on GPU backend.')"}, "teardown": {"duration": 0.00018380116671323776, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_device_put_python_scalar1", "lineno": 346, "outcome": "passed", "keywords": ["test_device_put_python_scalar1", "__wrapped__", "__x_params_repr__", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00033866148442029953, "outcome": "passed"}, "call": {"duration": 0.0023250533267855644, "outcome": "passed"}, "teardown": {"duration": 0.00019493792206048965, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_diff_mem_space_error", "lineno": 551, "outcome": "passed", "keywords": ["test_diff_mem_space_error", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00034766271710395813, "outcome": "passed"}, "call": {"duration": 0.007072496227920055, "outcome": "passed"}, "teardown": {"duration": 0.00016165897250175476, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_disallow_alias_copies_arrays", "lineno": 689, "outcome": "passed", "keywords": ["test_disallow_alias_copies_arrays", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00029316265136003494, "outcome": "passed"}, "call": {"duration": 0.0012888340279459953, "outcome": "passed"}, "teardown": {"duration": 0.00014861859381198883, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_disallow_alias_copies_arrays_with_donated_input", "lineno": 715, "outcome": "passed", "keywords": ["test_disallow_alias_copies_arrays_with_donated_input", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0002624988555908203, "outcome": "passed"}, "call": {"duration": 0.03517639730125666, "outcome": "passed"}, "teardown": {"duration": 0.00010421406477689743, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_host_to_device_transfer", "lineno": 730, "outcome": "passed", "keywords": ["test_host_to_device_transfer", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00017385557293891907, "outcome": "passed"}, "call": {"duration": 0.3720222944393754, "outcome": "passed"}, "teardown": {"duration": 0.00024123676121234894, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_identity_jit_host_to_device_and_vice_versa", "lineno": 511, "outcome": "passed", "keywords": ["test_identity_jit_host_to_device_and_vice_versa", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00039585400372743607, "outcome": "passed"}, "call": {"duration": 0.3065874744206667, "outcome": "passed"}, "teardown": {"duration": 0.000241878442466259, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_output_streaming", "lineno": 567, "outcome": "passed", "keywords": ["test_output_streaming", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00039657577872276306, "outcome": "passed"}, "call": {"duration": 0.15908994432538748, "outcome": "passed"}, "teardown": {"duration": 0.0002612154930830002, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_output_streaming_inside_scan", "lineno": 600, "outcome": "passed", "keywords": ["test_output_streaming_inside_scan", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00045045558363199234, "outcome": "passed"}, "call": {"duration": 0.21087686531245708, "outcome": "passed"}, "teardown": {"duration": 0.00020378082990646362, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_parameter_and_output_streaming_with_array", "lineno": 459, "outcome": "passed", "keywords": ["test_parameter_and_output_streaming_with_array", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00033465493470430374, "outcome": "passed"}, "call": {"duration": 0.15405726060271263, "outcome": "passed"}, "teardown": {"duration": 0.00020539294928312302, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_parameter_and_output_streaming_with_scalar", "lineno": 484, "outcome": "passed", "keywords": ["test_parameter_and_output_streaming_with_scalar", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00033435411751270294, "outcome": "passed"}, "call": {"duration": 3.8426628783345222, "outcome": "passed"}, "teardown": {"duration": 0.00012284144759178162, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_parameter_streaming", "lineno": 392, "outcome": "passed", "keywords": ["test_parameter_streaming", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019522849470376968, "outcome": "passed"}, "call": {"duration": 0.18504852522164583, "outcome": "passed"}, "teardown": {"duration": 0.00020296964794397354, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_parameter_streaming_inside_scan", "lineno": 531, "outcome": "passed", "keywords": ["test_parameter_streaming_inside_scan", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00033607520163059235, "outcome": "passed"}, "call": {"duration": 0.19333462417125702, "outcome": "passed"}, "teardown": {"duration": 0.00012254063040018082, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_parameter_streaming_with_scalar_and_constant", "lineno": 435, "outcome": "passed", "keywords": ["test_parameter_streaming_with_scalar_and_constant", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019204430282115936, "outcome": "passed"}, "call": {"duration": 0.13616659399122, "outcome": "passed"}, "teardown": {"duration": 0.00012309197336435318, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_ragged_copy_on_host", "lineno": 648, "outcome": "skipped", "keywords": ["test_ragged_copy_on_host", "__wrapped__", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019350647926330566, "outcome": "passed"}, "call": {"duration": 0.00041167810559272766, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/memories_test.py', 649, \"Skipped: test_ragged_copy_on_host not supported on device with tags {'rocm', 'gpu'}.\")"}, "teardown": {"duration": 0.00010184012353420258, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_weight_offload_with_dp_on_output", "lineno": 583, "outcome": "passed", "keywords": ["test_weight_offload_with_dp_on_output", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00014073867350816727, "outcome": "passed"}, "call": {"duration": 0.1445449497550726, "outcome": "passed"}, "teardown": {"duration": 0.00012253131717443466, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::DevicePutTest::test_zero_size_parameter", "lineno": 415, "outcome": "skipped", "keywords": ["test_zero_size_parameter", "DevicePutTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019330624490976334, "outcome": "passed"}, "call": {"duration": 0.0004038773477077484, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/memories_test.py', 416, 'Skipped: This test does not work on GPU backend.')"}, "teardown": {"duration": 0.00010033883154392242, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_host_loop", "lineno": 948, "outcome": "passed", "keywords": ["test_compute_host_loop", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018375087529420853, "outcome": "passed"}, "call": {"duration": 0.898028046824038, "outcome": "passed"}, "teardown": {"duration": 0.0001299520954489708, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_no_inputs", "lineno": 764, "outcome": "passed", "keywords": ["test_compute_no_inputs", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001994352787733078, "outcome": "passed"}, "call": {"duration": 0.3541315384209156, "outcome": "passed"}, "teardown": {"duration": 0.00013109389692544937, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_no_inputs_host_replicated", "lineno": 780, "outcome": "passed", "keywords": ["test_compute_no_inputs_host_replicated", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019469764083623886, "outcome": "passed"}, "call": {"duration": 0.3781456481665373, "outcome": "passed"}, "teardown": {"duration": 0.00013030320405960083, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_offload_inside_shmap", "lineno": 1459, "outcome": "passed", "keywords": ["test_compute_offload_inside_shmap", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019483733922243118, "outcome": "passed"}, "call": {"duration": 0.15752870682626963, "outcome": "passed"}, "teardown": {"duration": 0.0001266971230506897, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_offload_mesh_with_linear_layout", "lineno": 1631, "outcome": "skipped", "keywords": ["test_compute_offload_mesh_with_linear_layout", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019697099924087524, "outcome": "passed"}, "call": {"duration": 0.00041144806891679764, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/memories_test.py', 1632, 'Skipped: GPU does not support tiling.')"}, "teardown": {"duration": 0.00015292596071958542, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_offload_with_donation", "lineno": 1557, "outcome": "passed", "keywords": ["test_compute_offload_with_donation", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00026355963200330734, "outcome": "passed"}, "call": {"duration": 0.5918563362210989, "outcome": "passed"}, "teardown": {"duration": 0.0002401452511548996, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_offload_with_linear_layout", "lineno": 1589, "outcome": "skipped", "keywords": ["test_compute_offload_with_linear_layout", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003962656483054161, "outcome": "passed"}, "call": {"duration": 0.0008565951138734818, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/memories_test.py', 1590, 'Skipped: GPU does not support tiling.')"}, "teardown": {"duration": 0.0001883283257484436, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_on_2d", "lineno": 825, "outcome": "passed", "keywords": ["test_compute_on_2d", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003238776698708534, "outcome": "passed"}, "call": {"duration": 0.7800770569592714, "outcome": "passed"}, "teardown": {"duration": 0.00013097375631332397, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_on_aot", "lineno": 1701, "outcome": "passed", "keywords": ["test_compute_on_aot", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001942673698067665, "outcome": "passed"}, "call": {"duration": 0.13538035284727812, "outcome": "passed"}, "teardown": {"duration": 0.00024138577282428741, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_on_basic", "lineno": 796, "outcome": "passed", "keywords": ["test_compute_on_basic", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00039140786975622177, "outcome": "passed"}, "call": {"duration": 0.47103693056851625, "outcome": "passed"}, "teardown": {"duration": 0.0002376008778810501, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_on_basic_inline", "lineno": 892, "outcome": "passed", "keywords": ["test_compute_on_basic_inline", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00038900505751371384, "outcome": "passed"}, "call": {"duration": 0.08012519776821136, "outcome": "passed"}, "teardown": {"duration": 0.00020961835980415344, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_on_cache_miss", "lineno": 1685, "outcome": "passed", "keywords": ["test_compute_on_cache_miss", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003266213461756706, "outcome": "passed"}, "call": {"duration": 0.4318679366260767, "outcome": "passed"}, "teardown": {"duration": 0.00023649912327528, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_on_grad", "lineno": 983, "outcome": "passed", "keywords": ["test_compute_on_grad", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003906469792127609, "outcome": "passed"}, "call": {"duration": 2.002347158268094, "outcome": "passed"}, "teardown": {"duration": 0.00012881029397249222, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_on_host_shared_sharding", "lineno": 855, "outcome": "passed", "keywords": ["test_compute_on_host_shared_sharding", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019139237701892853, "outcome": "passed"}, "call": {"duration": 0.8975038286298513, "outcome": "passed"}, "teardown": {"duration": 0.00012888014316558838, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_on_reduction", "lineno": 915, "outcome": "passed", "keywords": ["test_compute_on_reduction", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001932252198457718, "outcome": "passed"}, "call": {"duration": 0.6113087879493833, "outcome": "passed"}, "teardown": {"duration": 0.0002451827749609947, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_on_remat", "lineno": 1002, "outcome": "passed", "keywords": ["test_compute_on_remat", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00039238017052412033, "outcome": "passed"}, "call": {"duration": 0.32012859266251326, "outcome": "passed"}, "teardown": {"duration": 0.00024281814694404602, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_compute_per_annotation", "lineno": 1218, "outcome": "passed", "keywords": ["test_compute_per_annotation", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00039218924939632416, "outcome": "passed"}, "call": {"duration": 0.3250794755294919, "outcome": "passed"}, "teardown": {"duration": 0.00023997388780117035, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_copy_offload0", "lineno": 1167, "outcome": "passed", "keywords": ["test_copy_offload0", "__wrapped__", "__x_params_repr__", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003985892981290817, "outcome": "passed"}, "call": {"duration": 0.07174369785934687, "outcome": "passed"}, "teardown": {"duration": 0.0001956392079591751, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_copy_offload1", "lineno": 1167, "outcome": "passed", "keywords": ["test_copy_offload1", "__wrapped__", "__x_params_repr__", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003227759152650833, "outcome": "passed"}, "call": {"duration": 0.14355984423309565, "outcome": "passed"}, "teardown": {"duration": 0.00019947532564401627, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_device_put_different_devices", "lineno": 1335, "outcome": "passed", "keywords": ["test_device_put_different_devices", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003252904862165451, "outcome": "passed"}, "call": {"duration": 0.0031729573383927345, "outcome": "passed"}, "teardown": {"duration": 0.00015383679419755936, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_eager_compute", "lineno": 1211, "outcome": "passed", "keywords": ["test_eager_compute", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00029082968831062317, "outcome": "passed"}, "call": {"duration": 0.5983239877969027, "outcome": "passed"}, "teardown": {"duration": 0.0001297416165471077, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_host_offload_in_custom_vjp", "lineno": 1075, "outcome": "passed", "keywords": ["test_host_offload_in_custom_vjp", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00034473836421966553, "outcome": "passed"}, "call": {"duration": 0.47251164726912975, "outcome": "passed"}, "teardown": {"duration": 0.0002451324835419655, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_host_offload_in_custom_vjp_sharded", "lineno": 1105, "outcome": "passed", "keywords": ["test_host_offload_in_custom_vjp_sharded", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00039434246718883514, "outcome": "passed"}, "call": {"duration": 0.6338954279199243, "outcome": "passed"}, "teardown": {"duration": 0.0002438100054860115, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_identity_mem_kind_donation0", "lineno": 1539, "outcome": "passed", "keywords": ["test_identity_mem_kind_donation0", "__wrapped__", "__x_params_repr__", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00038744229823350906, "outcome": "passed"}, "call": {"duration": 0.1559234755113721, "outcome": "passed"}, "teardown": {"duration": 0.0002007652074098587, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_identity_mem_kind_donation1", "lineno": 1539, "outcome": "passed", "keywords": ["test_identity_mem_kind_donation1", "__wrapped__", "__x_params_repr__", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00033013802021741867, "outcome": "passed"}, "call": {"duration": 0.1500684069469571, "outcome": "passed"}, "teardown": {"duration": 0.0001974320039153099, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_indexing_on_host", "lineno": 1672, "outcome": "passed", "keywords": ["test_indexing_on_host", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003243992105126381, "outcome": "passed"}, "call": {"duration": 0.43539793882519007, "outcome": "passed"}, "teardown": {"duration": 0.00020308047533035278, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_int4_host_compute", "lineno": 1734, "outcome": "passed", "keywords": ["test_int4_host_compute", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.000322757288813591, "outcome": "passed"}, "call": {"duration": 0.4477567644789815, "outcome": "passed"}, "teardown": {"duration": 0.00024122651666402817, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_jit_cache_hit_with_default_and_specified_mem_kind", "lineno": 1393, "outcome": "passed", "keywords": ["test_jit_cache_hit_with_default_and_specified_mem_kind", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00038977526128292084, "outcome": "passed"}, "call": {"duration": 4.9800560139119625, "outcome": "passed"}, "teardown": {"duration": 0.0002476358786225319, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_jit_compilation_cache_hit", "lineno": 1362, "outcome": "skipped", "keywords": ["test_jit_compilation_cache_hit", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00039830803871154785, "outcome": "passed"}, "call": {"duration": 0.0008645569905638695, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/memories_test.py', 1363, \"Skipped: Shardy doesn't support GSPMDSharding\")"}, "teardown": {"duration": 0.00019156280905008316, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_jit_cpp_cache_hit", "lineno": 1347, "outcome": "passed", "keywords": ["test_jit_cpp_cache_hit", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00034056324511766434, "outcome": "passed"}, "call": {"duration": 0.059049918316304684, "outcome": "passed"}, "teardown": {"duration": 0.0002467753365635872, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_jit_cpp_cache_output_hit", "lineno": 1381, "outcome": "passed", "keywords": ["test_jit_cpp_cache_output_hit", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003897557035088539, "outcome": "passed"}, "call": {"duration": 0.15057766903191805, "outcome": "passed"}, "teardown": {"duration": 0.00020527280867099762, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_jit_host_multi_outputs", "lineno": 1236, "outcome": "passed", "keywords": ["test_jit_host_multi_outputs", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.000332660973072052, "outcome": "passed"}, "call": {"duration": 0.20734139997512102, "outcome": "passed"}, "teardown": {"duration": 0.00020958948880434036, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_jit_in_out_shardings", "lineno": 1309, "outcome": "passed", "keywords": ["test_jit_in_out_shardings", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00034966692328453064, "outcome": "passed"}, "call": {"duration": 8.1124781742692, "outcome": "passed"}, "teardown": {"duration": 0.00023831147700548172, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_jit_in_shardings", "lineno": 1279, "outcome": "passed", "keywords": ["test_jit_in_shardings", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003917692229151726, "outcome": "passed"}, "call": {"duration": 0.16972241550683975, "outcome": "passed"}, "teardown": {"duration": 0.00019648950546979904, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_jit_out_shardings_single_output", "lineno": 1255, "outcome": "passed", "keywords": ["test_jit_out_shardings_single_output", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00039054732769727707, "outcome": "passed"}, "call": {"duration": 0.36160215735435486, "outcome": "passed"}, "teardown": {"duration": 0.0002002660185098648, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_mem_kind_donation_pinned_host", "lineno": 1518, "outcome": "passed", "keywords": ["test_mem_kind_donation_pinned_host", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003262823447585106, "outcome": "passed"}, "call": {"duration": 0.16846912261098623, "outcome": "passed"}, "teardown": {"duration": 0.00020168814808130264, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_nested_compute_error", "lineno": 962, "outcome": "passed", "keywords": ["test_nested_compute_error", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003381893038749695, "outcome": "passed"}, "call": {"duration": 0.0028836289420723915, "outcome": "passed"}, "teardown": {"duration": 0.00015615113079547882, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_nested_no_op_compute", "lineno": 1029, "outcome": "passed", "keywords": ["test_nested_no_op_compute", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00028342846781015396, "outcome": "passed"}, "call": {"duration": 0.330378919839859, "outcome": "passed"}, "teardown": {"duration": 0.00024216808378696442, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_no_donation_across_memory_kinds", "lineno": 1424, "outcome": "passed", "keywords": ["test_no_donation_across_memory_kinds", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00040147267282009125, "outcome": "passed"}, "call": {"duration": 0.17228990700095892, "outcome": "passed"}, "teardown": {"duration": 0.0001238035038113594, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_offload_take_host", "lineno": 1717, "outcome": "passed", "keywords": ["test_offload_take_host", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001959996297955513, "outcome": "passed"}, "call": {"duration": 0.7573579298332334, "outcome": "passed"}, "teardown": {"duration": 0.00012909993529319763, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_pure_host_data_and_compute", "lineno": 1189, "outcome": "passed", "keywords": ["test_pure_host_data_and_compute", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019169319421052933, "outcome": "passed"}, "call": {"duration": 0.04604228585958481, "outcome": "passed"}, "teardown": {"duration": 0.00011410843580961227, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_qr_decomposition_offload", "lineno": 1479, "outcome": "skipped", "keywords": ["test_qr_decomposition_offload", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018792785704135895, "outcome": "passed"}, "call": {"duration": 0.00039610452950000763, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/memories_test.py', 1480, \"Skipped: Test doesn't work on GPU in OSS.\")"}, "teardown": {"duration": 7.835496217012405e-05, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_scan_offload", "lineno": 1138, "outcome": "passed", "keywords": ["test_scan_offload", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013784319162368774, "outcome": "passed"}, "call": {"duration": 0.782332107424736, "outcome": "passed"}, "teardown": {"duration": 0.00013279635459184647, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_sharded_compute_on_host", "lineno": 1054, "outcome": "passed", "keywords": ["test_sharded_compute_on_host", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019466876983642578, "outcome": "passed"}, "call": {"duration": 0.1488153152167797, "outcome": "passed"}, "teardown": {"duration": 0.00020705629140138626, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_sharding_devices_indices_map_cache_hit", "lineno": 1411, "outcome": "passed", "keywords": ["test_sharding_devices_indices_map_cache_hit", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00032703299075365067, "outcome": "passed"}, "call": {"duration": 0.0007799416780471802, "outcome": "passed"}, "teardown": {"duration": 0.00013960618525743484, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ComputeOffload::test_single_mem_kind_donation_default_mem_kind", "lineno": 1443, "outcome": "passed", "keywords": ["test_single_mem_kind_donation_default_mem_kind", "ComputeOffload", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00027973297983407974, "outcome": "passed"}, "call": {"duration": 0.15834688302129507, "outcome": "passed"}, "teardown": {"duration": 0.00015217531472444534, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::StreamAnnotationTest::test_stream_annotation_inside_shmap", "lineno": 1824, "outcome": "passed", "keywords": ["test_stream_annotation_inside_shmap", "StreamAnnotationTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00023180339485406876, "outcome": "passed"}, "call": {"duration": 0.32096677646040916, "outcome": "passed"}, "teardown": {"duration": 0.00020538270473480225, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::StreamAnnotationTest::test_stream_annotation_single_instruction", "lineno": 1756, "outcome": "passed", "keywords": ["test_stream_annotation_single_instruction", "StreamAnnotationTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00033321231603622437, "outcome": "passed"}, "call": {"duration": 0.1742092715576291, "outcome": "passed"}, "teardown": {"duration": 0.00023959390819072723, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::StreamAnnotationTest::test_streamed_gemm_overlap", "lineno": 1783, "outcome": "passed", "keywords": ["test_streamed_gemm_overlap", "StreamAnnotationTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00041194818913936615, "outcome": "passed"}, "call": {"duration": 0.9488903284072876, "outcome": "passed"}, "teardown": {"duration": 0.0002899179235100746, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ActivationOffloadingTest::test_primitive_with_multiple_outputs", "lineno": 2031, "outcome": "passed", "keywords": ["test_primitive_with_multiple_outputs", "ActivationOffloadingTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0005463371053338051, "outcome": "passed"}, "call": {"duration": 0.25817254837602377, "outcome": "passed"}, "teardown": {"duration": 0.00013448763638734818, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ActivationOffloadingTest::test_remat_checkpoint_dots_with_no_batch_dims", "lineno": 2000, "outcome": "passed", "keywords": ["test_remat_checkpoint_dots_with_no_batch_dims", "ActivationOffloadingTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019793212413787842, "outcome": "passed"}, "call": {"duration": 0.41898521315306425, "outcome": "passed"}, "teardown": {"duration": 0.0001241648569703102, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ActivationOffloadingTest::test_remat_jaxpr_offloadable", "lineno": 1866, "outcome": "passed", "keywords": ["test_remat_jaxpr_offloadable", "ActivationOffloadingTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019216351211071014, "outcome": "passed"}, "call": {"duration": 0.2289501652121544, "outcome": "passed"}, "teardown": {"duration": 0.0001258067786693573, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ActivationOffloadingTest::test_remat_scan_jaxpr_offloadable", "lineno": 1907, "outcome": "passed", "keywords": ["test_remat_scan_jaxpr_offloadable", "ActivationOffloadingTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001955488696694374, "outcome": "passed"}, "call": {"duration": 0.44434301648288965, "outcome": "passed"}, "teardown": {"duration": 0.0001284489408135414, "outcome": "passed"}}, {"nodeid": "tests/memories_test.py::ActivationOffloadingTest::test_remat_scan_layout_change_offloadable", "lineno": 1959, "outcome": "passed", "keywords": ["test_remat_scan_layout_change_offloadable", "ActivationOffloadingTest", "memories_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019815284758806229, "outcome": "passed"}, "call": {"duration": 0.43973150476813316, "outcome": "passed"}, "teardown": {"duration": 0.0005681486800312996, "outcome": "passed"}}]}