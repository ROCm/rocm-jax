{"created": 1763580586.666441, "duration": 12.136884927749634, "exitcode": 0, "root": "/dockerx/rocm/rocm-jax/jax", "environment": {}, "summary": {"passed": 53, "skipped": 7, "total": 60, "collected": 60}, "collectors": [{"nodeid": "", "outcome": "passed", "result": [{"nodeid": "tests/jaxpr_effects_test.py::JaxprEffectsTest::test_different_effects_in_jaxpr", "type": "TestCaseFunction", "lineno": 136}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprEffectsTest::test_effectful_primitive_in_jaxpr_creates_effects", "type": "TestCaseFunction", "lineno": 128}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprEffectsTest::test_jaxpr_typecheck_should_verify_eqn_effects_are_subset", "type": "TestCaseFunction", "lineno": 146}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprEffectsTest::test_trivial_jaxpr_has_no_effects", "type": "TestCaseFunction", "lineno": 122}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_core_call_primitive_inherits_effects", "type": "TestCaseFunction", "lineno": 162}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_custom_jvp_primitive_inherits_effects", "type": "TestCaseFunction", "lineno": 208}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_custom_vjp_primitive_inherits_effects", "type": "TestCaseFunction", "lineno": 219}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_jit_inherits_effects", "type": "TestCaseFunction", "lineno": 246}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_jit_primitive_inherits_effects", "type": "TestCaseFunction", "lineno": 176}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_new_remat_allows_certain_effects", "type": "TestCaseFunction", "lineno": 199}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_pjit_const_input_effect_indexing", "type": "TestCaseFunction", "lineno": 258}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_pmap_inherits_effects", "type": "TestCaseFunction", "lineno": 232}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_remat_call_primitive_inherits_effects", "type": "TestCaseFunction", "lineno": 188}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_can_lower_and_run_jaxpr_with_ordered_effects", "type": "TestCaseFunction", "lineno": 450}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_can_lower_and_run_jaxpr_with_unordered_effects", "type": "TestCaseFunction", "lineno": 457}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_can_lower_lowerable_effect", "type": "TestCaseFunction", "lineno": 303}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_can_lower_multiple_effects", "type": "TestCaseFunction", "lineno": 506}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_cannot_lower_unlowerable_effect", "type": "TestCaseFunction", "lineno": 310}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_cant_jit_and_pmap_function_with_ordered_effects", "type": "TestCaseFunction", "lineno": 475}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_cant_jit_and_pmap_function_with_unordered_effects", "type": "TestCaseFunction", "lineno": 464}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_lowered_jaxpr_with_multiple_ordered_effects_takes_in_tokens", "type": "TestCaseFunction", "lineno": 430}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_lowered_jaxpr_with_ordered_effects_takes_token_inputs", "type": "TestCaseFunction", "lineno": 413}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_lowered_jaxpr_without_ordered_effects_takes_no_dummy_inputs", "type": "TestCaseFunction", "lineno": 398}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_lowering_that_doesnt_set_tokens_should_cause_error", "type": "TestCaseFunction", "lineno": 331}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_lowering_that_sets_wrong_tokens_should_cause_error", "type": "TestCaseFunction", "lineno": 346}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_nontrivial_lowering_with_ordered_effect_should_consume_token", "type": "TestCaseFunction", "lineno": 361}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_nontrivial_lowering_with_unordered_effect_should_consume_token", "type": "TestCaseFunction", "lineno": 380}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_runtime_tokens_should_update_after_running_effectful_function", "type": "TestCaseFunction", "lineno": 494}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_should_not_pass_tokens_into_unordered_effect", "type": "TestCaseFunction", "lineno": 318}, {"nodeid": "tests/jaxpr_effects_test.py::EffectOrderingTest::test_can_execute_python_callback", "type": "TestCaseFunction", "lineno": 532}, {"nodeid": "tests/jaxpr_effects_test.py::EffectOrderingTest::test_different_threads_get_different_tokens", "type": "TestCaseFunction", "lineno": 581}, {"nodeid": "tests/jaxpr_effects_test.py::EffectOrderingTest::test_ordered_effect_remains_ordered_across_multiple_devices", "type": "TestCaseFunction", "lineno": 550}, {"nodeid": "tests/jaxpr_effects_test.py::ParallelEffectsTest::test_can_pmap_unordered_callback", "type": "TestCaseFunction", "lineno": 645}, {"nodeid": "tests/jaxpr_effects_test.py::ParallelEffectsTest::test_can_pmap_unordered_effect", "type": "TestCaseFunction", "lineno": 637}, {"nodeid": "tests/jaxpr_effects_test.py::ParallelEffectsTest::test_cannot_pmap_ordered_effect", "type": "TestCaseFunction", "lineno": 618}, {"nodeid": "tests/jaxpr_effects_test.py::ParallelEffectsTest::test_cannot_pmap_unlowerable_effect", "type": "TestCaseFunction", "lineno": 608}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_effect_in_cond", "type": "TestCaseFunction", "lineno": 677}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_effect_in_cond_body", "type": "TestCaseFunction", "lineno": 779}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_effect_in_cond_jvp", "type": "TestCaseFunction", "lineno": 688}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_effect_in_cond_jvp2", "type": "TestCaseFunction", "lineno": 706}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_effect_in_scan", "type": "TestCaseFunction", "lineno": 833}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_effect_in_while_body", "type": "TestCaseFunction", "lineno": 769}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_ordered_effect_in_cond", "type": "TestCaseFunction", "lineno": 734}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_ordered_effect_in_scan", "type": "TestCaseFunction", "lineno": 841}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_ordered_effect_in_while_body", "type": "TestCaseFunction", "lineno": 789}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_effects_disallowed_in_cond", "type": "TestCaseFunction", "lineno": 665}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_effects_disallowed_in_scan", "type": "TestCaseFunction", "lineno": 858}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_effects_disallowed_in_while", "type": "TestCaseFunction", "lineno": 810}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_multiple_allowed_ordered_effect_in_cond", "type": "TestCaseFunction", "lineno": 745}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_multiple_allowed_ordered_effect_in_scan", "type": "TestCaseFunction", "lineno": 849}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_multiple_allowed_ordered_effect_in_while_body", "type": "TestCaseFunction", "lineno": 799}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_by_index_properly", "type": "TestCaseFunction", "lineno": 886}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_through_a_jit", "type": "TestCaseFunction", "lineno": 897}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_through_cond", "type": "TestCaseFunction", "lineno": 1061}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_through_dce", "type": "TestCaseFunction", "lineno": 940}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_through_partial_eval_custom", "type": "TestCaseFunction", "lineno": 920}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_through_scan", "type": "TestCaseFunction", "lineno": 1004}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_through_scan_with_dce", "type": "TestCaseFunction", "lineno": 1031}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_through_while_loop", "type": "TestCaseFunction", "lineno": 970}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_simple_jaxpr_input_effect", "type": "TestCaseFunction", "lineno": 880}]}], "tests": [{"nodeid": "tests/jaxpr_effects_test.py::JaxprEffectsTest::test_different_effects_in_jaxpr", "lineno": 136, "outcome": "passed", "keywords": ["test_different_effects_in_jaxpr", "JaxprEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003007231280207634, "outcome": "passed"}, "call": {"duration": 0.0016824044287204742, "outcome": "passed"}, "teardown": {"duration": 9.763427078723907e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprEffectsTest::test_effectful_primitive_in_jaxpr_creates_effects", "lineno": 128, "outcome": "passed", "keywords": ["test_effectful_primitive_in_jaxpr_creates_effects", "JaxprEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00015330687165260315, "outcome": "passed"}, "call": {"duration": 0.0007689455524086952, "outcome": "passed"}, "teardown": {"duration": 8.128955960273743e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprEffectsTest::test_jaxpr_typecheck_should_verify_eqn_effects_are_subset", "lineno": 146, "outcome": "passed", "keywords": ["test_jaxpr_typecheck_should_verify_eqn_effects_are_subset", "JaxprEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013950560241937637, "outcome": "passed"}, "call": {"duration": 0.002009037882089615, "outcome": "passed"}, "teardown": {"duration": 7.849559187889099e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprEffectsTest::test_trivial_jaxpr_has_no_effects", "lineno": 122, "outcome": "passed", "keywords": ["test_trivial_jaxpr_has_no_effects", "JaxprEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00014569424092769623, "outcome": "passed"}, "call": {"duration": 0.0007317615672945976, "outcome": "passed"}, "teardown": {"duration": 9.270664304494858e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_core_call_primitive_inherits_effects", "lineno": 162, "outcome": "passed", "keywords": ["test_core_call_primitive_inherits_effects", "HigherOrderPrimitiveTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00017641019076108932, "outcome": "passed"}, "call": {"duration": 0.0008682636544108391, "outcome": "passed"}, "teardown": {"duration": 7.507111877202988e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_custom_jvp_primitive_inherits_effects", "lineno": 208, "outcome": "passed", "keywords": ["test_custom_jvp_primitive_inherits_effects", "HigherOrderPrimitiveTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001389952376484871, "outcome": "passed"}, "call": {"duration": 0.002422768622636795, "outcome": "passed"}, "teardown": {"duration": 7.946696132421494e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_custom_vjp_primitive_inherits_effects", "lineno": 219, "outcome": "passed", "keywords": ["test_custom_vjp_primitive_inherits_effects", "HigherOrderPrimitiveTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001483587548136711, "outcome": "passed"}, "call": {"duration": 0.023214668035507202, "outcome": "passed"}, "teardown": {"duration": 9.590201079845428e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_jit_inherits_effects", "lineno": 246, "outcome": "passed", "keywords": ["test_jit_inherits_effects", "HigherOrderPrimitiveTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00016215071082115173, "outcome": "passed"}, "call": {"duration": 3.685538010671735, "outcome": "passed"}, "teardown": {"duration": 0.00011907611042261124, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_jit_primitive_inherits_effects", "lineno": 176, "outcome": "passed", "keywords": ["test_jit_primitive_inherits_effects", "HigherOrderPrimitiveTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018432177603244781, "outcome": "passed"}, "call": {"duration": 0.0012432672083377838, "outcome": "passed"}, "teardown": {"duration": 7.80150294303894e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_new_remat_allows_certain_effects", "lineno": 199, "outcome": "passed", "keywords": ["test_new_remat_allows_certain_effects", "HigherOrderPrimitiveTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001424914225935936, "outcome": "passed"}, "call": {"duration": 0.000851447694003582, "outcome": "passed"}, "teardown": {"duration": 7.146596908569336e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_pjit_const_input_effect_indexing", "lineno": 258, "outcome": "passed", "keywords": ["test_pjit_const_input_effect_indexing", "HigherOrderPrimitiveTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00014716759324073792, "outcome": "passed"}, "call": {"duration": 1.9714696565642953, "outcome": "passed"}, "teardown": {"duration": 0.0002662232145667076, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_pmap_inherits_effects", "lineno": 232, "outcome": "skipped", "keywords": ["test_pmap_inherits_effects", "HigherOrderPrimitiveTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00039402302354574203, "outcome": "passed"}, "call": {"duration": 0.0008651791140437126, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/jaxpr_effects_test.py', 233, 'Skipped: Test does not raise under `pmap_shmap_merge=True`.')"}, "teardown": {"duration": 0.00015975628048181534, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::HigherOrderPrimitiveTest::test_remat_call_primitive_inherits_effects", "lineno": 188, "outcome": "passed", "keywords": ["test_remat_call_primitive_inherits_effects", "HigherOrderPrimitiveTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00028698425740003586, "outcome": "passed"}, "call": {"duration": 0.00662983488291502, "outcome": "passed"}, "teardown": {"duration": 0.00020189769566059113, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_can_lower_and_run_jaxpr_with_ordered_effects", "lineno": 450, "outcome": "passed", "keywords": ["test_can_lower_and_run_jaxpr_with_ordered_effects", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00036247633397579193, "outcome": "passed"}, "call": {"duration": 0.580958110280335, "outcome": "passed"}, "teardown": {"duration": 0.00026721321046352386, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_can_lower_and_run_jaxpr_with_unordered_effects", "lineno": 457, "outcome": "passed", "keywords": ["test_can_lower_and_run_jaxpr_with_unordered_effects", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00043977051973342896, "outcome": "passed"}, "call": {"duration": 0.1921799136325717, "outcome": "passed"}, "teardown": {"duration": 0.00028018467128276825, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_can_lower_lowerable_effect", "lineno": 303, "outcome": "passed", "keywords": ["test_can_lower_lowerable_effect", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00044141244143247604, "outcome": "passed"}, "call": {"duration": 0.010118478909134865, "outcome": "passed"}, "teardown": {"duration": 0.00021252408623695374, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_can_lower_multiple_effects", "lineno": 506, "outcome": "passed", "keywords": ["test_can_lower_multiple_effects", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003715492784976959, "outcome": "passed"}, "call": {"duration": 1.3389578871428967, "outcome": "passed"}, "teardown": {"duration": 0.00022895820438861847, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_cannot_lower_unlowerable_effect", "lineno": 310, "outcome": "passed", "keywords": ["test_cannot_lower_unlowerable_effect", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003820043057203293, "outcome": "passed"}, "call": {"duration": 0.0029957862570881844, "outcome": "passed"}, "teardown": {"duration": 0.00015308614820241928, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_cant_jit_and_pmap_function_with_ordered_effects", "lineno": 475, "outcome": "skipped", "keywords": ["test_cant_jit_and_pmap_function_with_ordered_effects", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00028627272695302963, "outcome": "passed"}, "call": {"duration": 0.0008581178262829781, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/jaxpr_effects_test.py', 476, \"Skipped: This test won't raise with 1 device.\")"}, "teardown": {"duration": 0.00015841424465179443, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_cant_jit_and_pmap_function_with_unordered_effects", "lineno": 464, "outcome": "skipped", "keywords": ["test_cant_jit_and_pmap_function_with_unordered_effects", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00026898737996816635, "outcome": "passed"}, "call": {"duration": 0.0006221691146492958, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/jaxpr_effects_test.py', 465, 'Skipped: Test requires >= 2 devices.')"}, "teardown": {"duration": 0.00014124903827905655, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_lowered_jaxpr_with_multiple_ordered_effects_takes_in_tokens", "lineno": 430, "outcome": "passed", "keywords": ["test_lowered_jaxpr_with_multiple_ordered_effects_takes_in_tokens", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00025941338390111923, "outcome": "passed"}, "call": {"duration": 0.0074957748875021935, "outcome": "passed"}, "teardown": {"duration": 9.253714233636856e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_lowered_jaxpr_with_ordered_effects_takes_token_inputs", "lineno": 413, "outcome": "passed", "keywords": ["test_lowered_jaxpr_with_ordered_effects_takes_token_inputs", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00016050692647695541, "outcome": "passed"}, "call": {"duration": 0.0035740509629249573, "outcome": "passed"}, "teardown": {"duration": 8.915085345506668e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_lowered_jaxpr_without_ordered_effects_takes_no_dummy_inputs", "lineno": 398, "outcome": "passed", "keywords": ["test_lowered_jaxpr_without_ordered_effects_takes_no_dummy_inputs", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0001556798815727234, "outcome": "passed"}, "call": {"duration": 0.0035049375146627426, "outcome": "passed"}, "teardown": {"duration": 8.869078010320663e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_lowering_that_doesnt_set_tokens_should_cause_error", "lineno": 331, "outcome": "passed", "keywords": ["test_lowering_that_doesnt_set_tokens_should_cause_error", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00015234481543302536, "outcome": "passed"}, "call": {"duration": 0.013039915822446346, "outcome": "passed"}, "teardown": {"duration": 0.00010031834244728088, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_lowering_that_sets_wrong_tokens_should_cause_error", "lineno": 346, "outcome": "passed", "keywords": ["test_lowering_that_sets_wrong_tokens_should_cause_error", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00016596540808677673, "outcome": "passed"}, "call": {"duration": 0.013044503517448902, "outcome": "passed"}, "teardown": {"duration": 9.552109986543655e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_nontrivial_lowering_with_ordered_effect_should_consume_token", "lineno": 361, "outcome": "passed", "keywords": ["test_nontrivial_lowering_with_ordered_effect_should_consume_token", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00016586575657129288, "outcome": "passed"}, "call": {"duration": 0.003823239356279373, "outcome": "passed"}, "teardown": {"duration": 8.68476927280426e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_nontrivial_lowering_with_unordered_effect_should_consume_token", "lineno": 380, "outcome": "passed", "keywords": ["test_nontrivial_lowering_with_unordered_effect_should_consume_token", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00015303585678339005, "outcome": "passed"}, "call": {"duration": 0.0035694148391485214, "outcome": "passed"}, "teardown": {"duration": 9.029265493154526e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_runtime_tokens_should_update_after_running_effectful_function", "lineno": 494, "outcome": "passed", "keywords": ["test_runtime_tokens_should_update_after_running_effectful_function", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00015781447291374207, "outcome": "passed"}, "call": {"duration": 0.019160808995366096, "outcome": "passed"}, "teardown": {"duration": 0.00012817885726690292, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectfulJaxprLoweringTest::test_should_not_pass_tokens_into_unordered_effect", "lineno": 318, "outcome": "passed", "keywords": ["test_should_not_pass_tokens_into_unordered_effect", "EffectfulJaxprLoweringTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0002166200429201126, "outcome": "passed"}, "call": {"duration": 0.0044528888538479805, "outcome": "passed"}, "teardown": {"duration": 0.00012462399899959564, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectOrderingTest::test_can_execute_python_callback", "lineno": 532, "outcome": "passed", "keywords": ["test_can_execute_python_callback", "EffectOrderingTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00021565891802310944, "outcome": "passed"}, "call": {"duration": 0.5168989961966872, "outcome": "passed"}, "teardown": {"duration": 0.00022443197667598724, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectOrderingTest::test_different_threads_get_different_tokens", "lineno": 581, "outcome": "skipped", "keywords": ["test_different_threads_get_different_tokens", "EffectOrderingTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003631468862295151, "outcome": "passed"}, "call": {"duration": 0.0007562572136521339, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/jaxpr_effects_test.py', 582, 'Skipped: Test requires >= 2 devices.')"}, "teardown": {"duration": 0.00015360675752162933, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::EffectOrderingTest::test_ordered_effect_remains_ordered_across_multiple_devices", "lineno": 550, "outcome": "skipped", "keywords": ["test_ordered_effect_remains_ordered_across_multiple_devices", "__wrapped__", "EffectOrderingTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0002666246145963669, "outcome": "passed"}, "call": {"duration": 0.0006388546898961067, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/jaxpr_effects_test.py', 551, 'Skipped: Test requires >= 2 devices.')"}, "teardown": {"duration": 0.00019085220992565155, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ParallelEffectsTest::test_can_pmap_unordered_callback", "lineno": 645, "outcome": "skipped", "keywords": ["test_can_pmap_unordered_callback", "ParallelEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00033844076097011566, "outcome": "passed"}, "call": {"duration": 0.0006047636270523071, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/jaxpr_effects_test.py', 646, 'Skipped: Test requires >= 2 devices.')"}, "teardown": {"duration": 0.00014384184032678604, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ParallelEffectsTest::test_can_pmap_unordered_effect", "lineno": 637, "outcome": "passed", "keywords": ["test_can_pmap_unordered_effect", "ParallelEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0002579614520072937, "outcome": "passed"}, "call": {"duration": 1.271035185083747, "outcome": "passed"}, "teardown": {"duration": 0.0002803336828947067, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ParallelEffectsTest::test_cannot_pmap_ordered_effect", "lineno": 618, "outcome": "skipped", "keywords": ["test_cannot_pmap_ordered_effect", "ParallelEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004367157816886902, "outcome": "passed"}, "call": {"duration": 0.0009368732571601868, "outcome": "skipped", "longrepr": "('/dockerx/rocm/rocm-jax/jax/tests/jaxpr_effects_test.py', 619, \"Skipped: This test won't raise with 1 device.\")"}, "teardown": {"duration": 0.00019358564168214798, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ParallelEffectsTest::test_cannot_pmap_unlowerable_effect", "lineno": 608, "outcome": "passed", "keywords": ["test_cannot_pmap_unlowerable_effect", "ParallelEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00033532455563545227, "outcome": "passed"}, "call": {"duration": 0.008119205012917519, "outcome": "passed"}, "teardown": {"duration": 0.0002345563843846321, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_effect_in_cond", "lineno": 677, "outcome": "passed", "keywords": ["test_allowed_effect_in_cond", "ControlFlowEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004271315410733223, "outcome": "passed"}, "call": {"duration": 0.7896471126005054, "outcome": "passed"}, "teardown": {"duration": 0.00027403514832258224, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_effect_in_cond_body", "lineno": 779, "outcome": "passed", "keywords": ["test_allowed_effect_in_cond_body", "ControlFlowEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00043238885700702667, "outcome": "passed"}, "call": {"duration": 0.029146842658519745, "outcome": "passed"}, "teardown": {"duration": 0.00025442615151405334, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_effect_in_cond_jvp", "lineno": 688, "outcome": "passed", "keywords": ["test_allowed_effect_in_cond_jvp", "ControlFlowEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00041768699884414673, "outcome": "passed"}, "call": {"duration": 0.03483942337334156, "outcome": "passed"}, "teardown": {"duration": 0.00022752583026885986, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_effect_in_cond_jvp2", "lineno": 706, "outcome": "passed", "keywords": ["test_allowed_effect_in_cond_jvp2", "ControlFlowEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00037702731788158417, "outcome": "passed"}, "call": {"duration": 0.13212717976421118, "outcome": "passed"}, "teardown": {"duration": 0.0001587243750691414, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_effect_in_scan", "lineno": 833, "outcome": "passed", "keywords": ["test_allowed_effect_in_scan", "ControlFlowEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00023401621729135513, "outcome": "passed"}, "call": {"duration": 0.24882713612169027, "outcome": "passed"}, "teardown": {"duration": 0.00019827298820018768, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_effect_in_while_body", "lineno": 769, "outcome": "passed", "keywords": ["test_allowed_effect_in_while_body", "ControlFlowEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004437156021595001, "outcome": "passed"}, "call": {"duration": 0.025669505819678307, "outcome": "passed"}, "teardown": {"duration": 0.00026732590049505234, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_ordered_effect_in_cond", "lineno": 734, "outcome": "passed", "keywords": ["test_allowed_ordered_effect_in_cond", "ControlFlowEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0004444951191544533, "outcome": "passed"}, "call": {"duration": 0.02766508422791958, "outcome": "passed"}, "teardown": {"duration": 0.00020253006368875504, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_ordered_effect_in_scan", "lineno": 841, "outcome": "passed", "keywords": ["test_allowed_ordered_effect_in_scan", "ControlFlowEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003458308055996895, "outcome": "passed"}, "call": {"duration": 0.021954204887151718, "outcome": "passed"}, "teardown": {"duration": 0.0001216493546962738, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_allowed_ordered_effect_in_while_body", "lineno": 789, "outcome": "passed", "keywords": ["test_allowed_ordered_effect_in_while_body", "ControlFlowEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00019714143127202988, "outcome": "passed"}, "call": {"duration": 0.013110601343214512, "outcome": "passed"}, "teardown": {"duration": 0.0001691095530986786, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_effects_disallowed_in_cond", "lineno": 665, "outcome": "passed", "keywords": ["test_effects_disallowed_in_cond", "ControlFlowEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.0003173789009451866, "outcome": "passed"}, "call": {"duration": 0.0027972329407930374, "outcome": "passed"}, "teardown": {"duration": 0.00013192463666200638, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_effects_disallowed_in_scan", "lineno": 858, "outcome": "passed", "keywords": ["test_effects_disallowed_in_scan", "ControlFlowEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00025000888854265213, "outcome": "passed"}, "call": {"duration": 0.0021073240786790848, "outcome": "passed"}, "teardown": {"duration": 9.610224515199661e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_effects_disallowed_in_while", "lineno": 810, "outcome": "passed", "keywords": ["test_effects_disallowed_in_while", "ControlFlowEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00017528794705867767, "outcome": "passed"}, "call": {"duration": 0.0023595159873366356, "outcome": "passed"}, "teardown": {"duration": 8.978322148323059e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_multiple_allowed_ordered_effect_in_cond", "lineno": 745, "outcome": "passed", "keywords": ["test_multiple_allowed_ordered_effect_in_cond", "ControlFlowEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00015733204782009125, "outcome": "passed"}, "call": {"duration": 0.24828774947673082, "outcome": "passed"}, "teardown": {"duration": 0.00012190081179141998, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_multiple_allowed_ordered_effect_in_scan", "lineno": 849, "outcome": "passed", "keywords": ["test_multiple_allowed_ordered_effect_in_scan", "ControlFlowEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00018345098942518234, "outcome": "passed"}, "call": {"duration": 0.1272738091647625, "outcome": "passed"}, "teardown": {"duration": 0.00012972112745046616, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::ControlFlowEffectsTest::test_multiple_allowed_ordered_effect_in_while_body", "lineno": 799, "outcome": "passed", "keywords": ["test_multiple_allowed_ordered_effect_in_while_body", "ControlFlowEffectsTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00020215939730405807, "outcome": "passed"}, "call": {"duration": 0.016130481846630573, "outcome": "passed"}, "teardown": {"duration": 0.0001225210726261139, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_by_index_properly", "lineno": 886, "outcome": "passed", "keywords": ["test_jaxpr_input_effect_is_tracked_by_index_properly", "JaxprInputEffectTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00020077545195817947, "outcome": "passed"}, "call": {"duration": 0.00099855475127697, "outcome": "passed"}, "teardown": {"duration": 7.777474820613861e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_through_a_jit", "lineno": 897, "outcome": "passed", "keywords": ["test_jaxpr_input_effect_is_tracked_through_a_jit", "JaxprInputEffectTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00014089886099100113, "outcome": "passed"}, "call": {"duration": 0.0033942945301532745, "outcome": "passed"}, "teardown": {"duration": 8.382368832826614e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_through_cond", "lineno": 1061, "outcome": "passed", "keywords": ["test_jaxpr_input_effect_is_tracked_through_cond", "JaxprInputEffectTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00014267116785049438, "outcome": "passed"}, "call": {"duration": 0.0024628890678286552, "outcome": "passed"}, "teardown": {"duration": 7.911771535873413e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_through_dce", "lineno": 940, "outcome": "passed", "keywords": ["test_jaxpr_input_effect_is_tracked_through_dce", "JaxprInputEffectTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00014010723680257797, "outcome": "passed"}, "call": {"duration": 0.0016688564792275429, "outcome": "passed"}, "teardown": {"duration": 7.711350917816162e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_through_partial_eval_custom", "lineno": 920, "outcome": "passed", "keywords": ["test_jaxpr_input_effect_is_tracked_through_partial_eval_custom", "JaxprInputEffectTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00014059711247682571, "outcome": "passed"}, "call": {"duration": 0.0007617566734552383, "outcome": "passed"}, "teardown": {"duration": 7.57221132516861e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_through_scan", "lineno": 1004, "outcome": "passed", "keywords": ["test_jaxpr_input_effect_is_tracked_through_scan", "JaxprInputEffectTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00013591162860393524, "outcome": "passed"}, "call": {"duration": 0.1346106482669711, "outcome": "passed"}, "teardown": {"duration": 0.00012260116636753082, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_through_scan_with_dce", "lineno": 1031, "outcome": "passed", "keywords": ["test_jaxpr_input_effect_is_tracked_through_scan_with_dce", "JaxprInputEffectTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00017734244465827942, "outcome": "passed"}, "call": {"duration": 0.003821886144578457, "outcome": "passed"}, "teardown": {"duration": 8.122995495796204e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_jaxpr_input_effect_is_tracked_through_while_loop", "lineno": 970, "outcome": "passed", "keywords": ["test_jaxpr_input_effect_is_tracked_through_while_loop", "JaxprInputEffectTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00014340132474899292, "outcome": "passed"}, "call": {"duration": 0.005600805394351482, "outcome": "passed"}, "teardown": {"duration": 8.291192352771759e-05, "outcome": "passed"}}, {"nodeid": "tests/jaxpr_effects_test.py::JaxprInputEffectTest::test_simple_jaxpr_input_effect", "lineno": 880, "outcome": "passed", "keywords": ["test_simple_jaxpr_input_effect", "JaxprInputEffectTest", "jaxpr_effects_test.py", "tests", "jax", ""], "setup": {"duration": 0.00014620553702116013, "outcome": "passed"}, "call": {"duration": 0.0006044534966349602, "outcome": "passed"}, "teardown": {"duration": 0.0003648092970252037, "outcome": "passed"}}]}